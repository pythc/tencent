[
    {
        "sql_id": "sql_1",
        "sql": "WITH base_user AS (\n  SELECT DISTINCT\n         suserid,\n         suserid_type\n  FROM dim_vplayerid_vies_df\n  WHERE dtstatdate = '20250724'\n    AND itag = '其他'\n    AND suserid IS NOT NULL\n    AND suserid_type IN ('qq', 'wxid')\n)\nSELECT\n    a.suserid,\n    a.sgamecode,\n    SUM(a.ionlinetime) AS ionlinetime\nFROM dws_mgamejp_login_user_activity_di a\nJOIN base_user b\n  ON a.suserid = b.suserid\n AND a.suseridtype = b.suserid_type\nWHERE a.dtstatdate BETWEEN 20250530 AND 20250724\n  AND a.sgamecode IN ('initiatived', 'jordass', 'esports', 'allianceforce', 'strategy', 'playzone', 'su')\n  AND a.saccounttype = '-100'\n  AND a.suseridtype IN ('qq', 'wxid')\n  AND a.splattype = '-100'\n  AND a.splat = '-100'\nGROUP BY a.suserid, a.sgamecode",
        "status": "success",
        "result": [
            {
                "suserid": "suserid_3",
                "sgamecode": "esports",
                "ionlinetime": 50
            },
            {
                "suserid": "suserid_1",
                "sgamecode": "initiatived",
                "ionlinetime": 300
            },
            {
                "suserid": "suserid_4",
                "sgamecode": "allianceforce",
                "ionlinetime": 80
            },
            {
                "suserid": "suserid_6",
                "sgamecode": "playzone",
                "ionlinetime": 200
            }
        ]
    },
    {
        "sql_id": "sql_2",
        "sql": "with sample_user as (\n  select distinct vplayerid\n  from dim_extract_311381_conf\n),\npaid_user as (\n  select vplayerid\n  from dws_jordass_water_di\n  where dtstatdate between '20250717' and '20250723'\n    and imoney > 0\n  group by vplayerid\n),\nexclude_721 as (\n  select distinct vplayerid\n  from dwd_jordass_privpackagelog_hi\n  where packageid = 721\n),\ntarget_user as (\n  select s.vplayerid\n  from sample_user s\n  join paid_user p on s.vplayerid = p.vplayerid\n  where not exists (\n    select 1\n    from exclude_721 e\n    where e.vplayerid = s.vplayerid\n  )\n)\nselect distinct u.vplayerid as gplayerid\nfrom target_user u\njoin dws_argothek_ce1_cbt2_vplayerid_suserid_di m\n  on u.vplayerid = m.vplayerid\n and m.dtstatdate between '20250717' and '20250723'\njoin dws_argothek_ce1_login_di l\n  on u.vplayerid = l.vplayerid\n and l.dtstatdate between '20250717' and '20250723'\n and l.platid = 255\norder by gplayerid",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_3",
        "sql": "with argothek_active as (\n  select distinct iuserid as gplayerid\n  from dws_argothek_oss_login_di\n  where statis_date between '20250101' and '20250131'\n),\nlatest_map as (\n  select gplayerid,\n         suserid,\n         swxid_type as suserid_type\n  from (\n    select iuserid as gplayerid,\n           suserid,\n           swxid_type,\n           row_number() over(partition by iuserid order by dtstatdate desc) as rn\n    from dim_argothek_gplayerid2qqwxid_df\n    where dtstatdate <= '20250131'\n      and suserid is not null\n      and swxid_type in ('qq', 'wxid')\n  ) t\n  where rn = 1\n),\nxinggu_active as (\n  select distinct suserid, suseridtype\n  from dws_mgamejp_login_user_activity_di\n  where dtstatdate between '20250101' and '20250131'\n    and sgamecode = 'initiatived'\n    and saccounttype = '-100'\n    and suseridtype in ('qq', 'wxid')\n    and splattype in ('-100', 'PC')\n    and splat = '-100'\n)\nselect distinct a.gplayerid\nfrom argothek_active a\njoin latest_map m\n  on a.gplayerid = m.gplayerid\njoin xinggu_active x\n  on m.suserid = x.suserid\n and m.suserid_type = x.suseridtype\norder by a.gplayerid",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_4",
        "sql": "with base as (\n  select\n    case\n      when locate('#', vrolename) > 0 then substr(vrolename, 1, locate('#', vrolename) - 1)\n      else vrolename\n    end as nickname,\n    iuserid\n  from dwd_argothek_playerlogin_hi\n  where dteventtime >= '2023-07-12 00:00:00'\n    and dteventtime <= '2025-07-15 23:59:59'\n    and ifnull(vrolename, '') <> ''\n),\nagg as (\n  select\n    nickname,\n    count(distinct iuserid) as user_cnt\n  from base\n  group by nickname\n),\nranked as (\n  select\n    nickname,\n    user_cnt,\n    dense_rank() over(order by user_cnt desc) as rnk\n  from agg\n)\nselect\n  nickname,\n  user_cnt as user_num\nfrom ranked\nwhere rnk = 1\norder by nickname",
        "status": "success",
        "result": [
            {
                "nickname": "player3",
                "user_num": 3
            }
        ]
    },
    {
        "sql_id": "sql_6",
        "sql": "with mobile_t2 as (\n  select distinct vplayerid\n  from dws_argothek_ce1_cbt2_vplayerid_suserid_di\n  where dtstatdate between '20250612' and '20250714'\n    and itag = 'T2'\n),\npc_reg as (\n  select distinct iuserid as vplayerid\n  from dim_argothek_gplayerid2qqwxid_df\n  where dtstatdate <= '20250529'\n    and iregdate < '20250529'\n)\nselect distinct m.vplayerid\nfrom mobile_t2 m\njoin pc_reg p\n  on m.vplayerid = p.vplayerid\norder by m.vplayerid",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_7",
        "sql": "with open_channel as (\n  select distinct gplayerid\n  from dwd_argothek_cbt2kaibai_hi\n  where dteventtime >= '2025-07-03 00:00:00'\n    and dteventtime <= '2025-07-06 23:59:59'\n    and coalesce(sourcename, '') not in ('内部体验', '买量测试')\n),\nfiltered as (\n  select\n    dtstatdate,\n    vplayerid,\n    iregway\n  from dws_argothek_ce1_cbt2_vplayerid_suserid_di\n  where dtstatdate between '20250703' and '20250706'\n    and iregway in ('89903934','89903933','89903932','89902725','89902724','89902723','89900960','89900961','89900962')\n    and is_reg = '1'\n    and platid <> 255\n    and coalesce(sourcename, '') not in ('内部体验', '买量测试')\n)\nselect\n  f.dtstatdate as stat_date,\n  f.iregway,\n  count(distinct f.vplayerid) as new_user_cnt\nfrom filtered f\njoin open_channel o\n  on f.vplayerid = o.gplayerid\ngroup by f.dtstatdate, f.iregway\norder by f.dtstatdate, f.iregway",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_8",
        "sql": "with base as (\n  select\n    date_format(cast(dteventtime as datetime), '%Y-%m') as stat_month,\n    gamepodid,\n    cast(dteventtime as datetime) as event_time,\n    lower(queueid) as queue_id,\n    matchid\n  from dwd_argothek_matchdetails_hi\n  where cast(dteventtime as datetime) >= '2025-04-01'\n    and cast(dteventtime as datetime) < '2025-07-01'\n    and lower(completionstate) in ('completed', 'surrendered')\n    and lower(queueid) in ('swiftplay', 'competitive', 'unrated')\n),\ntime_agg as (\n  select\n    stat_month,\n    gamepodid,\n    event_time,\n    count(distinct matchid) as total_end_cnt,\n    count(distinct case when queue_id = 'competitive' then matchid end) as ranked_end_cnt,\n    count(distinct case when queue_id = 'unrated' then matchid end) as normal_end_cnt,\n    count(distinct case when queue_id = 'swiftplay' then matchid end) as swift_end_cnt,\n    row_number() over (partition by stat_month, gamepodid order by count(distinct matchid) desc, event_time) as rn\n  from base\n  group by stat_month, gamepodid, event_time\n)\nselect\n  stat_month as stat_month,\n  gamepodid as server_node,\n  date_format(event_time, '%Y-%m-%d %H:%i:%s') as peak_time,\n  total_end_cnt as total_game_end_cnt,\n  ranked_end_cnt,\n  normal_end_cnt,\n  swift_end_cnt\nfrom time_agg\nwhere rn = 1\norder by stat_month, server_node",
        "status": "success",
        "result": [
            {
                "stat_month": "2025-04",
                "server_node": "gp1",
                "peak_time": "2025-04-01 18:00:00",
                "total_game_end_cnt": 2,
                "ranked_end_cnt": 0,
                "normal_end_cnt": 1,
                "swift_end_cnt": 1
            },
            {
                "stat_month": "2025-04",
                "server_node": "gp2",
                "peak_time": "2025-04-02 12:00:00",
                "total_game_end_cnt": 1,
                "ranked_end_cnt": 1,
                "normal_end_cnt": 0,
                "swift_end_cnt": 0
            },
            {
                "stat_month": "2025-05",
                "server_node": "gp1",
                "peak_time": "2025-05-01 18:00:00",
                "total_game_end_cnt": 2,
                "ranked_end_cnt": 1,
                "normal_end_cnt": 0,
                "swift_end_cnt": 1
            },
            {
                "stat_month": "2025-05",
                "server_node": "gp2",
                "peak_time": "2025-05-02 12:00:00",
                "total_game_end_cnt": 1,
                "ranked_end_cnt": 1,
                "normal_end_cnt": 0,
                "swift_end_cnt": 0
            }
        ]
    },
    {
        "sql_id": "sql_9",
        "sql": "with base as (\n  select\n    suserid,\n    suseridtype\n  from dim_mgamejp_account_allinfo_nf\n  where dtstatdate = 20250702\n    and saccounttype = '-100'\n    and suseridtype in ('qq', 'wxid')\n    and sgamecode in ('esports','mobile_live','initiatived','allianceforce','strategy','jordass','su','playzone','battlezone','battlearena','weapon','playhub','manager','apgame')\n    and splattype = '-100'\n    and splat = '-100'\n    and ilastactdate >= 20250104\n),\njoined as (\n  select\n    b.suserid,\n    coalesce(u.city_level, '未知') as city_level\n  from base b\n  left join dim_uf_player_gameinfo_mf u\n    on u.kp_imp_date = '202506'\n   and u.userid = b.suserid\n   and u.id_type = case when b.suseridtype = 'wxid' then 'wx' else b.suseridtype end\n)\nselect\n  city_level,\n  count(distinct suserid) as user_cnt\nfrom joined\ngroup by city_level\norder by city_level",
        "status": "success",
        "result": [
            {
                "city_level": "1",
                "user_cnt": 4
            },
            {
                "city_level": "2",
                "user_cnt": 2
            },
            {
                "city_level": "3",
                "user_cnt": 1
            },
            {
                "city_level": "4",
                "user_cnt": 1
            }
        ]
    },
    {
        "sql_id": "sql_10",
        "sql": "WITH season_calendar AS (\n  SELECT\n    seasonid,\n    seasonidname,\n    MIN(STR_TO_DATE(idate, '%Y%m%d')) AS season_start,\n    MAX(STR_TO_DATE(idate, '%Y%m%d')) AS season_end\n  FROM dim_argothek_seasondate_df\n  WHERE STR_TO_DATE(idate, '%Y%m%d') BETWEEN '2023-07-12' AND '2025-06-15'\n  GROUP BY seasonid, seasonidname\n), usage_base AS (\n  SELECT\n    sc.seasonid,\n    sc.seasonidname,\n    e.expressionassetid AS item_id,\n    l.subject AS user_id\n  FROM dwd_argothek_playerloadout_expressions_hi e\n  JOIN dwd_argothek_playerloadout_hi l\n    ON e.apeventid = l.apeventid\n  JOIN season_calendar sc\n    ON STR_TO_DATE(SUBSTR(e.dteventtime, 1, 10), '%Y-%m-%d') BETWEEN sc.season_start AND sc.season_end\n  WHERE STR_TO_DATE(SUBSTR(e.dteventtime, 1, 10), '%Y-%m-%d') BETWEEN '2023-07-12' AND '2025-06-15'\n    AND e.expressionassetid IS NOT NULL\n    AND e.expressiontypeid = 'd5f120f8-ff8c-4aac-92ea-f2b5acbe9475'\n), usage_agg AS (\n  SELECT\n    seasonid,\n    seasonidname,\n    item_id,\n    COUNT(DISTINCT user_id) AS season_use_user_cnt\n  FROM usage_base\n  GROUP BY seasonid, seasonidname, item_id\n), purchase_base AS (\n  SELECT\n    sc.seasonid,\n    sc.seasonidname,\n    g.purchaseditemid AS item_id,\n    g.vtemp1 AS buyer_id\n  FROM dwd_argothek_commercialization_gearid_df g\n  JOIN season_calendar sc\n    ON STR_TO_DATE(g.idate, '%Y%m%d') BETWEEN sc.season_start AND sc.season_end\n  WHERE STR_TO_DATE(g.idate, '%Y%m%d') BETWEEN '2023-07-12' AND '2025-06-15'\n    AND g.purchasesource = 'BATTLEPASS_PROGRESS'\n    AND g.itemtype = 'd5f120f8-ff8c-4aac-92ea-f2b5acbe9475'\n    AND g.vtemp1 IS NOT NULL\n), purchase_agg AS (\n  SELECT\n    seasonid,\n    seasonidname,\n    item_id,\n    COUNT(DISTINCT buyer_id) AS season_buy_user_cnt\n  FROM purchase_base\n  GROUP BY seasonid, seasonidname, item_id\n)\nSELECT\n  item_id,\n  season_name,\n  SUM(season_use_user_cnt) AS season_use_user_cnt,\n  SUM(season_buy_user_cnt) AS season_buy_user_cnt\nFROM (\n  SELECT\n    item_id,\n    seasonidname AS season_name,\n    season_use_user_cnt,\n    0 AS season_buy_user_cnt\n  FROM usage_agg\n  UNION ALL\n  SELECT\n    item_id,\n    seasonidname AS season_name,\n    0 AS season_use_user_cnt,\n    season_buy_user_cnt\n  FROM purchase_agg\n) merged\nGROUP BY item_id, season_name\nORDER BY season_name, item_id",
        "status": "success",
        "result": [
            {
                "item_id": "item1",
                "season_name": "S1",
                "season_use_user_cnt": 1,
                "season_buy_user_cnt": 6
            },
            {
                "item_id": "item2",
                "season_name": "S1",
                "season_use_user_cnt": 1,
                "season_buy_user_cnt": 7
            },
            {
                "item_id": "item3",
                "season_name": "S1",
                "season_use_user_cnt": 1,
                "season_buy_user_cnt": 0
            },
            {
                "item_id": "item1",
                "season_name": "S2",
                "season_use_user_cnt": 1,
                "season_buy_user_cnt": 3
            },
            {
                "item_id": "item2",
                "season_name": "S2",
                "season_use_user_cnt": 1,
                "season_buy_user_cnt": 9
            }
        ]
    },
    {
        "sql_id": "sql_11",
        "sql": "with active_users as (\n  select distinct iuserid\n  from dws_argothek_oss_useractivity_df\n  where statis_date between 20250519 and 20250617\n    and iworldid = 255\n),\nall_prize_users as (\n  select iuserid\n  from dwd_argothek_gearrecord_df\n  where igoodsid in (\n    '71d260ca-4bad-81f2-0298-44860341a7a6',\n    '48601754-442d-98cb-2109-3fb2075500ec',\n    'a9126263-439c-7be6-d668-52a6c0c0a36f',\n    '34ecc788-4034-71d2-a0ac-c398b8ecb2ae',\n    '56f98991-43f8-dcc8-189e-08b7ae6c42ad',\n    '8453f8ef-4c0b-46e2-8768-3e9e45c67a2c',\n    '06d90274-435f-3e32-9d57-26bc228ae2e5',\n    '8196dea4-4229-c951-13a9-088fb13b3512',\n    '3abc330f-444a-6dfd-5863-81856ba62624',\n    '041a43a4-46fe-dab7-c974-36bf91eab33d',\n    '5b863cb9-4e41-ec89-69ee-49a223d05ff1'\n  )\n  group by iuserid\n  having count(distinct igoodsid) = 11\n),\nactive_cnt as (\n  select count(*) as active_user_cnt from active_users\n),\nactive_all_cnt as (\n  select count(*) as active_own_all_cnt\n  from active_users a\n  join all_prize_users g on a.iuserid = g.iuserid\n)\nselect\n  a.active_user_cnt as active_30d_user_cnt,\n  b.active_own_all_cnt as active_30d_own_all_cnt\nfrom active_cnt a\ncross join active_all_cnt b",
        "status": "success",
        "result": [
            {
                "active_30d_user_cnt": 18,
                "active_30d_own_all_cnt": 3
            }
        ]
    },
    {
        "sql_id": "sql_13",
        "sql": "WITH login_window AS (\n  SELECT\n    iuserid,\n    COUNT(DISTINCT statis_date) AS active_days,\n    MAX(statis_date) AS last_active_date\n  FROM dws_argothek_oss_login_di\n  WHERE statis_date BETWEEN 20230712 AND 20250612\n  GROUP BY iuserid\n), qualified_login AS (\n  SELECT iuserid\n  FROM login_window\n  WHERE active_days >= 30\n    AND last_active_date < 20250312\n), pay_window AS (\n  SELECT\n    iuserid,\n    SUM(ftranamt) / 100.0 AS total_pay\n  FROM dws_argothek_oss_portaltransaction_di\n  WHERE statis_date BETWEEN '20230712' AND '20250612'\n  GROUP BY iuserid\n), filtered_user AS (\n  SELECT\n    q.iuserid,\n    COALESCE(p.total_pay, 0) AS total_pay\n  FROM qualified_login q\n  LEFT JOIN pay_window p\n    ON q.iuserid = p.iuserid\n  WHERE COALESCE(p.total_pay, 0) <= 1500\n), wxid_map AS (\n  SELECT\n    splayerid AS iuserid,\n    swxid\n  FROM dim_mgamejp_tbplayerid2wxid_nf\n  WHERE dtstatdate = 20250612\n    AND sappid IN ('qq', 'wx')\n    AND swxid IS NOT NULL\n)\nSELECT DISTINCT\n  m.swxid AS player_wxid\nFROM filtered_user f\nJOIN wxid_map m\n  ON f.iuserid = m.iuserid\nWHERE m.swxid <> ''\nORDER BY player_wxid",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_14",
        "sql": "with may_active as (\n  select distinct iuserid\n  from dws_argothek_oss_login_di\n  where statis_date between 20250501 and 20250531\n),\njune_active as (\n  select distinct iuserid\n  from dws_argothek_oss_login_di\n  where statis_date between 20250601 and 20250630\n),\nqq_map as (\n  select iuserid, suserid\n  from dim_argothek_gplayerid2qqwxid_df\n  where dtstatdate = '20250610'\n    and swxid_type = 'qq'\n    and suserid is not null\n)\nselect distinct m.suserid\nfrom may_active a\njoin qq_map m\n  on a.iuserid = m.iuserid\nleft join june_active j\n  on a.iuserid = j.iuserid\nwhere j.iuserid is null\norder by m.suserid",
        "status": "success",
        "result": [
            {
                "suserid": "10001"
            },
            {
                "suserid": "10002"
            },
            {
                "suserid": "10003"
            },
            {
                "suserid": "10004"
            },
            {
                "suserid": "10005"
            },
            {
                "suserid": "10006"
            },
            {
                "suserid": "10007"
            },
            {
                "suserid": "10008"
            }
        ]
    },
    {
        "sql_id": "sql_15",
        "sql": "with lost_may as (\n  select distinct iuserid\n  from dws_argothek_oss_useractivity_df\n  where statis_date = 20250608\n    and instr(substr(reverse(rpad(iactivity, 128, '0')), 1, 31), '1') = 0\n    and instr(substr(reverse(rpad(iactivity, 128, '0')), 32, 31), '1') > 0\n),\nmap_info as (\n  select\n    iuserid,\n    suserid,\n    swxid_type\n  from dim_argothek_gplayerid2qqwxid_df\n  where dtstatdate = '20250608'\n    and suserid is not null\n    and swxid_type in ('qq', 'wx', 'wxid')\n),\npc_active as (\n  select distinct\n    suserid,\n    suseridtype\n  from dws_mgamejp_login_user_activity_di\n  where dtstatdate between '20250601' and '20250630'\n    and sgamecode = 'initiatived'\n    and itimes >= 1\n    and saccounttype = '-100'\n    and suseridtype in ('qq', 'wxid', 'wx')\n    and splattype = 'PC'\n    and splat = '-100'\n)\nselect distinct l.iuserid as gplayerid\nfrom lost_may l\njoin map_info m\n  on l.iuserid = m.iuserid\njoin pc_active p\n  on p.suserid = m.suserid\n and p.suseridtype = case when m.swxid_type = 'wxid' then 'wx' else m.swxid_type end\norder by gplayerid",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_16",
        "sql": "WITH base AS (\n  SELECT\n    DATE_FORMAT(CAST(dteventtime AS DATETIME), '%Y%m%d') AS statis_date,\n    matchid,\n    MAX(CASE WHEN LOWER(completionstate) = 'surrendered' THEN 1 ELSE 0 END) AS is_surrender,\n    MAX(roundswon) AS max_rounds_won,\n    MIN(roundswon) AS min_rounds_won,\n    MAX(competitivetier) AS max_tier\n  FROM dwd_argothek_playermatchstats_hi\n  WHERE queueid = 'competitive'\n    AND DATE_FORMAT(CAST(dteventtime AS DATETIME), '%Y%m%d') BETWEEN '20230712' AND '20250531'\n  GROUP BY DATE_FORMAT(CAST(dteventtime AS DATETIME), '%Y%m%d'), matchid\n), enriched AS (\n  SELECT\n    statis_date,\n    matchid,\n    CASE\n      WHEN max_tier IN (3, 4, 5) THEN '黑铁'\n      WHEN max_tier IN (6, 7, 8) THEN '黄铜'\n      WHEN max_tier IN (9, 10, 11) THEN '白银'\n      WHEN max_tier IN (12, 13, 14) THEN '黄金'\n      WHEN max_tier IN (15, 16, 17) THEN '白金'\n      WHEN max_tier IN (18, 19, 20) THEN '钻石'\n      WHEN max_tier IN (21, 22, 23) THEN '超凡'\n      WHEN max_tier >= 24 THEN '神话及以上'\n      ELSE '无段位'\n    END AS rank_bucket,\n    is_surrender,\n    CASE WHEN ABS(max_rounds_won - min_rounds_won) >= 6 THEN 1 ELSE 0 END AS diff_ge_6,\n    CASE WHEN ABS(max_rounds_won - min_rounds_won) >= 8 THEN 1 ELSE 0 END AS diff_ge_8\n  FROM base\n), daily_rank AS (\n  SELECT\n    statis_date,\n    rank_bucket,\n    SUM(CASE WHEN is_surrender = 0 THEN 1 ELSE 0 END) AS non_surrender_match_cnt,\n    SUM(CASE WHEN is_surrender = 1 THEN 1 ELSE 0 END) AS surrender_match_cnt,\n    SUM(CASE WHEN is_surrender = 0 AND diff_ge_6 = 1 THEN 1 ELSE 0 END) AS diff_ge6_match_cnt,\n    SUM(CASE WHEN is_surrender = 0 AND diff_ge_8 = 1 THEN 1 ELSE 0 END) AS diff_ge8_match_cnt\n  FROM enriched\n  GROUP BY statis_date, rank_bucket\n), daily_all AS (\n  SELECT\n    statis_date,\n    '全量段位' AS rank_bucket,\n    SUM(CASE WHEN is_surrender = 0 THEN 1 ELSE 0 END) AS non_surrender_match_cnt,\n    SUM(CASE WHEN is_surrender = 1 THEN 1 ELSE 0 END) AS surrender_match_cnt,\n    SUM(CASE WHEN is_surrender = 0 AND diff_ge_6 = 1 THEN 1 ELSE 0 END) AS diff_ge6_match_cnt,\n    SUM(CASE WHEN is_surrender = 0 AND diff_ge_8 = 1 THEN 1 ELSE 0 END) AS diff_ge8_match_cnt\n  FROM enriched\n  GROUP BY statis_date\n)\nSELECT\n  statis_date AS statis_date,\n  rank_bucket AS rank_name,\n  non_surrender_match_cnt AS non_surrender_match_cnt,\n  surrender_match_cnt AS surrender_match_cnt,\n  diff_ge6_match_cnt AS diff_ge6_match_cnt,\n  diff_ge8_match_cnt AS diff_ge8_match_cnt\nFROM daily_rank\nUNION ALL\nSELECT\n  statis_date,\n  rank_bucket,\n  non_surrender_match_cnt,\n  surrender_match_cnt,\n  diff_ge6_match_cnt,\n  diff_ge8_match_cnt\nFROM daily_all\nORDER BY statis_date, rank_name",
        "status": "success",
        "result": [
            {
                "statis_date": "20240601",
                "rank_name": "全量段位",
                "non_surrender_match_cnt": 3,
                "surrender_match_cnt": 1,
                "diff_ge6_match_cnt": 0,
                "diff_ge8_match_cnt": 0
            },
            {
                "statis_date": "20240601",
                "rank_name": "白金",
                "non_surrender_match_cnt": 0,
                "surrender_match_cnt": 1,
                "diff_ge6_match_cnt": 0,
                "diff_ge8_match_cnt": 0
            },
            {
                "statis_date": "20240601",
                "rank_name": "白银",
                "non_surrender_match_cnt": 1,
                "surrender_match_cnt": 0,
                "diff_ge6_match_cnt": 0,
                "diff_ge8_match_cnt": 0
            },
            {
                "statis_date": "20240601",
                "rank_name": "神话及以上",
                "non_surrender_match_cnt": 1,
                "surrender_match_cnt": 0,
                "diff_ge6_match_cnt": 0,
                "diff_ge8_match_cnt": 0
            },
            {
                "statis_date": "20240601",
                "rank_name": "黄金",
                "non_surrender_match_cnt": 1,
                "surrender_match_cnt": 0,
                "diff_ge6_match_cnt": 0,
                "diff_ge8_match_cnt": 0
            },
            {
                "statis_date": "20240602",
                "rank_name": "全量段位",
                "non_surrender_match_cnt": 3,
                "surrender_match_cnt": 1,
                "diff_ge6_match_cnt": 0,
                "diff_ge8_match_cnt": 0
            },
            {
                "statis_date": "20240602",
                "rank_name": "超凡",
                "non_surrender_match_cnt": 1,
                "surrender_match_cnt": 0,
                "diff_ge6_match_cnt": 0,
                "diff_ge8_match_cnt": 0
            },
            {
                "statis_date": "20240602",
                "rank_name": "钻石",
                "non_surrender_match_cnt": 1,
                "surrender_match_cnt": 0,
                "diff_ge6_match_cnt": 0,
                "diff_ge8_match_cnt": 0
            },
            {
                "statis_date": "20240602",
                "rank_name": "黄铜",
                "non_surrender_match_cnt": 0,
                "surrender_match_cnt": 1,
                "diff_ge6_match_cnt": 0,
                "diff_ge8_match_cnt": 0
            },
            {
                "statis_date": "20240602",
                "rank_name": "黑铁",
                "non_surrender_match_cnt": 1,
                "surrender_match_cnt": 0,
                "diff_ge6_match_cnt": 0,
                "diff_ge8_match_cnt": 0
            }
        ]
    },
    {
        "sql_id": "sql_18",
        "sql": "select\n  statis_date,\n  iloginway,\n  count(distinct iuserid) as player_cnt\nfrom dws_argothek_oss_login_di\nwhere statis_date between 20250506 and 20250512\n  and iloginway in (1,10,11,12,20,28,29,30,31,32,33,34,35,36)\ngroup by statis_date, iloginway\norder by statis_date, iloginway",
        "status": "success",
        "result": [
            {
                "statis_date": 20250506,
                "iloginway": 1,
                "player_cnt": 2
            },
            {
                "statis_date": 20250506,
                "iloginway": 10,
                "player_cnt": 1
            },
            {
                "statis_date": 20250507,
                "iloginway": 11,
                "player_cnt": 1
            },
            {
                "statis_date": 20250508,
                "iloginway": 12,
                "player_cnt": 1
            },
            {
                "statis_date": 20250509,
                "iloginway": 35,
                "player_cnt": 1
            },
            {
                "statis_date": 20250510,
                "iloginway": 20,
                "player_cnt": 1
            },
            {
                "statis_date": 20250511,
                "iloginway": 28,
                "player_cnt": 1
            }
        ]
    },
    {
        "sql_id": "sql_19",
        "sql": "WITH active_login AS (\n  SELECT\n    statis_date,\n    iuserid\n  FROM dws_argothek_oss_login_di\n  WHERE statis_date BETWEEN 20250426 AND 20250502\n  GROUP BY statis_date, iuserid\n), role_map AS (\n  SELECT vroleid, iuserid\n  FROM (\n    SELECT\n      vroleid,\n      iuserid,\n      ROW_NUMBER() OVER (PARTITION BY vroleid ORDER BY dtstatdate DESC) AS rn\n    FROM dim_argothek_gplayerid_vroleid_df\n    WHERE iAreaID = '101'\n      AND dtstatdate <= '20250502'\n  ) t\n  WHERE rn = 1\n), match_log AS (\n  SELECT\n    DATE_FORMAT(CAST(dteventtime AS DATETIME), '%Y%m%d') AS statis_date,\n    vroleid,\n    LOWER(queueid) AS queueid\n  FROM dwd_argothek_playermatchstats_hi\n  WHERE DATE_FORMAT(CAST(dteventtime AS DATETIME), '%Y%m%d') BETWEEN '20250426' AND '20250502'\n), match_player AS (\n  SELECT\n    m.statis_date,\n    r.iuserid,\n    m.queueid\n  FROM match_log m\n  JOIN role_map r\n    ON m.vroleid = r.vroleid\n), player_modes AS (\n  SELECT\n    a.statis_date,\n    a.iuserid,\n    COUNT(DISTINCT mp.queueid) AS total_modes_cnt,\n    MAX(CASE WHEN mp.queueid = 'quickmatch' THEN 1 ELSE 0 END) AS has_quick,\n    MAX(CASE WHEN mp.queueid = 'rushmode' THEN 1 ELSE 0 END) AS has_rush,\n    MAX(CASE WHEN mp.queueid = 'combatarena' THEN 1 ELSE 0 END) AS has_combat,\n    MAX(CASE WHEN mp.queueid IS NOT NULL AND mp.queueid NOT IN ('quickmatch', 'rushmode', 'combatarena') THEN 1 ELSE 0 END) AS has_other\n  FROM active_login a\n  LEFT JOIN match_player mp\n    ON a.statis_date = mp.statis_date\n   AND a.iuserid = mp.iuserid\n  GROUP BY a.statis_date, a.iuserid\n), player_day_flags AS (\n  SELECT\n    statis_date,\n    iuserid,\n    CASE WHEN total_modes_cnt = 1 AND has_quick = 1 THEN 1 ELSE 0 END AS only_quick_flag,\n    CASE WHEN total_modes_cnt = 1 AND has_rush = 1 THEN 1 ELSE 0 END AS only_rush_flag,\n    CASE WHEN total_modes_cnt = 1 AND has_combat = 1 THEN 1 ELSE 0 END AS only_combat_flag,\n    CASE WHEN total_modes_cnt > 0 AND COALESCE(has_other, 0) = 0 THEN 1 ELSE 0 END AS only_three_flag\n  FROM player_modes\n), daily_summary AS (\n  SELECT\n    statis_date,\n    SUM(only_quick_flag) AS only_quick_user_cnt,\n    SUM(only_rush_flag) AS only_rush_user_cnt,\n    SUM(only_combat_flag) AS only_combat_user_cnt,\n    SUM(only_three_flag) AS only_three_modes_user_cnt\n  FROM player_day_flags\n  GROUP BY statis_date\n), weekly_freq AS (\n  SELECT SUM(only_three_flag) AS only_three_modes_week_freq\n  FROM player_day_flags\n)\nSELECT\n  d.statis_date AS statis_date,\n  d.only_quick_user_cnt AS only_quick_user_cnt,\n  d.only_rush_user_cnt AS only_rush_user_cnt,\n  d.only_combat_user_cnt AS only_combat_user_cnt,\n  d.only_three_modes_user_cnt AS only_three_modes_user_cnt,\n  wf.only_three_modes_week_freq AS only_three_modes_week_freq\nFROM daily_summary d\nCROSS JOIN weekly_freq wf\nORDER BY statis_date",
        "status": "success",
        "result": [
            {
                "statis_date": 20250426,
                "only_quick_user_cnt": 0,
                "only_rush_user_cnt": 0,
                "only_combat_user_cnt": 0,
                "only_three_modes_user_cnt": 0,
                "only_three_modes_week_freq": 5
            },
            {
                "statis_date": 20250427,
                "only_quick_user_cnt": 0,
                "only_rush_user_cnt": 0,
                "only_combat_user_cnt": 0,
                "only_three_modes_user_cnt": 0,
                "only_three_modes_week_freq": 5
            },
            {
                "statis_date": 20250428,
                "only_quick_user_cnt": 0,
                "only_rush_user_cnt": 0,
                "only_combat_user_cnt": 0,
                "only_three_modes_user_cnt": 0,
                "only_three_modes_week_freq": 5
            },
            {
                "statis_date": 20250429,
                "only_quick_user_cnt": 0,
                "only_rush_user_cnt": 0,
                "only_combat_user_cnt": 0,
                "only_three_modes_user_cnt": 0,
                "only_three_modes_week_freq": 5
            },
            {
                "statis_date": 20250501,
                "only_quick_user_cnt": 0,
                "only_rush_user_cnt": 0,
                "only_combat_user_cnt": 0,
                "only_three_modes_user_cnt": 0,
                "only_three_modes_week_freq": 5
            },
            {
                "statis_date": 20250502,
                "only_quick_user_cnt": 1,
                "only_rush_user_cnt": 1,
                "only_combat_user_cnt": 1,
                "only_three_modes_user_cnt": 5,
                "only_three_modes_week_freq": 5
            }
        ]
    },
    {
        "sql_id": "sql_20",
        "sql": "WITH netbar_users AS (\n  SELECT DISTINCT iuserid AS player_id\n  FROM dwd_argothek_playerlogout_hi\n  WHERE CAST(dteventtime AS DATE) BETWEEN '2024-01-01' AND '2024-04-30'\n    AND inetbarlevel = '2'\n),\nlogin_agg AS (\n  SELECT\n    DATE_FORMAT(STR_TO_DATE(CAST(statis_date AS VARCHAR), '%Y%m%d'), '%Y%m') AS stat_month,\n    iuserid AS player_id,\n    SUM(ionlinetime) AS total_online_time,\n    SUM(CASE WHEN iloginway IN (1,10,11,12,20,28,29,30,31,32,33,34,35,36) THEN ionlinetime ELSE 0 END) AS netbar_online_time,\n    COUNT(DISTINCT statis_date) AS active_days\n  FROM dws_argothek_oss_login_di\n  WHERE statis_date BETWEEN 20240101 AND 20240430\n    AND iuserid IN (SELECT player_id FROM netbar_users)\n  GROUP BY stat_month, iuserid\n),\nmatch_agg AS (\n  SELECT\n    DATE_FORMAT(CAST(dteventtime AS DATE), '%Y%m') AS stat_month,\n    vroleid AS player_id,\n    SUM(gamelengthmillis) / 1000.0 AS total_match_seconds,\n    SUM(CASE WHEN queueid = 'competitive' THEN gamelengthmillis ELSE 0 END) / 1000.0 AS competitive_seconds,\n    SUM(CASE WHEN queueid = 'competitive' THEN 1 ELSE 0 END) AS competitive_matches,\n    SUM(CASE WHEN queueid = 'competitive' AND partyid IS NOT NULL AND partyid <> '' THEN 1 ELSE 0 END) AS competitive_team_matches,\n    COUNT(DISTINCT CAST(dteventtime AS DATE)) AS match_days\n  FROM dwd_argothek_playermatchstats_hi\n  WHERE CAST(dteventtime AS DATE) BETWEEN '2024-01-01' AND '2024-04-30'\n    AND vroleid IN (SELECT player_id FROM netbar_users)\n  GROUP BY stat_month, vroleid\n),\npay_agg AS (\n  SELECT\n    DATE_FORMAT(STR_TO_DATE(statis_date, '%Y%m%d'), '%Y%m') AS stat_month,\n    iuserid AS player_id,\n    SUM(ftranamt) / 100.0 AS pay_amount\n  FROM dws_argothek_oss_portaltransaction_di\n  WHERE statis_date BETWEEN '20240101' AND '20240430'\n    AND iuserid IN (SELECT player_id FROM netbar_users)\n  GROUP BY stat_month, iuserid\n),\ncampus_agg AS (\n  SELECT\n    DATE_FORMAT(CAST(dteventtime AS DATE), '%Y%m') AS stat_month,\n    iuserid AS player_id,\n    MAX(CASE WHEN icampuslevel IS NOT NULL AND icampuslevel <> '0' THEN 1 ELSE 0 END) AS campus_active\n  FROM dwd_argothek_playerlogout_hi\n  WHERE CAST(dteventtime AS DATE) BETWEEN '2024-01-01' AND '2024-04-30'\n    AND iuserid IN (SELECT player_id FROM netbar_users)\n  GROUP BY stat_month, iuserid\n),\nplayer_month AS (\n  SELECT stat_month, player_id FROM login_agg\n  UNION\n  SELECT stat_month, player_id FROM match_agg\n  UNION\n  SELECT stat_month, player_id FROM pay_agg\n  UNION\n  SELECT stat_month, player_id FROM campus_agg\n),\nmonthly_union AS (\n  SELECT\n    pm.stat_month,\n    pm.player_id,\n    COALESCE(l.total_online_time, 0) AS total_online_time,\n    COALESCE(l.netbar_online_time, 0) AS netbar_online_time,\n    COALESCE(l.active_days, 0) AS active_days,\n    COALESCE(m.total_match_seconds, 0) AS total_match_seconds,\n    COALESCE(m.competitive_seconds, 0) AS competitive_seconds,\n    COALESCE(m.competitive_matches, 0) AS competitive_matches,\n    COALESCE(m.competitive_team_matches, 0) AS competitive_team_matches,\n    COALESCE(m.match_days, 0) AS match_days,\n    COALESCE(p.pay_amount, 0) AS pay_amount,\n    COALESCE(c.campus_active, 0) AS campus_active\n  FROM player_month pm\n  LEFT JOIN login_agg l ON pm.stat_month = l.stat_month AND pm.player_id = l.player_id\n  LEFT JOIN match_agg m ON pm.stat_month = m.stat_month AND pm.player_id = m.player_id\n  LEFT JOIN pay_agg p ON pm.stat_month = p.stat_month AND pm.player_id = p.player_id\n  LEFT JOIN campus_agg c ON pm.stat_month = c.stat_month AND pm.player_id = c.player_id\n),\nmonths AS (\n  SELECT '202401' AS stat_month UNION ALL\n  SELECT '202402' UNION ALL\n  SELECT '202403' UNION ALL\n  SELECT '202404'\n),\nfinal_stats AS (\n  SELECT\n    stat_month,\n    COUNT(DISTINCT player_id) AS player_cnt,\n    SUM(total_match_seconds) AS total_match_seconds,\n    SUM(netbar_online_time) AS total_netbar_online_time,\n    SUM(total_online_time) AS total_online_time,\n    SUM(match_days) AS match_days,\n    SUM(competitive_seconds) AS total_competitive_seconds,\n    SUM(competitive_team_matches) AS total_competitive_team_matches,\n    SUM(competitive_matches) AS total_competitive_matches,\n    SUM(pay_amount) AS total_pay_amount,\n    COUNT(DISTINCT CASE WHEN pay_amount > 0 THEN player_id END) AS pay_user_cnt,\n    SUM(campus_active) AS campus_active_sum\n  FROM monthly_union\n  GROUP BY stat_month\n)\nSELECT\n  m.stat_month,\n  COALESCE(ROUND(final_stats.total_match_seconds / 3600 / NULLIF(final_stats.player_cnt, 0), 4), 0) AS avg_match_hours,\n  COALESCE(ROUND(final_stats.total_netbar_online_time / NULLIF(final_stats.total_online_time, 0), 4), 0) AS netbar_time_ratio,\n  COALESCE(final_stats.match_days, 0) AS match_days_cnt,\n  COALESCE(ROUND(final_stats.total_competitive_seconds / 3600, 4), 0) AS competitive_hours,\n  COALESCE(ROUND(final_stats.total_competitive_team_matches / NULLIF(final_stats.total_competitive_matches, 0), 4), 0) AS competitive_team_rate,\n  COALESCE(ROUND(final_stats.pay_user_cnt / NULLIF(final_stats.player_cnt, 0), 4), 0) AS pay_rate,\n  COALESCE(ROUND(final_stats.total_pay_amount / NULLIF(final_stats.player_cnt, 0), 4), 0) AS arpa,\n  COALESCE(ROUND(final_stats.total_pay_amount / NULLIF(final_stats.pay_user_cnt, 0), 4), 0) AS arppa,\n  COALESCE(ROUND(final_stats.campus_active_sum / NULLIF(final_stats.player_cnt, 0), 4), 0) AS campus_active_rate\nFROM months m\nLEFT JOIN final_stats ON m.stat_month = final_stats.stat_month\nORDER BY m.stat_month",
        "status": "success",
        "result": [
            {
                "stat_month": "202401",
                "avg_match_hours": 0,
                "netbar_time_ratio": 0,
                "match_days_cnt": 0,
                "competitive_hours": 0,
                "competitive_team_rate": 0,
                "pay_rate": 0,
                "arpa": 0,
                "arppa": 0,
                "campus_active_rate": 0.4
            },
            {
                "stat_month": "202402",
                "avg_match_hours": 0,
                "netbar_time_ratio": 0,
                "match_days_cnt": 0,
                "competitive_hours": 0,
                "competitive_team_rate": 0,
                "pay_rate": 0,
                "arpa": 0,
                "arppa": 0,
                "campus_active_rate": 0.4
            },
            {
                "stat_month": "202403",
                "avg_match_hours": 0,
                "netbar_time_ratio": 0,
                "match_days_cnt": 0,
                "competitive_hours": 0,
                "competitive_team_rate": 0,
                "pay_rate": 0,
                "arpa": 0,
                "arppa": 0,
                "campus_active_rate": 0.33
            },
            {
                "stat_month": "202404",
                "avg_match_hours": 0,
                "netbar_time_ratio": 0,
                "match_days_cnt": 0,
                "competitive_hours": 0,
                "competitive_team_rate": 0,
                "pay_rate": 0,
                "arpa": 0,
                "arppa": 0,
                "campus_active_rate": 0.5
            }
        ]
    },
    {
        "sql_id": "sql_22",
        "sql": "with login_stat as (\n  select\n    iuserid,\n    count(distinct statis_date) as login_days\n  from dws_argothek_oss_login_di\n  where statis_date between 20250330 and 20250428\n    and iloginway = 3\n  group by iuserid\n  having login_days between 5 and 8\n),\nmax_days as (\n  select max(login_days) as max_login_days from login_stat\n),\nqq_map as (\n  select\n    iuserid,\n    suserid\n  from dim_argothek_gplayerid2qqwxid_df\n  where dtstatdate = '20250428'\n    and swxid_type = 'qq'\n    and suserid is not null\n)\nselect distinct q.suserid as qq\nfrom login_stat l\njoin max_days m on l.login_days = m.max_login_days\njoin qq_map q on l.iuserid = q.iuserid\norder by qq",
        "status": "success",
        "result": [
            {
                "qq": "12345678"
            }
        ]
    },
    {
        "sql_id": "sql_23",
        "sql": "with channel_login as (\n  select distinct iuserid\n  from dws_argothek_oss_login_di\n  where statis_date between 20250324 and 20250330\n    and iloginway = 3\n),\nrole_map as (\n  select\n    vroleid,\n    gplayerid\n  from (\n    select\n      vroleid,\n      iuserid as gplayerid,\n      row_number() over(partition by vroleid order by dtstatdate desc) as rn\n    from dim_argothek_gplayerid_vroleid_df\n    where dtstatdate <= '20250330'\n  ) t\n  where rn = 1\n),\nmatch_player as (\n  select distinct rm.gplayerid\n  from dwd_argothek_playermatchstats_hi s\n  join role_map rm on s.vroleid = rm.vroleid\n  where substr(s.tdbank_imp_date, 1, 8) between '20250324' and '20250330'\n    and coalesce(s.ismatchcompleted, 1) = 1\n),\nqq_map as (\n  select iuserid, suserid\n  from dim_argothek_gplayerid2qqwxid_df\n  where dtstatdate = '20250330'\n    and swxid_type = 'qq'\n    and suserid is not null\n)\nselect distinct q.suserid as qq\nfrom match_player mp\njoin channel_login cl on mp.gplayerid = cl.iuserid\njoin qq_map q on mp.gplayerid = q.iuserid\norder by qq",
        "status": "success",
        "result": [
            {
                "qq": "1000000001"
            },
            {
                "qq": "1000000002"
            },
            {
                "qq": "1000000003"
            },
            {
                "qq": "1000000004"
            },
            {
                "qq": "1000000005"
            },
            {
                "qq": "1000000006"
            },
            {
                "qq": "1000000007"
            },
            {
                "qq": "1000000008"
            }
        ]
    },
    {
        "sql_id": "sql_24",
        "sql": "with heroes as (\n  select 'e370fa57-4757-3604-3648-499e1f642d3f' as hero_id, date '2023-07-26' as start_date union all\n  select 'cc8b64c8-4b25-4ff9-6e7f-37b4da43d235', date '2023-07-26' union all\n  select '0e38b510-41a8-5780-5e8f-568b2a4f2d6c', date '2023-11-01' union all\n  select '1dbf2edd-4729-0984-3115-daa5eed44993', date '2024-03-27' union all\n  select 'efba5359-4016-a1e5-7626-b1ae76895940', date '2024-08-29' union all\n  select 'b444168c-4e35-8076-db47-ef9bf368f384', date '2025-01-09' union all\n  select 'df1cb487-4902-002e-5c17-d28e83e78588', date '2025-03-06'\n),\nfirst_week_matches as (\n  select\n    h.hero_id,\n    h.start_date,\n    md.vplayerid,\n    count(*) as pick_cnt\n  from dwd_argothek_playermatchdetail_hi md\n  join heroes h on md.characterid = h.hero_id\n  where md.provisioningflowid = 'Matchmaking'\n    and cast(md.dteventtime as date) between h.start_date and date_add(h.start_date, interval 6 day)\n  group by h.hero_id, h.start_date, md.vplayerid\n),\nhero_summary as (\n  select\n    hero_id,\n    count(*) as total_players,\n    count_if(pick_cnt > 3) as players_over_3,\n    count_if(pick_cnt > 10) as players_over_10\n  from first_week_matches\n  group by hero_id\n)\nselect\n  hero_id,\n  players_over_3,\n  players_over_10,\n  total_players as players_over_0,\n  if(total_players = 0, 0, round(players_over_3 / total_players, 4)) as ratio_over_3,\n  if(total_players = 0, 0, round(players_over_10 / total_players, 4)) as ratio_over_10\nfrom hero_summary\norder by hero_id;",
        "status": "error",
        "error_message": "(1064, \"Column '`md`.`vplayerid`' cannot be resolved\")"
    },
    {
        "sql_id": "sql_26",
        "sql": "with valid_matches as (\n  select distinct matchid\n  from dwd_argothek_matchdetails_hi\n  where substr(tdbank_imp_date, 1, 8) between '20240101' and '20241216'\n    and provisioningflowid = 'Matchmaking'\n),\nflash_effect as (\n  select\n    tag,\n    sum(coalesce(amount, 0)) as total_cnt\n  from dwd_argothek_abilityinfo_effects_hi e\n  join valid_matches m on e.matchinfomatchid = m.matchid\n  where substr(e.tdbank_imp_date, 1, 8) between '20240101' and '20241216'\n    and tag in ('EnemiesBlinded', 'AlliesBlinded')\n  group by tag\n)\nselect\n  coalesce(max(case when tag = 'EnemiesBlinded' then total_cnt end), 0) as enemies_blinded_cnt,\n  coalesce(max(case when tag = 'AlliesBlinded' then total_cnt end), 0) as allies_blinded_cnt\nfrom flash_effect",
        "status": "success",
        "result": [
            {
                "enemies_blinded_cnt": 9,
                "allies_blinded_cnt": 6
            }
        ]
    },
    {
        "sql_id": "sql_27",
        "sql": "with valid_matches as (\n  select distinct matchid\n  from dwd_argothek_matchdetails_hi\n  where substr(tdbank_imp_date, 1, 8) between '20240101' and '20241216'\n    and provisioningflowid = 'Matchmaking'\n),\nproxy_buy as (\n  select\n    count(*) as buy_cnt\n  from dwd_argothek_apinventorymovementlog_hi l\n  join valid_matches m on l.matchinfomatchid = m.matchid\n  where substr(l.tdbank_imp_date, 1, 8) between '20240101' and '20241216'\n    and transactiontype = 'FulfillRequest'\n)\nselect buy_cnt as weapon_proxy_cnt from proxy_buy",
        "status": "success",
        "result": [
            {
                "weapon_proxy_cnt": 8
            }
        ]
    },
    {
        "sql_id": "sql_28",
        "sql": "select  a.itype,\n        a.dtstatdate,\n        datediff(b.dtstatdate,a.dtstatdate) as idaynum,\n        count(distinct a.vplayerid)           as iusernum\nfrom (                      \n    select\n        itype,\n        min(dtstatdate) as dtstatdate,\n        vplayerid\n    from  (\n        select '广域战场'      as itype,\n                min(dtstatdate) as dtstatdate,\n                vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240723' and dtstatdate <= date_add('20240723',6)\n        and submodename = '广域战场模式'\n        group by vplayerid\n\n        union all\n        select '消灭战', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20230804' and dtstatdate <= date_add('20230804',6)\n        and modename='组队竞技' and submodename like '%消灭战模式%'\n        group by vplayerid\n\n        union all\n        select '幻想混战', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20241115' and dtstatdate <= date_add('20241115',6)\n        and modename='创意创作间' and submodename='幻想混战'\n        group by vplayerid\n\n        union all\n        select '荒野传说', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240903' and dtstatdate <= date_add('20240903',6)\n        and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n        group by vplayerid\n\n        union all\n        select '策略载具', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20241010' and dtstatdate <= date_add('20241010',6)\n        and modename='休闲模式' and submodename like '%策略载具%'\n        group by vplayerid\n\n        union all\n        select '炎夏混战', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240625' and dtstatdate <= date_add('20240625',6)\n        and modename='创意创作间' and submodename like '%炎夏混战%'\n        group by vplayerid\n\n        union all\n        select '单人装备', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240517' and dtstatdate <= date_add('20240517',6)\n        and modename='组队竞技' and submodename like '%单人装备%'\n        group by vplayerid\n\n        union all\n        select '交叉堡垒', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240412' and dtstatdate <= date_add('20240412',6)\n        and modename='组队竞技' and submodename like '%交叉堡垒%'\n        group by vplayerid\n    ) t\n    group by itype, vplayerid\n) a\nleft join (\n        select '广域战场' as itype, dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240723' and dtstatdate <= date_add('20240723',13)\n          and submodename = '广域战场模式'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '消灭战', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20230804' and dtstatdate <= date_add('20230804',13)\n          and modename='组队竞技' and submodename like '%消灭战模式%'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '幻想混战', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20241115' and dtstatdate <= date_add('20241115',13)\n          and modename='创意创作间' and submodename='幻想混战'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '荒野传说', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240903' and dtstatdate <= date_add('20240903',13)\n          and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n        group by dtstatdate, vplayerid\n\n        union all\n        select '策略载具', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20241010' and dtstatdate <= date_add('20241010',13)\n          and modename='休闲模式' and submodename like '%策略载具%'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '炎夏混战', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240625' and dtstatdate <= date_add('20240625',13)\n          and modename='创意创作间' and submodename like '%炎夏混战%'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '单人装备', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240517' and dtstatdate <= date_add('20240517',13)\n          and modename='组队竞技' and submodename like '%单人装备%'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '交叉堡垒', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240412' and dtstatdate <= date_add('20240412',13)\n          and modename='组队竞技' and submodename like '%交叉堡垒%'\n        group by dtstatdate, vplayerid\n) b\n  on  a.itype      = b.itype\nand  a.vplayerid    = b.vplayerid\nwhere datediff(b.dtstatdate,a.dtstatdate) between 0 and 7\ngroup by a.itype, a.dtstatdate, datediff(b.dtstatdate,a.dtstatdate);\n",
        "status": "success",
        "result": [
            {
                "itype": "单人装备",
                "dtstatdate": "20240518",
                "idaynum": 0,
                "iusernum": 82
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240625",
                "idaynum": 1,
                "iusernum": 8
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240414",
                "idaynum": 0,
                "iusernum": 70
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240723",
                "idaynum": 7,
                "iusernum": 2
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240906",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241013",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240729",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240904",
                "idaynum": 1,
                "iusernum": 4
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240417",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241115",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240726",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240412",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240517",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230806",
                "idaynum": 1,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240517",
                "idaynum": 0,
                "iusernum": 88
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240519",
                "idaynum": 0,
                "iusernum": 55
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240413",
                "idaynum": 0,
                "iusernum": 85
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240903",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241010",
                "idaynum": 2,
                "iusernum": 4
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230805",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230810",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230808",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240724",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230805",
                "idaynum": 2,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241118",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230806",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230808",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240725",
                "idaynum": 0,
                "iusernum": 82
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240723",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240903",
                "idaynum": 2,
                "iusernum": 8
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230808",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230808",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241116",
                "idaynum": 1,
                "iusernum": 5
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230805",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240908",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230810",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241115",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230804",
                "idaynum": 1,
                "iusernum": 16
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241115",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230805",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241121",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240723",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230807",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240729",
                "idaynum": 2,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230810",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240724",
                "idaynum": 2,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230810",
                "idaynum": 2,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230807",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230809",
                "idaynum": 2,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240416",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240415",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240626",
                "idaynum": 0,
                "iusernum": 67
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240517",
                "idaynum": 2,
                "iusernum": 12
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240625",
                "idaynum": 2,
                "iusernum": 6
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241115",
                "idaynum": 1,
                "iusernum": 9
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240625",
                "idaynum": 7,
                "iusernum": 2
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240517",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240412",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240412",
                "idaynum": 2,
                "iusernum": 8
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240729",
                "idaynum": 1,
                "iusernum": 1
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241010",
                "idaynum": 7,
                "iusernum": 2
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230807",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230809",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240903",
                "idaynum": 7,
                "iusernum": 2
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240729",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241119",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230809",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241011",
                "idaynum": 0,
                "iusernum": 52
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230804",
                "idaynum": 0,
                "iusernum": 117
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240905",
                "idaynum": 0,
                "iusernum": 60
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241015",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230810",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240517",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230806",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240701",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240418",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240724",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241115",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230810",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240729",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240723",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240728",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240625",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230809",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230808",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230807",
                "idaynum": 2,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240904",
                "idaynum": 0,
                "iusernum": 74
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241010",
                "idaynum": 1,
                "iusernum": 3
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240626",
                "idaynum": 1,
                "iusernum": 5
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230806",
                "idaynum": 0,
                "iusernum": 88
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240903",
                "idaynum": 0,
                "iusernum": 90
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241012",
                "idaynum": 0,
                "iusernum": 50
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241010",
                "idaynum": 0,
                "iusernum": 73
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240517",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240723",
                "idaynum": 2,
                "iusernum": 8
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230804",
                "idaynum": 2,
                "iusernum": 8
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240628",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230808",
                "idaynum": 2,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240903",
                "idaynum": 1,
                "iusernum": 5
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240412",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230810",
                "idaynum": 1,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240903",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230805",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240909",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241010",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240724",
                "idaynum": 0,
                "iusernum": 89
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241116",
                "idaynum": 0,
                "iusernum": 94
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230805",
                "idaynum": 0,
                "iusernum": 96
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241010",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241115",
                "idaynum": 2,
                "iusernum": 6
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240625",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241011",
                "idaynum": 1,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230807",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230809",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241120",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240412",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230809",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230806",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240724",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240412",
                "idaynum": 0,
                "iusernum": 100
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240627",
                "idaynum": 0,
                "iusernum": 53
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240724",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230810",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240518",
                "idaynum": 1,
                "iusernum": 6
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240907",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230804",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241010",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240625",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240729",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240523",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230807",
                "idaynum": 1,
                "iusernum": 1
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240625",
                "idaynum": 0,
                "iusernum": 83
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240723",
                "idaynum": 1,
                "iusernum": 15
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241014",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240903",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240517",
                "idaynum": 1,
                "iusernum": 4
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241115",
                "idaynum": 7,
                "iusernum": 2
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241010",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230809",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240903",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230807",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230808",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240729",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240412",
                "idaynum": 7,
                "iusernum": 2
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230806",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230806",
                "idaynum": 2,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240522",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240412",
                "idaynum": 1,
                "iusernum": 12
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240625",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241016",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240517",
                "idaynum": 7,
                "iusernum": 2
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230808",
                "idaynum": 1,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240729",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240723",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240724",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230806",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230805",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240723",
                "idaynum": 0,
                "iusernum": 117
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241115",
                "idaynum": 0,
                "iusernum": 88
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230805",
                "idaynum": 1,
                "iusernum": 10
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241117",
                "idaynum": 0,
                "iusernum": 59
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240724",
                "idaynum": 1,
                "iusernum": 10
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240413",
                "idaynum": 1,
                "iusernum": 6
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240630",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240629",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230809",
                "idaynum": 1,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240727",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240521",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230807",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240520",
                "idaynum": 0,
                "iusernum": 1
            }
        ]
    },
    {
        "sql_id": "sql_29",
        "sql": "with daily_play as (\n  select\n    date(str_to_date(dtstatdate, '%Y%m%d')) as play_date,\n    date_sub(date(str_to_date(dtstatdate, '%Y%m%d')), interval weekday(str_to_date(dtstatdate, '%Y%m%d')) day) as week_start,\n    case\n      when modename = '传统模式' and submodename like 'CG%' and mapname = '群屿' then '主题群屿'\n      when modename = '传统模式' and mapname = '群屿' then '传统群屿'\n      when modename = '传统模式' and mapname = '假日群岛' then '假日群岛'\n      when modename = '传统模式' and mapname = '荣耀之城' then '荣耀之城'\n      when submodename = '广域战场模式' then '广域战场'\n      when submodename = '极能形态模式' then '极能形态'\n      when modename = '组队竞技' then '组竞'\n      when modename = '休闲模式' then '休闲'\n      when modename = '乐园' then '乐园'\n      when modename = '领地' then '领地'\n      when modename = '广阔天地' then '广阔天地'\n      when modename = '生存模式' then '隧道'\n      else '其他模式'\n    end as gameplay,\n    count(distinct vplayerid) as participants,\n    count(distinct matchid) as match_cnt\n  from dws_jordass_mode_roundrecord_di\n  where dtstatdate between '20240618' and '20250330'\n  group by 1,2,3\n),\ndaily_active as (\n  select\n    date(str_to_date(dtstatdate, '%Y%m%d')) as act_date,\n    date_sub(date(str_to_date(dtstatdate, '%Y%m%d')), interval weekday(str_to_date(dtstatdate, '%Y%m%d')) day) as week_start,\n    count(distinct vplayerid) as active_cnt\n  from dws_jordass_login_di\n  where dtstatdate between '20240618' and '20250330'\n  group by 1,2\n),\nmerged as (\n  select\n    p.week_start,\n    p.play_date,\n    p.gameplay,\n    p.participants,\n    p.match_cnt,\n    coalesce(a.active_cnt, 0) as active_cnt,\n    case when coalesce(a.active_cnt,0) = 0 then 0 else p.participants / a.active_cnt end as daily_rate,\n    case when p.participants = 0 then 0 else p.match_cnt / p.participants end as daily_avg_match\n  from daily_play p\n  left join daily_active a\n    on p.play_date = a.act_date\n   and p.week_start = a.week_start\n),\nweekly_stats as (\n  select\n    week_start,\n    gameplay,\n    count(distinct play_date) as days_in_week,\n    sum(participants) as total_participants,\n    sum(active_cnt) as total_active,\n    sum(match_cnt) as total_matches,\n    avg(participants) as avg_daily_participants,\n    avg(daily_rate) as avg_daily_rate,\n    avg(daily_avg_match) as avg_daily_matches\n  from merged\n  group by 1,2\n)\nselect\n  date_format(week_start, '%Y%m%d') as week_start_label,\n  gameplay,\n  round(avg_daily_participants, 2) as avg_daily_participants,\n  round(avg_daily_rate, 4) as avg_daily_participation_rate,\n  round(avg_daily_matches, 4) as avg_daily_matches\nfrom weekly_stats\nwhere week_start between date '2024-06-17' and date '2025-03-24'\norder by week_start, gameplay;",
        "status": "error",
        "error_message": "(1064, 'No matching function with signature: weekday(date).')"
    },
    {
        "sql_id": "sql_30",
        "sql": "with main_user as (\n    select substr(dtstatdate, 1, 6) mons,\n        case\n            when modename = '传统模式' and submodename like 'CG%' and mapname = '群屿' then '主题群屿'\n            when modename = '传统模式' and mapname = '群屿' then '传统群屿'\n            when modename = '传统模式' and mapname = '假日群岛' then '假日群岛'\n            when modename = '传统模式' and mapname = '荣耀之城' then '荣耀之城'\n            when submodename = '广域战场模式' then '广域战场'\n            when submodename = '极能形态模式' then '极能形态'\n            when modename = '组队竞技' then '组竞'\n            when modename = '乐园' then '乐园'\n            when modename = '领地' then '领地'\n            when modename = '广阔天地' then '广阔天地'\n            else '其他模式'\n        end imodename,\n        vplayerid,\n        sum(roundtime) / 60 roundtime,\n        sum(roundcnt) roundcnt\n   from dws_jordass_mode_roundrecord_di\n   where dtstatdate between '20190508' and '20250330'\n   group by vplayerid, substr(dtstatdate, 1, 6),\n        case\n            when modename = '传统模式' and submodename like 'CG%' and mapname = '群屿' then '主题群屿'\n            when modename = '传统模式' and mapname = '群屿' then '传统群屿'\n            when modename = '传统模式' and mapname = '假日群岛' then '假日群岛'\n            when modename = '传统模式' and mapname = '荣耀之城' then '荣耀之城'\n            when submodename = '广域战场模式' then '广域战场'\n            when submodename = '极能形态模式' then '极能形态'\n            when modename = '组队竞技' then '组竞'\n            when modename = '乐园' then '乐园'\n            when modename = '领地' then '领地'\n            when modename = '广阔天地' then '广阔天地'\n            else '其他模式'\n        end\n\n   union all\n   \n   select substr (tdbank_imp_date, 1, 6) mons,\n        '隧道' as modename,\n        vplayerid,\n        sum(roundtime) / 60 roundtime,\n        count(distinct gameid) roundcnt\n   from dwd_jordass_playerexitgamerecord_hi\n   where tdbank_imp_date between '2024061800' and '2025033023'\n     and mode in (3001, 3002, 3003)\n   group by substr (tdbank_imp_date, 1, 6), vplayerid\n)\n\nselect a.mons,\n       a.imodename,\n       a.iusernum,\n       b.iusernumall\nfrom (\n    select mons,\n          imodename,\n          count(vplayerid) iusernum\n    from (\n        select mons, vplayerid, imodename\n        from (\n            select mons,\n                vplayerid,\n                imodename,\n                roundtime,\n                row_number() over (partition by mons, vplayerid order by roundtime desc) as rn\n            from main_user\n        )ff1\n        where rn = 1\n    )f1\n   group by mons, imodename\n) a\nleft join (\n    select mons,\n        imodename,\n        count(vplayerid) iusernumall\n   from main_user\n   group by mons, imodename\n) b \non a.imodename = b.imodename and a.mons = b.mons\norder by a.mons, a.imodename\n;",
        "status": "success",
        "result": [
            {
                "mons": "201905",
                "imodename": "主题群屿",
                "iusernum": 119,
                "iusernumall": 119
            },
            {
                "mons": "201905",
                "imodename": "乐园",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "201905",
                "imodename": "传统群屿",
                "iusernum": 4,
                "iusernumall": 4
            },
            {
                "mons": "201905",
                "imodename": "假日群岛",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "201905",
                "imodename": "其他模式",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "201905",
                "imodename": "广阔天地",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "201905",
                "imodename": "组竞",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "201905",
                "imodename": "荣耀之城",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "201905",
                "imodename": "领地",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "201906",
                "imodename": "传统群屿",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "201908",
                "imodename": "假日群岛",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "201909",
                "imodename": "荣耀之城",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "201910",
                "imodename": "广域战场",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "201911",
                "imodename": "极能形态",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "201912",
                "imodename": "组竞",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202001",
                "imodename": "主题群屿",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202001",
                "imodename": "乐园",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202001",
                "imodename": "传统群屿",
                "iusernum": 3,
                "iusernumall": 3
            },
            {
                "mons": "202001",
                "imodename": "假日群岛",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202001",
                "imodename": "其他模式",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202001",
                "imodename": "广阔天地",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202001",
                "imodename": "组竞",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202001",
                "imodename": "荣耀之城",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202001",
                "imodename": "领地",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202002",
                "imodename": "领地",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202004",
                "imodename": "其他模式",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202006",
                "imodename": "假日群岛",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202007",
                "imodename": "荣耀之城",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202008",
                "imodename": "广域战场",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202009",
                "imodename": "极能形态",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202010",
                "imodename": "组竞",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202011",
                "imodename": "乐园",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202012",
                "imodename": "领地",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202101",
                "imodename": "广阔天地",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202102",
                "imodename": "其他模式",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202103",
                "imodename": "传统群屿",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202104",
                "imodename": "假日群岛",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202105",
                "imodename": "荣耀之城",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202106",
                "imodename": "乐园",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202106",
                "imodename": "传统群屿",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202106",
                "imodename": "假日群岛",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202106",
                "imodename": "其他模式",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202106",
                "imodename": "广阔天地",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202106",
                "imodename": "荣耀之城",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202209",
                "imodename": "极能形态",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202212",
                "imodename": "主题群屿",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202301",
                "imodename": "主题群屿",
                "iusernum": 29,
                "iusernumall": 34
            },
            {
                "mons": "202301",
                "imodename": "其他模式",
                "iusernum": 12,
                "iusernumall": 15
            },
            {
                "mons": "202301",
                "imodename": "组竞",
                "iusernum": 6,
                "iusernumall": 7
            },
            {
                "mons": "202304",
                "imodename": "乐园",
                "iusernum": 4,
                "iusernumall": 4
            },
            {
                "mons": "202305",
                "imodename": "乐园",
                "iusernum": 5,
                "iusernumall": 5
            },
            {
                "mons": "202306",
                "imodename": "乐园",
                "iusernum": 21,
                "iusernumall": 23
            },
            {
                "mons": "202306",
                "imodename": "传统群屿",
                "iusernum": 1,
                "iusernumall": 6
            },
            {
                "mons": "202306",
                "imodename": "其他模式",
                "iusernum": 1,
                "iusernumall": 3
            },
            {
                "mons": "202307",
                "imodename": "乐园",
                "iusernum": 1,
                "iusernumall": 6
            },
            {
                "mons": "202307",
                "imodename": "假日群岛",
                "iusernum": 3,
                "iusernumall": 6
            },
            {
                "mons": "202307",
                "imodename": "其他模式",
                "iusernum": 19,
                "iusernumall": 21
            },
            {
                "mons": "202307",
                "imodename": "广阔天地",
                "iusernum": 3,
                "iusernumall": 6
            },
            {
                "mons": "202307",
                "imodename": "极能形态",
                "iusernum": 2,
                "iusernumall": 4
            },
            {
                "mons": "202307",
                "imodename": "组竞",
                "iusernum": 9,
                "iusernumall": 15
            },
            {
                "mons": "202308",
                "imodename": "主题群屿",
                "iusernum": 1,
                "iusernumall": 2
            },
            {
                "mons": "202308",
                "imodename": "乐园",
                "iusernum": 3,
                "iusernumall": 5
            },
            {
                "mons": "202308",
                "imodename": "假日群岛",
                "iusernum": 6,
                "iusernumall": 11
            },
            {
                "mons": "202308",
                "imodename": "其他模式",
                "iusernum": 12,
                "iusernumall": 19
            },
            {
                "mons": "202308",
                "imodename": "广阔天地",
                "iusernum": 2,
                "iusernumall": 7
            },
            {
                "mons": "202308",
                "imodename": "极能形态",
                "iusernum": 9,
                "iusernumall": 13
            },
            {
                "mons": "202308",
                "imodename": "组竞",
                "iusernum": 318,
                "iusernumall": 325
            },
            {
                "mons": "202401",
                "imodename": "主题群屿",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202401",
                "imodename": "其他模式",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202402",
                "imodename": "主题群屿",
                "iusernum": 25,
                "iusernumall": 27
            },
            {
                "mons": "202402",
                "imodename": "其他模式",
                "iusernum": 5,
                "iusernumall": 9
            },
            {
                "mons": "202402",
                "imodename": "组竞",
                "iusernum": 10,
                "iusernumall": 13
            },
            {
                "mons": "202403",
                "imodename": "主题群屿",
                "iusernum": 41,
                "iusernumall": 83
            },
            {
                "mons": "202403",
                "imodename": "传统群屿",
                "iusernum": 22,
                "iusernumall": 34
            },
            {
                "mons": "202403",
                "imodename": "假日群岛",
                "iusernum": 38,
                "iusernumall": 78
            },
            {
                "mons": "202403",
                "imodename": "其他模式",
                "iusernum": 14,
                "iusernumall": 38
            },
            {
                "mons": "202403",
                "imodename": "极能形态",
                "iusernum": 40,
                "iusernumall": 60
            },
            {
                "mons": "202404",
                "imodename": "主题群屿",
                "iusernum": 63,
                "iusernumall": 94
            },
            {
                "mons": "202404",
                "imodename": "乐园",
                "iusernum": 8,
                "iusernumall": 15
            },
            {
                "mons": "202404",
                "imodename": "传统群屿",
                "iusernum": 34,
                "iusernumall": 42
            },
            {
                "mons": "202404",
                "imodename": "假日群岛",
                "iusernum": 65,
                "iusernumall": 129
            },
            {
                "mons": "202404",
                "imodename": "其他模式",
                "iusernum": 38,
                "iusernumall": 85
            },
            {
                "mons": "202404",
                "imodename": "广阔天地",
                "iusernum": 3,
                "iusernumall": 5
            },
            {
                "mons": "202404",
                "imodename": "极能形态",
                "iusernum": 83,
                "iusernumall": 119
            },
            {
                "mons": "202404",
                "imodename": "组竞",
                "iusernum": 313,
                "iusernumall": 338
            },
            {
                "mons": "202404",
                "imodename": "领地",
                "iusernum": 4,
                "iusernumall": 6
            },
            {
                "mons": "202405",
                "imodename": "主题群屿",
                "iusernum": 36,
                "iusernumall": 56
            },
            {
                "mons": "202405",
                "imodename": "乐园",
                "iusernum": 3,
                "iusernumall": 6
            },
            {
                "mons": "202405",
                "imodename": "传统群屿",
                "iusernum": 16,
                "iusernumall": 22
            },
            {
                "mons": "202405",
                "imodename": "假日群岛",
                "iusernum": 32,
                "iusernumall": 62
            },
            {
                "mons": "202405",
                "imodename": "其他模式",
                "iusernum": 26,
                "iusernumall": 41
            },
            {
                "mons": "202405",
                "imodename": "极能形态",
                "iusernum": 44,
                "iusernumall": 59
            },
            {
                "mons": "202405",
                "imodename": "组竞",
                "iusernum": 252,
                "iusernumall": 265
            },
            {
                "mons": "202405",
                "imodename": "领地",
                "iusernum": 2,
                "iusernumall": 8
            },
            {
                "mons": "202406",
                "imodename": "主题群屿",
                "iusernum": 59,
                "iusernumall": 108
            },
            {
                "mons": "202406",
                "imodename": "乐园",
                "iusernum": 6,
                "iusernumall": 10
            },
            {
                "mons": "202406",
                "imodename": "传统群屿",
                "iusernum": 35,
                "iusernumall": 56
            },
            {
                "mons": "202406",
                "imodename": "假日群岛",
                "iusernum": 47,
                "iusernumall": 120
            },
            {
                "mons": "202406",
                "imodename": "其他模式",
                "iusernum": 264,
                "iusernumall": 315
            },
            {
                "mons": "202406",
                "imodename": "极能形态",
                "iusernum": 90,
                "iusernumall": 122
            },
            {
                "mons": "202406",
                "imodename": "组竞",
                "iusernum": 20,
                "iusernumall": 38
            },
            {
                "mons": "202406",
                "imodename": "隧道",
                "iusernum": 80,
                "iusernumall": 80
            },
            {
                "mons": "202407",
                "imodename": "主题群屿",
                "iusernum": 2,
                "iusernumall": 7
            },
            {
                "mons": "202407",
                "imodename": "乐园",
                "iusernum": 5,
                "iusernumall": 11
            },
            {
                "mons": "202407",
                "imodename": "传统群屿",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202407",
                "imodename": "假日群岛",
                "iusernum": 8,
                "iusernumall": 15
            },
            {
                "mons": "202407",
                "imodename": "其他模式",
                "iusernum": 34,
                "iusernumall": 49
            },
            {
                "mons": "202407",
                "imodename": "广域战场",
                "iusernum": 290,
                "iusernumall": 294
            },
            {
                "mons": "202407",
                "imodename": "极能形态",
                "iusernum": 10,
                "iusernumall": 16
            },
            {
                "mons": "202407",
                "imodename": "组竞",
                "iusernum": 24,
                "iusernumall": 36
            },
            {
                "mons": "202407",
                "imodename": "隧道",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202407",
                "imodename": "领地",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202408",
                "imodename": "主题群屿",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202408",
                "imodename": "乐园",
                "iusernum": 5,
                "iusernumall": 7
            },
            {
                "mons": "202408",
                "imodename": "假日群岛",
                "iusernum": 6,
                "iusernumall": 8
            },
            {
                "mons": "202408",
                "imodename": "其他模式",
                "iusernum": 32,
                "iusernumall": 42
            },
            {
                "mons": "202408",
                "imodename": "广域战场",
                "iusernum": 6,
                "iusernumall": 8
            },
            {
                "mons": "202408",
                "imodename": "广阔天地",
                "iusernum": 1,
                "iusernumall": 2
            },
            {
                "mons": "202408",
                "imodename": "极能形态",
                "iusernum": 7,
                "iusernumall": 12
            },
            {
                "mons": "202408",
                "imodename": "组竞",
                "iusernum": 15,
                "iusernumall": 21
            },
            {
                "mons": "202408",
                "imodename": "隧道",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202409",
                "imodename": "主题群屿",
                "iusernum": 13,
                "iusernumall": 17
            },
            {
                "mons": "202409",
                "imodename": "乐园",
                "iusernum": 5,
                "iusernumall": 7
            },
            {
                "mons": "202409",
                "imodename": "传统群屿",
                "iusernum": 1,
                "iusernumall": 2
            },
            {
                "mons": "202409",
                "imodename": "假日群岛",
                "iusernum": 12,
                "iusernumall": 14
            },
            {
                "mons": "202409",
                "imodename": "其他模式",
                "iusernum": 268,
                "iusernumall": 273
            },
            {
                "mons": "202409",
                "imodename": "广阔天地",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202409",
                "imodename": "极能形态",
                "iusernum": 3,
                "iusernumall": 6
            },
            {
                "mons": "202409",
                "imodename": "组竞",
                "iusernum": 6,
                "iusernumall": 13
            },
            {
                "mons": "202410",
                "imodename": "主题群屿",
                "iusernum": 2,
                "iusernumall": 10
            },
            {
                "mons": "202410",
                "imodename": "乐园",
                "iusernum": 5,
                "iusernumall": 20
            },
            {
                "mons": "202410",
                "imodename": "传统群屿",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202410",
                "imodename": "假日群岛",
                "iusernum": 6,
                "iusernumall": 11
            },
            {
                "mons": "202410",
                "imodename": "其他模式",
                "iusernum": 208,
                "iusernumall": 223
            },
            {
                "mons": "202410",
                "imodename": "广域战场",
                "iusernum": 1,
                "iusernumall": 4
            },
            {
                "mons": "202410",
                "imodename": "广阔天地",
                "iusernum": 1,
                "iusernumall": 3
            },
            {
                "mons": "202410",
                "imodename": "极能形态",
                "iusernum": 6,
                "iusernumall": 15
            },
            {
                "mons": "202410",
                "imodename": "组竞",
                "iusernum": 7,
                "iusernumall": 21
            },
            {
                "mons": "202410",
                "imodename": "隧道",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202410",
                "imodename": "领地",
                "iusernum": 5,
                "iusernumall": 10
            },
            {
                "mons": "202411",
                "imodename": "主题群屿",
                "iusernum": 7,
                "iusernumall": 14
            },
            {
                "mons": "202411",
                "imodename": "乐园",
                "iusernum": 9,
                "iusernumall": 16
            },
            {
                "mons": "202411",
                "imodename": "传统群屿",
                "iusernum": 1,
                "iusernumall": 2
            },
            {
                "mons": "202411",
                "imodename": "假日群岛",
                "iusernum": 8,
                "iusernumall": 19
            },
            {
                "mons": "202411",
                "imodename": "其他模式",
                "iusernum": 309,
                "iusernumall": 333
            },
            {
                "mons": "202411",
                "imodename": "广域战场",
                "iusernum": 5,
                "iusernumall": 7
            },
            {
                "mons": "202411",
                "imodename": "广阔天地",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202411",
                "imodename": "极能形态",
                "iusernum": 6,
                "iusernumall": 11
            },
            {
                "mons": "202411",
                "imodename": "组竞",
                "iusernum": 14,
                "iusernumall": 27
            },
            {
                "mons": "202411",
                "imodename": "隧道",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202411",
                "imodename": "领地",
                "iusernum": 2,
                "iusernumall": 4
            },
            {
                "mons": "202412",
                "imodename": "隧道",
                "iusernum": 4,
                "iusernumall": 4
            },
            {
                "mons": "202501",
                "imodename": "主题群屿",
                "iusernum": 19,
                "iusernumall": 24
            },
            {
                "mons": "202501",
                "imodename": "其他模式",
                "iusernum": 11,
                "iusernumall": 12
            },
            {
                "mons": "202501",
                "imodename": "组竞",
                "iusernum": 7,
                "iusernumall": 8
            },
            {
                "mons": "202501",
                "imodename": "隧道",
                "iusernum": 4,
                "iusernumall": 4
            },
            {
                "mons": "202502",
                "imodename": "主题群屿",
                "iusernum": 10,
                "iusernumall": 20
            },
            {
                "mons": "202502",
                "imodename": "乐园",
                "iusernum": 2,
                "iusernumall": 5
            },
            {
                "mons": "202502",
                "imodename": "其他模式",
                "iusernum": 13,
                "iusernumall": 22
            },
            {
                "mons": "202502",
                "imodename": "广阔天地",
                "iusernum": 4,
                "iusernumall": 8
            },
            {
                "mons": "202502",
                "imodename": "组竞",
                "iusernum": 3,
                "iusernumall": 7
            },
            {
                "mons": "202502",
                "imodename": "隧道",
                "iusernum": 4,
                "iusernumall": 4
            },
            {
                "mons": "202502",
                "imodename": "领地",
                "iusernum": 6,
                "iusernumall": 11
            },
            {
                "mons": "202503",
                "imodename": "主题群屿",
                "iusernum": 19,
                "iusernumall": 30
            },
            {
                "mons": "202503",
                "imodename": "乐园",
                "iusernum": 1,
                "iusernumall": 4
            },
            {
                "mons": "202503",
                "imodename": "传统群屿",
                "iusernum": 1,
                "iusernumall": 2
            },
            {
                "mons": "202503",
                "imodename": "其他模式",
                "iusernum": 7,
                "iusernumall": 17
            },
            {
                "mons": "202503",
                "imodename": "广阔天地",
                "iusernum": 3,
                "iusernumall": 10
            },
            {
                "mons": "202503",
                "imodename": "组竞",
                "iusernum": 1,
                "iusernumall": 4
            },
            {
                "mons": "202503",
                "imodename": "隧道",
                "iusernum": 23,
                "iusernumall": 27
            },
            {
                "mons": "202503",
                "imodename": "领地",
                "iusernum": 4,
                "iusernumall": 10
            }
        ]
    },
    {
        "sql_id": "sql_31",
        "sql": "WITH coop_platform AS (\n  SELECT DISTINCT vplayerid\n  FROM dwd_jordass_buttonpress_pre_di\n  WHERE dtstatdate BETWEEN '20250217' AND '20250318'\n    AND buttontype = 'ugcmbuttonclick'\n),\ncoop_game AS (\n  SELECT DISTINCT m.vplayerid\n  FROM dws_jordass_mode_roundrecord_di m\n  LEFT JOIN dim_jordass_submodeonlinedate_conf c\n    ON m.submode = c.matchsubmodegroup\n  WHERE m.dtstatdate BETWEEN '20250217' AND '20250318'\n    AND COALESCE(c.vtemp1, '') = '协作'\n),\ntarget_player AS (\n  SELECT vplayerid\n  FROM coop_platform\n  WHERE vplayerid NOT IN (SELECT vplayerid FROM coop_game)\n),\nmode_time AS (\n  SELECT\n    m.vplayerid,\n    CASE\n      WHEN modename = '传统模式' THEN '传统模式'\n      WHEN modename = '休闲模式' THEN '休闲模式'\n      WHEN modename = '组队竞技' THEN '组队竞技'\n      WHEN modename = '领地' THEN '领地'\n      WHEN modename = '乐园' THEN '乐园'\n      WHEN modename = '广阔天地' THEN '广阔天地'\n      WHEN modename = '生存模式' THEN '生存模式'\n      ELSE '其他'\n    END AS main_mode_group,\n    SUM(roundtime) AS total_round_time\n  FROM dws_jordass_mode_roundrecord_di m\n  JOIN target_player t ON m.vplayerid = t.vplayerid\n  WHERE m.dtstatdate BETWEEN '20250217' AND '20250318'\n  GROUP BY m.vplayerid, main_mode_group\n),\nranked_mode AS (\n  SELECT\n    vplayerid,\n    main_mode_group,\n    total_round_time,\n    ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY total_round_time DESC) AS rn\n  FROM mode_time\n)\nSELECT\n  main_mode_group AS main_mode,\n  COUNT(DISTINCT vplayerid) AS user_cnt\nFROM ranked_mode\nWHERE rn = 1\nGROUP BY main_mode_group\nORDER BY user_cnt DESC",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_32",
        "sql": "select\n  dtstatdate,\n  count(distinct vplayerid) as player_cnt,\n  round(sum(coalesce(roundtime, 0)) / 60.0, 2) as total_minutes\nfrom dws_jordass_mode_roundrecord_di\nwhere (\n        dtstatdate between '20230114' and '20230128'\n     or dtstatdate between '20240202' and '20240216'\n     or dtstatdate between '20250121' and '20250204'\n)\ngroup by dtstatdate\norder by dtstatdate",
        "status": "success",
        "result": [
            {
                "dtstatdate": "20230114",
                "player_cnt": 4,
                "total_minutes": 150
            },
            {
                "dtstatdate": "20230116",
                "player_cnt": 5,
                "total_minutes": 210
            },
            {
                "dtstatdate": "20230117",
                "player_cnt": 5,
                "total_minutes": 203.33
            },
            {
                "dtstatdate": "20230118",
                "player_cnt": 4,
                "total_minutes": 160
            },
            {
                "dtstatdate": "20230119",
                "player_cnt": 1,
                "total_minutes": 25
            },
            {
                "dtstatdate": "20230120",
                "player_cnt": 5,
                "total_minutes": 195
            },
            {
                "dtstatdate": "20230122",
                "player_cnt": 4,
                "total_minutes": 160
            },
            {
                "dtstatdate": "20230124",
                "player_cnt": 5,
                "total_minutes": 205
            },
            {
                "dtstatdate": "20230125",
                "player_cnt": 5,
                "total_minutes": 190
            },
            {
                "dtstatdate": "20230126",
                "player_cnt": 1,
                "total_minutes": 30
            },
            {
                "dtstatdate": "20230128",
                "player_cnt": 5,
                "total_minutes": 205
            },
            {
                "dtstatdate": "20240202",
                "player_cnt": 4,
                "total_minutes": 150
            },
            {
                "dtstatdate": "20240204",
                "player_cnt": 4,
                "total_minutes": 250
            },
            {
                "dtstatdate": "20240205",
                "player_cnt": 4,
                "total_minutes": 170
            },
            {
                "dtstatdate": "20240206",
                "player_cnt": 1,
                "total_minutes": 50
            },
            {
                "dtstatdate": "20240208",
                "player_cnt": 5,
                "total_minutes": 255
            },
            {
                "dtstatdate": "20240209",
                "player_cnt": 5,
                "total_minutes": 220
            },
            {
                "dtstatdate": "20240210",
                "player_cnt": 5,
                "total_minutes": 175
            },
            {
                "dtstatdate": "20240211",
                "player_cnt": 5,
                "total_minutes": 205
            },
            {
                "dtstatdate": "20240212",
                "player_cnt": 1,
                "total_minutes": 30
            },
            {
                "dtstatdate": "20240213",
                "player_cnt": 1,
                "total_minutes": 40
            },
            {
                "dtstatdate": "20240214",
                "player_cnt": 4,
                "total_minutes": 180
            },
            {
                "dtstatdate": "20250121",
                "player_cnt": 4,
                "total_minutes": 150
            },
            {
                "dtstatdate": "20250122",
                "player_cnt": 5,
                "total_minutes": 170
            },
            {
                "dtstatdate": "20250124",
                "player_cnt": 1,
                "total_minutes": 30
            },
            {
                "dtstatdate": "20250126",
                "player_cnt": 4,
                "total_minutes": 150
            },
            {
                "dtstatdate": "20250127",
                "player_cnt": 7,
                "total_minutes": 257.5
            },
            {
                "dtstatdate": "20250128",
                "player_cnt": 5,
                "total_minutes": 260
            },
            {
                "dtstatdate": "20250129",
                "player_cnt": 4,
                "total_minutes": 160
            },
            {
                "dtstatdate": "20250131",
                "player_cnt": 1,
                "total_minutes": 30
            },
            {
                "dtstatdate": "20250201",
                "player_cnt": 5,
                "total_minutes": 240
            },
            {
                "dtstatdate": "20250204",
                "player_cnt": 1,
                "total_minutes": 45
            }
        ]
    },
    {
        "sql_id": "sql_33",
        "sql": "select\n    count(distinct a.vplayerid) as total_players,\n    count(distinct case when b.vplayerid is not null then a.vplayerid end) as existing_players,\n    count(distinct case when b.vplayerid is null then a.vplayerid end) as new_players\nfrom (\n    select vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20241214' and '20241220'\n    and imode = 1344338933661592832\n    and platid = 255\n    group by vplayerid\n) a\nleft join (\n    select vplayerid\n    from dws_jordass_playermatchrecord_stat_df\n    where dtstatdate = '20241213'\n    and imode = 1344338933661592832\n    and platid = 255\n    group by vplayerid\n) b\non a.vplayerid = b.vplayerid\n;",
        "status": "success",
        "result": [
            {
                "total_players": 11,
                "existing_players": 4,
                "new_players": 7
            }
        ]
    },
    {
        "sql_id": "sql_34",
        "sql": "select\n    ds,\n    count(distinct vplayerid) as user_cnt,\n    count(distinct vplayerid, irank) as user_times\nfrom (\n    select\n        s2.ds,\n        s2.vplayerid,\n        s2.irank\n    from (\n        -- 获取411111事件（点击按钮）\n        select\n            dtstatdate as ds,\n            vplayerid,\n            dteventtime\n        from dws_jordass_buttonpress_pre_di\n        where buttontype = 411111\n        and  ((dtstatdate between '20240917' and '20240923') or (dtstatdate between '20241008' and '20241014'))\n    ) s1\n    join (\n        -- 获取411120事件（加入玩法）并编号\n        select\n            dtstatdate as ds,\n            vplayerid,\n            dteventtime,\n            row_number() over (partition by vplayerid order by dteventtime) as irank\n        from dws_jordass_buttonpress_pre_di\n        where buttontype = 411120\n        and ((dtstatdate between '20240917' and '20240923') or (dtstatdate between '20241008' and '20241014'))\n    ) s2 on s1.vplayerid = s2.vplayerid and s1.ds = s2.ds and s2.dteventtime > s1.dteventtime\n    join (\n        -- 获取411123事件（确认动作）\n        select\n            dtstatdate as ds,\n            vplayerid,\n            dteventtime\n        from dws_jordass_buttonpress_pre_di\n        where buttontype = 411123\n        and ((dtstatdate between '20240917' and '20240923') or (dtstatdate between '20241008' and '20241014'))\n    ) s3 on s2.vplayerid = s3.vplayerid and s2.ds = s3.ds and s3.dteventtime > s2.dteventtime\n)f \ngroup by ds\n;",
        "status": "success",
        "result": [
            {
                "ds": "20241014",
                "user_cnt": 1,
                "user_times": 1
            },
            {
                "ds": "20240920",
                "user_cnt": 3,
                "user_times": 3
            },
            {
                "ds": "20241009",
                "user_cnt": 6,
                "user_times": 11
            },
            {
                "ds": "20240919",
                "user_cnt": 5,
                "user_times": 7
            },
            {
                "ds": "20240917",
                "user_cnt": 1,
                "user_times": 1
            },
            {
                "ds": "20240923",
                "user_cnt": 1,
                "user_times": 1
            },
            {
                "ds": "20240922",
                "user_cnt": 1,
                "user_times": 1
            },
            {
                "ds": "20240918",
                "user_cnt": 5,
                "user_times": 7
            },
            {
                "ds": "20241008",
                "user_cnt": 1,
                "user_times": 1
            },
            {
                "ds": "20240921",
                "user_cnt": 1,
                "user_times": 1
            },
            {
                "ds": "20241010",
                "user_cnt": 6,
                "user_times": 6
            }
        ]
    },
    {
        "sql_id": "sql_35",
        "sql": "with round_user as (\n    select dtstatdate,\n        case \n            when mode in (401,402,403) then '第一人称'\n            when mode =101 then '单排'\n            when mode =102 then '双排'\n            when mode in (103,603) then '四排'\n        end modename,\n        vplayerid,\n        sum(roundcnt) roundcnt,\n        sum(roundtime) roundtime\n    from dws_jordass_mode_roundrecord_di\n    where ((dtstatdate between '20240326' and '20240409')\n    or (dtstatdate between '20240528' and '20240611'))\n    and mode in (401,402,403,101,102,103,603)\n    group by dtstatdate,\n    case when mode in (401,402,403) then '第一人称'\n        when mode =101 then '单排'\n        when mode =102 then '双排'\n        when mode in (103,603) then '四排'\n    end,\n    vplayerid\n)\n\nselect \n    a.dtstatdate,\n    a.modename,\n    count(distinct a.vplayerid) iusernum,\n    sum(a.roundcnt) roundcnt,\n    sum(a.roundtime) roundtime,\n    count(distinct b1.vplayerid) stay2,\n    count(distinct b2.vplayerid) stay7,\n    count(distinct c1.vplayerid) playstay2,\n    count(distinct c2.vplayerid) playstay7\nfrom (\n    select * from round_user \n    where((dtstatdate between '20240326' and '20240403') or (dtstatdate between '20240528' and '20240605'))\n) a\nleft join (\n    select dtstatdate,vplayerid \n    from dws_jordass_login_di\n    where ((dtstatdate between '20240326' and '20240404') or (dtstatdate between '20240528' and '20240606')) \n    and platid =255\n    group by dtstatdate,vplayerid\n) b1 \non a.vplayerid = b1.vplayerid and date_add(a.dtstatdate,1) = b1.dtstatdate\nleft join (\n    select dtstatdate,vplayerid \n    from dws_jordass_login_di\n    where ((dtstatdate between '20240326' and '20240409') or (dtstatdate between '20240528' and '20240611')) and platid =255\n    group by dtstatdate,vplayerid\n) b2 \non a.vplayerid = b2.vplayerid and date_add(a.dtstatdate,6) = b2.dtstatdate\nleft join round_user c1 \non a.vplayerid = c1.vplayerid and date_add(a.dtstatdate,1) = c1.dtstatdate and a.modename= c1.modename\nleft join round_user c2 \non a.vplayerid = c2.vplayerid and date_add(a.dtstatdate,6) = c2.dtstatdate and a.modename= c2.modename\ngroup by a.dtstatdate,a.modename\n;",
        "status": "success",
        "result": [
            {
                "dtstatdate": "20240328",
                "modename": "四排",
                "iusernum": 43,
                "roundcnt": 352,
                "roundtime": 385959,
                "stay2": 8,
                "stay7": 7,
                "playstay2": 36,
                "playstay7": 4
            },
            {
                "dtstatdate": "20240601",
                "modename": "四排",
                "iusernum": 47,
                "roundcnt": 314,
                "roundtime": 413761,
                "stay2": 5,
                "stay7": 0,
                "playstay2": 1,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240602",
                "modename": "四排",
                "iusernum": 46,
                "roundcnt": 267,
                "roundtime": 327552,
                "stay2": 9,
                "stay7": 0,
                "playstay2": 35,
                "playstay7": 2
            },
            {
                "dtstatdate": "20240329",
                "modename": "双排",
                "iusernum": 2,
                "roundcnt": 12,
                "roundtime": 6366,
                "stay2": 0,
                "stay7": 1,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240327",
                "modename": "双排",
                "iusernum": 5,
                "roundcnt": 26,
                "roundtime": 10401,
                "stay2": 2,
                "stay7": 1,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240401",
                "modename": "双排",
                "iusernum": 2,
                "roundcnt": 9,
                "roundtime": 11860,
                "stay2": 1,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240529",
                "modename": "单排",
                "iusernum": 2,
                "roundcnt": 6,
                "roundtime": 4668,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240403",
                "modename": "第一人称",
                "iusernum": 1,
                "roundcnt": 2,
                "roundtime": 1053,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240326",
                "modename": "第一人称",
                "iusernum": 1,
                "roundcnt": 17,
                "roundtime": 8087,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240327",
                "modename": "四排",
                "iusernum": 37,
                "roundcnt": 262,
                "roundtime": 270292,
                "stay2": 5,
                "stay7": 3,
                "playstay2": 1,
                "playstay7": 2
            },
            {
                "dtstatdate": "20240402",
                "modename": "四排",
                "iusernum": 42,
                "roundcnt": 260,
                "roundtime": 322039,
                "stay2": 8,
                "stay7": 0,
                "playstay2": 25,
                "playstay7": 4
            },
            {
                "dtstatdate": "20240528",
                "modename": "双排",
                "iusernum": 4,
                "roundcnt": 7,
                "roundtime": 8759,
                "stay2": 0,
                "stay7": 1,
                "playstay2": 3,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240327",
                "modename": "单排",
                "iusernum": 3,
                "roundcnt": 59,
                "roundtime": 37746,
                "stay2": 3,
                "stay7": 2,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240531",
                "modename": "单排",
                "iusernum": 2,
                "roundcnt": 6,
                "roundtime": 3002,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240327",
                "modename": "第一人称",
                "iusernum": 1,
                "roundcnt": 7,
                "roundtime": 8737,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240330",
                "modename": "四排",
                "iusernum": 43,
                "roundcnt": 383,
                "roundtime": 406666,
                "stay2": 5,
                "stay7": 0,
                "playstay2": 8,
                "playstay7": 6
            },
            {
                "dtstatdate": "20240326",
                "modename": "单排",
                "iusernum": 1,
                "roundcnt": 2,
                "roundtime": 997,
                "stay2": 0,
                "stay7": 1,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240326",
                "modename": "双排",
                "iusernum": 5,
                "roundcnt": 19,
                "roundtime": 8711,
                "stay2": 1,
                "stay7": 2,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240602",
                "modename": "双排",
                "iusernum": 2,
                "roundcnt": 2,
                "roundtime": 439,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240530",
                "modename": "四排",
                "iusernum": 38,
                "roundcnt": 242,
                "roundtime": 289732,
                "stay2": 5,
                "stay7": 6,
                "playstay2": 35,
                "playstay7": 2
            },
            {
                "dtstatdate": "20240603",
                "modename": "四排",
                "iusernum": 43,
                "roundcnt": 183,
                "roundtime": 220353,
                "stay2": 9,
                "stay7": 0,
                "playstay2": 2,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240328",
                "modename": "双排",
                "iusernum": 2,
                "roundcnt": 2,
                "roundtime": 2427,
                "stay2": 2,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240604",
                "modename": "单排",
                "iusernum": 1,
                "roundcnt": 1,
                "roundtime": 562,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240603",
                "modename": "单排",
                "iusernum": 4,
                "roundcnt": 6,
                "roundtime": 2745,
                "stay2": 1,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240330",
                "modename": "第一人称",
                "iusernum": 1,
                "roundcnt": 1,
                "roundtime": 301,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240603",
                "modename": "双排",
                "iusernum": 1,
                "roundcnt": 3,
                "roundtime": 2680,
                "stay2": 1,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240329",
                "modename": "四排",
                "iusernum": 43,
                "roundcnt": 327,
                "roundtime": 404190,
                "stay2": 2,
                "stay7": 9,
                "playstay2": 0,
                "playstay7": 11
            },
            {
                "dtstatdate": "20240402",
                "modename": "单排",
                "iusernum": 1,
                "roundcnt": 1,
                "roundtime": 1288,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240401",
                "modename": "四排",
                "iusernum": 44,
                "roundcnt": 261,
                "roundtime": 272629,
                "stay2": 5,
                "stay7": 0,
                "playstay2": 5,
                "playstay7": 6
            },
            {
                "dtstatdate": "20240602",
                "modename": "单排",
                "iusernum": 3,
                "roundcnt": 4,
                "roundtime": 2765,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 2,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240529",
                "modename": "双排",
                "iusernum": 5,
                "roundcnt": 23,
                "roundtime": 22254,
                "stay2": 2,
                "stay7": 2,
                "playstay2": 2,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240403",
                "modename": "四排",
                "iusernum": 35,
                "roundcnt": 170,
                "roundtime": 205470,
                "stay2": 6,
                "stay7": 0,
                "playstay2": 29,
                "playstay7": 1
            },
            {
                "dtstatdate": "20240605",
                "modename": "双排",
                "iusernum": 2,
                "roundcnt": 13,
                "roundtime": 7579,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240531",
                "modename": "双排",
                "iusernum": 5,
                "roundcnt": 33,
                "roundtime": 22420,
                "stay2": 1,
                "stay7": 1,
                "playstay2": 1,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240329",
                "modename": "第一人称",
                "iusernum": 1,
                "roundcnt": 6,
                "roundtime": 2140,
                "stay2": 0,
                "stay7": 1,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240530",
                "modename": "双排",
                "iusernum": 5,
                "roundcnt": 37,
                "roundtime": 22921,
                "stay2": 1,
                "stay7": 1,
                "playstay2": 2,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240601",
                "modename": "双排",
                "iusernum": 8,
                "roundcnt": 19,
                "roundtime": 11623,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240401",
                "modename": "单排",
                "iusernum": 1,
                "roundcnt": 1,
                "roundtime": 730,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240604",
                "modename": "四排",
                "iusernum": 37,
                "roundcnt": 293,
                "roundtime": 335822,
                "stay2": 3,
                "stay7": 0,
                "playstay2": 7,
                "playstay7": 7
            },
            {
                "dtstatdate": "20240331",
                "modename": "四排",
                "iusernum": 38,
                "roundcnt": 296,
                "roundtime": 376187,
                "stay2": 5,
                "stay7": 0,
                "playstay2": 5,
                "playstay7": 5
            },
            {
                "dtstatdate": "20240605",
                "modename": "四排",
                "iusernum": 42,
                "roundcnt": 247,
                "roundtime": 331124,
                "stay2": 6,
                "stay7": 0,
                "playstay2": 6,
                "playstay7": 35
            },
            {
                "dtstatdate": "20240326",
                "modename": "四排",
                "iusernum": 38,
                "roundcnt": 285,
                "roundtime": 336281,
                "stay2": 3,
                "stay7": 7,
                "playstay2": 1,
                "playstay7": 5
            },
            {
                "dtstatdate": "20240528",
                "modename": "四排",
                "iusernum": 42,
                "roundcnt": 284,
                "roundtime": 351792,
                "stay2": 9,
                "stay7": 7,
                "playstay2": 35,
                "playstay7": 6
            },
            {
                "dtstatdate": "20240604",
                "modename": "双排",
                "iusernum": 2,
                "roundcnt": 7,
                "roundtime": 3783,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240330",
                "modename": "双排",
                "iusernum": 4,
                "roundcnt": 13,
                "roundtime": 7994,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240403",
                "modename": "双排",
                "iusernum": 1,
                "roundcnt": 2,
                "roundtime": 765,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 1,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240331",
                "modename": "双排",
                "iusernum": 6,
                "roundcnt": 34,
                "roundtime": 30560,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 1,
                "playstay7": 1
            },
            {
                "dtstatdate": "20240528",
                "modename": "单排",
                "iusernum": 1,
                "roundcnt": 1,
                "roundtime": 1883,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 1,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240402",
                "modename": "双排",
                "iusernum": 7,
                "roundcnt": 16,
                "roundtime": 12280,
                "stay2": 2,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 1
            },
            {
                "dtstatdate": "20240530",
                "modename": "单排",
                "iusernum": 2,
                "roundcnt": 3,
                "roundtime": 1515,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 1,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240403",
                "modename": "单排",
                "iusernum": 2,
                "roundcnt": 3,
                "roundtime": 1517,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240531",
                "modename": "四排",
                "iusernum": 44,
                "roundcnt": 328,
                "roundtime": 366291,
                "stay2": 3,
                "stay7": 8,
                "playstay2": 11,
                "playstay7": 1
            },
            {
                "dtstatdate": "20240529",
                "modename": "四排",
                "iusernum": 40,
                "roundcnt": 339,
                "roundtime": 342914,
                "stay2": 10,
                "stay7": 10,
                "playstay2": 4,
                "playstay7": 5
            },
            {
                "dtstatdate": "20240331",
                "modename": "第一人称",
                "iusernum": 3,
                "roundcnt": 15,
                "roundtime": 9441,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            },
            {
                "dtstatdate": "20240330",
                "modename": "单排",
                "iusernum": 2,
                "roundcnt": 8,
                "roundtime": 4421,
                "stay2": 0,
                "stay7": 0,
                "playstay2": 0,
                "playstay7": 0
            }
        ]
    },
    {
        "sql_id": "sql_37",
        "sql": "select \n    s1.ds as `ds`, -- 日期\n    count(distinct s1.vplayerid) as `user_cnt`, -- 人数\n    coalesce(user_type, '未知') as `user_type`, -- 用户类型\n    count(distinct case when s2.ds = date_add(s1.ds, 1) then s1.vplayerid else null end) as `next_day_retention`, -- 次留人数\n    count(distinct case when s2.ds = date_add(s1.ds, 2) then s1.vplayerid else null end) as `three_day_retention`, -- 三留人数\n    count(distinct case when s2.ds = date_add(s1.ds, 6) then s1.vplayerid else null end) as `seven_day_retention`, -- 七留人数\n    count(distinct case when s2.ds = date_add(s1.ds, 13) then s1.vplayerid else null end) as `fourteen_day_retention`, -- 14留人数\n    count(distinct case when s2.ds = date_add(s1.ds, 29) then s1.vplayerid else null end) as `thirty_day_retention` -- 30留人数\nfrom (\n    select \n        f1.dregdate as ds,  -- 日期\n        f1.vplayerid as vplayerid  -- 用户id\n    from  dws_jordass_emulator_df f1\n    where   f1.dtstatdate = '20251001'  \n        and f1.dregdate >= '20250401'  \n        and f1.dregdate <= '20250530'  \n        and f1.platid = 255  \n) s1\nleft join (\n    select \n        f1.dtstatdate as ds, -- 统计日期\n        f1.vplayerid as vplayerid, -- 手机端登录用户id\n        '手机端' as user_type\n    from  dws_jordass_device_login_di f1\n    where  f1.device_type=0 -- 手机端\n    and f1.dtstatdate >= '20250401' and f1.dtstatdate <= date_add('20250530', 29)\n\n    union all\n\n    select \n        f1.dtstatdate as ds, -- 统计日期\n        f1.vplayerid as vplayerid, -- 手机端登录用户id\n        '模拟器' as user_type\n    from  dws_jordass_device_login_di f1\n    where  f1.device_type in (1,5) -- 模拟器\n    and f1.dtstatdate >= '20250401' and f1.dtstatdate <= date_add('20250530', 29)\n\n    union all\n\n    select \n        f1.dtstatdate as ds,  -- 日期\n        f1.vplayerid as vplayerid,  -- 整体游戏内登录用户id\n        '游戏内' as user_type\n    from   dws_jordass_login_di f1  \n    where  f1.dtstatdate >= '20250401' and f1.dtstatdate <= date_add('20250530', 29)\n    and f1.platid = 255  -- 不区分系统平台\n) s2 \n    on   s1.vplayerid = s2.vplayerid\n    group by   s1.ds, user_type\n;",
        "status": "success",
        "result": [
            {
                "ds": "20250414",
                "user_cnt": 2,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250429",
                "user_cnt": 3,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250529",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250529",
                "user_cnt": 2,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250501",
                "user_cnt": 4,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250519",
                "user_cnt": 3,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250408",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250402",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250423",
                "user_cnt": 2,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250425",
                "user_cnt": 2,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250516",
                "user_cnt": 4,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250415",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250424",
                "user_cnt": 1,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250408",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250512",
                "user_cnt": 1,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250528",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 1,
                "three_day_retention": 1,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250403",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250429",
                "user_cnt": 4,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250514",
                "user_cnt": 4,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250530",
                "user_cnt": 3,
                "user_type": "模拟器",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250523",
                "user_cnt": 4,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250510",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250427",
                "user_cnt": 3,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250530",
                "user_cnt": 2,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250501",
                "user_cnt": 1,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250515",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250407",
                "user_cnt": 2,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250402",
                "user_cnt": 2,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250415",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250515",
                "user_cnt": 1,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250424",
                "user_cnt": 1,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250414",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250501",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250521",
                "user_cnt": 5,
                "user_type": "游戏内",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250417",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 2,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 2
            },
            {
                "ds": "20250403",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250507",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 1,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250524",
                "user_cnt": 1,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250424",
                "user_cnt": 3,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250515",
                "user_cnt": 3,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250415",
                "user_cnt": 2,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250523",
                "user_cnt": 1,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250405",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250410",
                "user_cnt": 3,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250413",
                "user_cnt": 3,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250526",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250511",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250520",
                "user_cnt": 1,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250404",
                "user_cnt": 1,
                "user_type": "游戏内",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250401",
                "user_cnt": 4,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 2,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250512",
                "user_cnt": 2,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250529",
                "user_cnt": 2,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250404",
                "user_cnt": 2,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250508",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250513",
                "user_cnt": 4,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250508",
                "user_cnt": 2,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 2,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250526",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250526",
                "user_cnt": 2,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250412",
                "user_cnt": 4,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250421",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250425",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250507",
                "user_cnt": 5,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250405",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250530",
                "user_cnt": 3,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250505",
                "user_cnt": 4,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250509",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250517",
                "user_cnt": 3,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250430",
                "user_cnt": 2,
                "user_type": "模拟器",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250502",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250520",
                "user_cnt": 2,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250423",
                "user_cnt": 1,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250411",
                "user_cnt": 4,
                "user_type": "游戏内",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250424",
                "user_cnt": 2,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250506",
                "user_cnt": 1,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250403",
                "user_cnt": 4,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250502",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250418",
                "user_cnt": 2,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250402",
                "user_cnt": 1,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250410",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250426",
                "user_cnt": 4,
                "user_type": "游戏内",
                "next_day_retention": 1,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 2,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250415",
                "user_cnt": 4,
                "user_type": "模拟器",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250406",
                "user_cnt": 3,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250416",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250416",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 2,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250517",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250518",
                "user_cnt": 4,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250520",
                "user_cnt": 3,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 2,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250513",
                "user_cnt": 2,
                "user_type": "手机端",
                "next_day_retention": 2,
                "three_day_retention": 1,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250525",
                "user_cnt": 3,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250407",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250527",
                "user_cnt": 2,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250520",
                "user_cnt": 2,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250503",
                "user_cnt": 2,
                "user_type": "游戏内",
                "next_day_retention": 1,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250420",
                "user_cnt": 2,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250403",
                "user_cnt": 2,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250410",
                "user_cnt": 1,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250411",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250401",
                "user_cnt": 3,
                "user_type": "模拟器",
                "next_day_retention": 1,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250507",
                "user_cnt": 2,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250527",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250430",
                "user_cnt": 2,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250423",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250519",
                "user_cnt": 2,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250525",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250523",
                "user_cnt": 1,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250518",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250510",
                "user_cnt": 3,
                "user_type": "模拟器",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250506",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250506",
                "user_cnt": 2,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250527",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250417",
                "user_cnt": 2,
                "user_type": "模拟器",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250409",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 1,
                "three_day_retention": 1,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250406",
                "user_cnt": 5,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250428",
                "user_cnt": 2,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250428",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250510",
                "user_cnt": 6,
                "user_type": "手机端",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250430",
                "user_cnt": 3,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250413",
                "user_cnt": 2,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250519",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250428",
                "user_cnt": 3,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250516",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250509",
                "user_cnt": 1,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250518",
                "user_cnt": 2,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250406",
                "user_cnt": 1,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250501",
                "user_cnt": 2,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250416",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250517",
                "user_cnt": 1,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250521",
                "user_cnt": 5,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250420",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250418",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250506",
                "user_cnt": 1,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250408",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250504",
                "user_cnt": 6,
                "user_type": "手机端",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250422",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250522",
                "user_cnt": 3,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250502",
                "user_cnt": 1,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250425",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250521",
                "user_cnt": 1,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250413",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250511",
                "user_cnt": 4,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250413",
                "user_cnt": 1,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250411",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250414",
                "user_cnt": 4,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250502",
                "user_cnt": 4,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250419",
                "user_cnt": 6,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250508",
                "user_cnt": 2,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250525",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250505",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250425",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250416",
                "user_cnt": 4,
                "user_type": "模拟器",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250421",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250530",
                "user_cnt": 2,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250524",
                "user_cnt": 5,
                "user_type": "游戏内",
                "next_day_retention": 1,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250512",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250529",
                "user_cnt": 3,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250430",
                "user_cnt": 2,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250522",
                "user_cnt": 2,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250427",
                "user_cnt": 1,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250519",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 2,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250429",
                "user_cnt": 3,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250517",
                "user_cnt": 1,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250522",
                "user_cnt": 1,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250422",
                "user_cnt": 1,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250507",
                "user_cnt": 1,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250514",
                "user_cnt": 1,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250522",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250407",
                "user_cnt": 2,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250429",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250409",
                "user_cnt": 3,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250426",
                "user_cnt": 7,
                "user_type": "手机端",
                "next_day_retention": 2,
                "three_day_retention": 1,
                "seven_day_retention": 2,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250420",
                "user_cnt": 3,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250412",
                "user_cnt": 1,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250417",
                "user_cnt": 3,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250516",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250405",
                "user_cnt": 2,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250503",
                "user_cnt": 3,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250509",
                "user_cnt": 5,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250418",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250523",
                "user_cnt": 2,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250421",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250511",
                "user_cnt": 4,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250402",
                "user_cnt": 2,
                "user_type": "游戏内",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250427",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250426",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250508",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250528",
                "user_cnt": 4,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250514",
                "user_cnt": 2,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250407",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250419",
                "user_cnt": 4,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250404",
                "user_cnt": 4,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250421",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250417",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 2,
                "three_day_retention": 2,
                "seven_day_retention": 1,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250504",
                "user_cnt": 5,
                "user_type": "游戏内",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250422",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250512",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250505",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250412",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250409",
                "user_cnt": 1,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250423",
                "user_cnt": 2,
                "user_type": "手机端",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250503",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250516",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250406",
                "user_cnt": 2,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 1,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250411",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250511",
                "user_cnt": 2,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250503",
                "user_cnt": 1,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250528",
                "user_cnt": 1,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250401",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250527",
                "user_cnt": 3,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250409",
                "user_cnt": 2,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250504",
                "user_cnt": 3,
                "user_type": "模拟器",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250526",
                "user_cnt": 2,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250525",
                "user_cnt": 3,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250505",
                "user_cnt": 5,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250412",
                "user_cnt": 1,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250422",
                "user_cnt": 4,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250414",
                "user_cnt": 1,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250524",
                "user_cnt": 3,
                "user_type": "手机端",
                "next_day_retention": 1,
                "three_day_retention": 0,
                "seven_day_retention": 1,
                "fourteen_day_retention": 1,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250521",
                "user_cnt": 3,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 1,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250427",
                "user_cnt": 2,
                "user_type": "手机端",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 1
            },
            {
                "ds": "20250420",
                "user_cnt": 2,
                "user_type": "未知",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250524",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250408",
                "user_cnt": 3,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250418",
                "user_cnt": 1,
                "user_type": "游戏内",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            },
            {
                "ds": "20250528",
                "user_cnt": 1,
                "user_type": "模拟器",
                "next_day_retention": 0,
                "three_day_retention": 0,
                "seven_day_retention": 0,
                "fourteen_day_retention": 0,
                "thirty_day_retention": 0
            }
        ]
    },
    {
        "sql_id": "sql_38",
        "sql": "with usertype as (\n    select '广域战场' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240723',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '消灭战' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20230804',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '幻想混战' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20241115',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '荒野传说' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240903',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '策略载具' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20241010',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '炎夏混战' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240625',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '单人装备' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240517',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '交叉堡垒' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240412',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n),\ndapan as (\n    select '广域战场' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate >= cast(date_format(date_sub('20240723',7), '%Y%m%d') as bigint) and dtstatdate <= cast(date_format(date_sub('20240723',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '消灭战' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate >= cast(date_format(date_sub('20230804',7), '%Y%m%d') as bigint) and dtstatdate <= cast(date_format(date_sub('20230804',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '幻想混战' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20241115',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20241115',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '荒野传说' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20240903',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20240903',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '策略载具' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20241010',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20241010',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '炎夏混战' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20240625',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20240625',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '单人装备' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20240517',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20240517',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '交叉堡垒' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20240412',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20240412',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n),\ndapan2jordass as (\n    select distinct itype, b.vplayerid, flag1\n    from dapan a\n    join (\n        select vplayerid,suserid from dim_jordass_playerid2suserid_nf\n    ) b on a.suserid = b.suserid\n),\nplayuser as (\n    select '广域战场' itype, min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240723' and dtstatdate <= date_add('20240723',2) and submodename= '广域战场模式'\n    group by vplayerid\n    union all\n    select '消灭战' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20230804' and dtstatdate <= date_add('20230804',2) and modename='组队竞技' and submodename like '%消灭战模式%'\n    group by vplayerid\n    union all\n    select '幻想混战' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20241115' and dtstatdate <= date_add('20241115',2) and modename='创意创作间' and submodename='幻想混战'\n    group by vplayerid\n    union all\n    select '荒野传说' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240903' and dtstatdate <= date_add('20240903',2) and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n    group by vplayerid\n    union all\n    select '策略载具' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20241010' and dtstatdate <= date_add('20241010',2) and modename='休闲模式' and submodename like '%策略载具%'\n    group by vplayerid\n    union all\n    select '炎夏混战' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240625' and dtstatdate <= date_add('20240625',2) and modename='创意创作间' and submodename like '%炎夏混战%'\n    group by vplayerid\n    union all\n    select '单人装备' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240517' and dtstatdate <= date_add('20240517',2) and modename='组队竞技' and submodename like '%单人装备%'\n    group by vplayerid\n    union all\n    select '交叉堡垒' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240412' and dtstatdate <= date_add('20240412',2) and modename='组队竞技' and submodename like '%交叉堡垒%'\n    group by vplayerid\n)\n\nselect \n    t.itype,\n    t.user_type,\n    t.iusernum1,\n    p.iusernum2\nfrom (\n    select \n        a.itype,\n        b.user_type,\n        count(distinct a.vplayerid) iusernum1\n    from playuser a\n    join (\n        select \n            itype, vplayerid,\n            case \n                when datediff(dtstatdate,dregdate)<=2 then '砺刃新增'\n                when instr(substr(cbitmap,4),'1')=0 or instr(substr(cbitmap,4),'1')>=60 then '砺刃回流（流失60天以上）'\n                when instr(substr(cbitmap,4),'1')>=21 then '砺刃回流（流失21-59天）'\n                when instr(substr(cbitmap,4),'1')>=14 then '砺刃回流（流失14-20天）'\n                when instr(substr(cbitmap,4),'1')>7 then '砺刃回流（流失7-13天）'\n                when instr(substr(cbitmap,4),'1')<=7 then '砺刃留存' \n            end user_type\n        from usertype\n    ) b on a.itype = b.itype and a.vplayerid = b.vplayerid\n    group by a.itype,b.user_type\n\n    union all\n    \n    select \n        a.itype, \n        case \n            when flag1=0 then '平台盘内' \n            when b.vplayerid is null then '平台盘外' \n        end user_type, \n    count(distinct a.vplayerid) iusernum1\n    from playuser a\n    left join dapan2jordass b \n    on a.itype = b.itype and a.vplayerid = b.vplayerid\n    where flag1=0 or b.vplayerid is null\n    group by a.itype, case when flag1=0 then '平台盘内' when b.vplayerid is null then '平台盘外' end\n) t\nleft join (\n    select itype,\n        case \n            when datediff(dtstatdate,dregdate)<=2 then '砺刃新增'\n            when instr(substr(cbitmap,4),'1')=0 or instr(substr(cbitmap,4),'1')>=60 then '砺刃回流（流失60天以上）'\n            when instr(substr(cbitmap,4),'1')>=21 then '砺刃回流（流失21-59天）'\n            when instr(substr(cbitmap,4),'1')>=14 then '砺刃回流（流失14-20天）'\n            when instr(substr(cbitmap,4),'1')>7 then '砺刃回流（流失7-13天）'\n            when instr(substr(cbitmap,4),'1')<=7 then '砺刃留存' \n        end user_type,\n        count(distinct vplayerid) iusernum2\n    from usertype\n    group by itype,\n        case \n            when datediff(dtstatdate,dregdate)<=2 then '砺刃新增'\n            when instr(substr(cbitmap,4),'1')=0 or instr(substr(cbitmap,4),'1')>=60 then '砺刃回流（流失60天以上）'\n            when instr(substr(cbitmap,4),'1')>=21 then '砺刃回流（流失21-59天）'\n            when instr(substr(cbitmap,4),'1')>=14 then '砺刃回流（流失14-20天）'\n            when instr(substr(cbitmap,4),'1')>7 then '砺刃回流（流失7-13天）'\n            when instr(substr(cbitmap,4),'1')<=7 then '砺刃留存' \n        end\n\n    union all\n\n    select itype,'平台盘内',count(distinct vplayerid) \n    from dapan2jordass \n    group by itype\n) p on t.itype=p.itype and t.user_type=p.user_type\n;",
        "status": "success",
        "result": [
            {
                "itype": "交叉堡垒",
                "user_type": "平台盘外",
                "iusernum1": 202,
                "iusernum2": null
            },
            {
                "itype": "消灭战",
                "user_type": "砺刃回流（流失7-13天）",
                "iusernum1": 4,
                "iusernum2": 5
            },
            {
                "itype": "荒野传说",
                "user_type": "平台盘内",
                "iusernum1": 8,
                "iusernum2": 191
            },
            {
                "itype": "交叉堡垒",
                "user_type": "平台盘内",
                "iusernum1": 9,
                "iusernum2": 181
            },
            {
                "itype": "消灭战",
                "user_type": "平台盘内",
                "iusernum1": 7,
                "iusernum2": 180
            },
            {
                "itype": "炎夏混战",
                "user_type": "平台盘外",
                "iusernum1": 164,
                "iusernum2": null
            },
            {
                "itype": "幻想混战",
                "user_type": "平台盘外",
                "iusernum1": 208,
                "iusernum2": null
            },
            {
                "itype": "广域战场",
                "user_type": "平台盘外",
                "iusernum1": 227,
                "iusernum2": null
            },
            {
                "itype": "单人装备",
                "user_type": "平台盘外",
                "iusernum1": 193,
                "iusernum2": null
            },
            {
                "itype": "策略载具",
                "user_type": "平台盘内",
                "iusernum1": 1,
                "iusernum2": 191
            },
            {
                "itype": "荒野传说",
                "user_type": "平台盘外",
                "iusernum1": 175,
                "iusernum2": null
            },
            {
                "itype": "策略载具",
                "user_type": "平台盘外",
                "iusernum1": 143,
                "iusernum2": null
            },
            {
                "itype": "单人装备",
                "user_type": "砺刃留存",
                "iusernum1": 58,
                "iusernum2": 246
            },
            {
                "itype": "炎夏混战",
                "user_type": "砺刃留存",
                "iusernum1": 56,
                "iusernum2": 248
            },
            {
                "itype": "策略载具",
                "user_type": "砺刃留存",
                "iusernum1": 36,
                "iusernum2": 248
            },
            {
                "itype": "消灭战",
                "user_type": "砺刃留存",
                "iusernum1": 61,
                "iusernum2": 242
            },
            {
                "itype": "交叉堡垒",
                "user_type": "砺刃留存",
                "iusernum1": 50,
                "iusernum2": 243
            },
            {
                "itype": "交叉堡垒",
                "user_type": "砺刃回流（流失7-13天）",
                "iusernum1": 1,
                "iusernum2": 6
            },
            {
                "itype": "炎夏混战",
                "user_type": "平台盘内",
                "iusernum1": 3,
                "iusernum2": 185
            },
            {
                "itype": "广域战场",
                "user_type": "平台盘内",
                "iusernum1": 7,
                "iusernum2": 192
            },
            {
                "itype": "幻想混战",
                "user_type": "砺刃留存",
                "iusernum1": 59,
                "iusernum2": 249
            },
            {
                "itype": "消灭战",
                "user_type": "平台盘外",
                "iusernum1": 248,
                "iusernum2": null
            },
            {
                "itype": "幻想混战",
                "user_type": "平台盘内",
                "iusernum1": 3,
                "iusernum2": 167
            },
            {
                "itype": "荒野传说",
                "user_type": "砺刃留存",
                "iusernum1": 56,
                "iusernum2": 250
            },
            {
                "itype": "广域战场",
                "user_type": "砺刃留存",
                "iusernum1": 65,
                "iusernum2": 249
            },
            {
                "itype": "单人装备",
                "user_type": "平台盘内",
                "iusernum1": 7,
                "iusernum2": 154
            }
        ]
    },
    {
        "sql_id": "sql_39",
        "sql": "with playuser as (\n    select '广域战场' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate= '20240723'  and  date_add('20240723',2) and submodename= '广域战场模式'\n    group by 1,2,3\n    union all\n    select '消灭战' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20230804'  and  date_add('20230804',2) and modename='组队竞技' and submodename like '%消灭战模式%'\n    group by 1,2,3\n    union all\n    select '幻想混战' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20241115' and  date_add('20241115',2) and modename='创意创作间' and submodename='幻想混战'\n    group by 1,2,3\n    union all\n    select '荒野传说' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240903'  and  date_add('20240903',2) and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n    group by 1,2,3\n    union all\n    select '策略载具' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20241010'   and  date_add('20241010',2) and modename='休闲模式' and submodename like '%策略载具%'\n    group by 1,2,3\n    union all\n    select '炎夏混战' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240625'   and  date_add('20240625',2) and modename='创意创作间' and submodename like '%炎夏混战%'\n    group by 1,2,3\n    union all\n    select '单人装备' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240517'   and  date_add('20240517',2) and modename='组队竞技' and submodename like '%单人装备%'\n    group by 1,2,3\n    union all\n    select '交叉堡垒' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240412'   and  date_add('20240412',2) and modename='组队竞技' and submodename like '%交叉堡垒%'\n    group by 1,2,3\n    union all\n    select '庆典混战' as itype,dtstatdate,vplayerid\n    from  dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240426'  and  date_add('20240426',2) and submode in (2611)\n    group by dtstatdate,vplayerid\n    union all\n    select 'CG29-流浪地球' as itype,dtstatdate,vplayerid\n    from  dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240903' and  date_add('20240903',2)and submodename = 'CG29-流浪地球'\n    group by dtstatdate,vplayerid\n    union all\n    select 'CG28-动物丛林' as itype,dtstatdate,vplayerid\n    from  dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20241105' and  date_add('20241105',2)and submodename = 'CG28-动物丛林'\n    group by dtstatdate,vplayerid\n),\nallplayuser as (\n    select '广域战场' itype,\n        case \n            when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n        end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240723' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240723' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240723',7) and dtstatdate <= date_add('20240723',2)  \n    group by \n        case \n            when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n        end ,\n        vplayerid\n    union all\n    select '消灭战' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20230804' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20230804' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20230804',7) and dtstatdate <= date_add('20230804',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '幻想混战' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20241115' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20241115' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20241115',7) and dtstatdate <= date_add('20241115',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '荒野传说' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240903' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240903' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240903',7) and dtstatdate <= date_add('20240903',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '策略载具' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20241010' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20241010' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20241010',7) and dtstatdate <= date_add('20241010',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '炎夏混战' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240625' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240625' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240625',7) and dtstatdate <= date_add('20240625',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '单人装备' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240517' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240517' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240517',7) and dtstatdate <= date_add('20240517',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '交叉堡垒' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240412' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240412' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240412',7) and dtstatdate <= date_add('20240412',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '庆典混战' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240426' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240426' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240426',7) and dtstatdate <= date_add('20240426',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select 'CG28-动物丛林' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240903' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240903' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240903',7) and dtstatdate <= date_add('20240903',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select 'CG29-流浪地球' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20241105' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20241105' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20241105',7) and dtstatdate <= date_add('20241105',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n)\n\nselect  \n    t.itype, \n    t.playclass1, \n    iusernum1, -- 流入玩法参与用户数\n    iusernum2, -- 流出用户数\n    iusernum3, -- 双栖用户数\n    iusernum4, -- 前一周流出玩法用户数\n    coalesce(round(iusernum2/iusernum4, 2), 0) as ratio1, -- 流出占比\n    iusernum5, -- 后3天流出玩法用户数\n    coalesce(round(iusernum3/iusernum5, 2), 0) as ratio2 -- 双栖占比\nfrom (\n    select itype,count(distinct vplayerid) iusernum1 from playuser group by itype\n)p\nleft join (\n    select \n        a.itype,\n        b.playclass1,\n        count(distinct case when islast=1 and isthis =0 then a.vplayerid end) iusernum2,\n        count(distinct case when islast=1 and isthis =1 then a.vplayerid end) iusernum3\n    from playuser a\n    left join allplayuser b \n    on a.itype =b.itype and a.vplayerid = b.vplayerid\n    group by a.itype,b.playclass1\n)t on p.itype = t.itype\nleft join (\n    select \n        itype, \n        playclass1,\n        count(distinct case when islast=1 then vplayerid end) iusernum4,\n        count(distinct case when isthis=1 then vplayerid end) iusernum5\n    from allplayuser\n    group by itype,playclass1\n) m on t.playclass1=m.playclass1 and t.itype=m.itype\n;",
        "status": "success",
        "result": [
            {
                "itype": "单人装备",
                "playclass1": "组队竞技",
                "iusernum1": 88,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 29,
                "ratio1": 0,
                "iusernum5": 237,
                "ratio2": 0
            },
            {
                "itype": "广域战场",
                "playclass1": "乐园",
                "iusernum1": 117,
                "iusernum2": 2,
                "iusernum3": 0,
                "iusernum4": 11,
                "ratio1": 0.18,
                "iusernum5": 0,
                "ratio2": 0
            },
            {
                "itype": "广域战场",
                "playclass1": "假日群岛",
                "iusernum1": 117,
                "iusernum2": 1,
                "iusernum3": 0,
                "iusernum4": 8,
                "ratio1": 0.13,
                "iusernum5": 1,
                "ratio2": 0
            },
            {
                "itype": "广域战场",
                "playclass1": "其他子模式",
                "iusernum1": 117,
                "iusernum2": 2,
                "iusernum3": 0,
                "iusernum4": 15,
                "ratio1": 0.13,
                "iusernum5": 3,
                "ratio2": 0
            },
            {
                "itype": "广域战场",
                "playclass1": "组队竞技",
                "iusernum1": 117,
                "iusernum2": 0,
                "iusernum3": 2,
                "iusernum4": 26,
                "ratio1": 0,
                "iusernum5": 9,
                "ratio2": 0.22
            },
            {
                "itype": "广域战场",
                "playclass1": "隧道",
                "iusernum1": 117,
                "iusernum2": 0,
                "iusernum3": 2,
                "iusernum4": 27,
                "ratio1": 0,
                "iusernum5": 12,
                "ratio2": 0.17
            },
            {
                "itype": "广域战场",
                "playclass1": "广域战场",
                "iusernum1": 117,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 0,
                "ratio1": 0,
                "iusernum5": 288,
                "ratio2": 0
            },
            {
                "itype": "广域战场",
                "playclass1": "主题群屿",
                "iusernum1": 117,
                "iusernum2": 2,
                "iusernum3": 0,
                "iusernum4": 6,
                "ratio1": 0.33,
                "iusernum5": 1,
                "ratio2": 0
            },
            {
                "itype": "广域战场",
                "playclass1": "极能形态模式",
                "iusernum1": 117,
                "iusernum2": 1,
                "iusernum3": 0,
                "iusernum4": 13,
                "ratio1": 0.08,
                "iusernum5": 3,
                "ratio2": 0
            },
            {
                "itype": "荒野传说",
                "playclass1": "传统群屿",
                "iusernum1": 90,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 0,
                "ratio1": 0,
                "iusernum5": 2,
                "ratio2": 0
            },
            {
                "itype": "幻想混战",
                "playclass1": "组队竞技",
                "iusernum1": 88,
                "iusernum2": 0,
                "iusernum3": 1,
                "iusernum4": 12,
                "ratio1": 0,
                "iusernum5": 7,
                "ratio2": 0.14
            },
            {
                "itype": "幻想混战",
                "playclass1": "假日群岛",
                "iusernum1": 88,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 7,
                "ratio1": 0,
                "iusernum5": 5,
                "ratio2": 0
            },
            {
                "itype": "幻想混战",
                "playclass1": "乐园",
                "iusernum1": 88,
                "iusernum2": 0,
                "iusernum3": 1,
                "iusernum4": 9,
                "ratio1": 0,
                "iusernum5": 4,
                "ratio2": 0.25
            },
            {
                "itype": "荒野传说",
                "playclass1": "组队竞技",
                "iusernum1": 90,
                "iusernum2": 1,
                "iusernum3": 0,
                "iusernum4": 25,
                "ratio1": 0.04,
                "iusernum5": 5,
                "ratio2": 0
            },
            {
                "itype": "荒野传说",
                "playclass1": "隧道",
                "iusernum1": 90,
                "iusernum2": 1,
                "iusernum3": 0,
                "iusernum4": 47,
                "ratio1": 0.02,
                "iusernum5": 23,
                "ratio2": 0
            },
            {
                "itype": "荒野传说",
                "playclass1": "极能形态模式",
                "iusernum1": 90,
                "iusernum2": 1,
                "iusernum3": 1,
                "iusernum4": 16,
                "ratio1": 0.06,
                "iusernum5": 2,
                "ratio2": 0.5
            },
            {
                "itype": "幻想混战",
                "playclass1": "其他子模式",
                "iusernum1": 88,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 6,
                "ratio1": 0,
                "iusernum5": 241,
                "ratio2": 0
            },
            {
                "itype": "荒野传说",
                "playclass1": "主题群屿",
                "iusernum1": 90,
                "iusernum2": 0,
                "iusernum3": 1,
                "iusernum4": 2,
                "ratio1": 0,
                "iusernum5": 5,
                "ratio2": 0.2
            },
            {
                "itype": "荒野传说",
                "playclass1": "休闲模式",
                "iusernum1": 90,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 3,
                "ratio1": 0,
                "iusernum5": 224,
                "ratio2": 0
            },
            {
                "itype": "幻想混战",
                "playclass1": "隧道",
                "iusernum1": 88,
                "iusernum2": 0,
                "iusernum3": 1,
                "iusernum4": 38,
                "ratio1": 0,
                "iusernum5": 21,
                "ratio2": 0.05
            },
            {
                "itype": "荒野传说",
                "playclass1": "假日群岛",
                "iusernum1": 90,
                "iusernum2": 1,
                "iusernum3": 0,
                "iusernum4": 9,
                "ratio1": 0.11,
                "iusernum5": 3,
                "ratio2": 0
            },
            {
                "itype": "荒野传说",
                "playclass1": "其他子模式",
                "iusernum1": 90,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 14,
                "ratio1": 0,
                "iusernum5": 9,
                "ratio2": 0
            },
            {
                "itype": "幻想混战",
                "playclass1": "极能形态模式",
                "iusernum1": 88,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 3,
                "ratio1": 0,
                "iusernum5": 2,
                "ratio2": 0
            },
            {
                "itype": "策略载具",
                "playclass1": "休闲模式",
                "iusernum1": 73,
                "iusernum2": 0,
                "iusernum3": 1,
                "iusernum4": 5,
                "ratio1": 0,
                "iusernum5": 176,
                "ratio2": 0.01
            },
            {
                "itype": "交叉堡垒",
                "playclass1": "乐园",
                "iusernum1": 100,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 4,
                "ratio1": 0,
                "iusernum5": 2,
                "ratio2": 0
            },
            {
                "itype": "交叉堡垒",
                "playclass1": "假日群岛",
                "iusernum1": 100,
                "iusernum2": 0,
                "iusernum3": 1,
                "iusernum4": 76,
                "ratio1": 0,
                "iusernum5": 6,
                "ratio2": 0.17
            },
            {
                "itype": "交叉堡垒",
                "playclass1": "主题群屿",
                "iusernum1": 100,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 47,
                "ratio1": 0,
                "iusernum5": 3,
                "ratio2": 0
            },
            {
                "itype": "策略载具",
                "playclass1": "广阔天地",
                "iusernum1": 73,
                "iusernum2": 1,
                "iusernum3": 0,
                "iusernum4": 2,
                "ratio1": 0.5,
                "iusernum5": 0,
                "ratio2": 0
            },
            {
                "itype": "炎夏混战",
                "playclass1": "其他子模式",
                "iusernum1": 83,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 7,
                "ratio1": 0,
                "iusernum5": 209,
                "ratio2": 0
            },
            {
                "itype": "交叉堡垒",
                "playclass1": "组队竞技",
                "iusernum1": 100,
                "iusernum2": 0,
                "iusernum3": 1,
                "iusernum4": 37,
                "ratio1": 0,
                "iusernum5": 261,
                "ratio2": 0
            },
            {
                "itype": "策略载具",
                "playclass1": "主题群屿",
                "iusernum1": 73,
                "iusernum2": 0,
                "iusernum3": 1,
                "iusernum4": 7,
                "ratio1": 0,
                "iusernum5": 5,
                "ratio2": 0.2
            },
            {
                "itype": "策略载具",
                "playclass1": "其他子模式",
                "iusernum1": 73,
                "iusernum2": 0,
                "iusernum3": 2,
                "iusernum4": 15,
                "ratio1": 0,
                "iusernum5": 4,
                "ratio2": 0.5
            },
            {
                "itype": "策略载具",
                "playclass1": "隧道",
                "iusernum1": 73,
                "iusernum2": 0,
                "iusernum3": 1,
                "iusernum4": 24,
                "ratio1": 0,
                "iusernum5": 9,
                "ratio2": 0.11
            },
            {
                "itype": "策略载具",
                "playclass1": "乐园",
                "iusernum1": 73,
                "iusernum2": 2,
                "iusernum3": 0,
                "iusernum4": 14,
                "ratio1": 0.14,
                "iusernum5": 3,
                "ratio2": 0
            },
            {
                "itype": "交叉堡垒",
                "playclass1": "其他子模式",
                "iusernum1": 100,
                "iusernum2": 0,
                "iusernum3": 2,
                "iusernum4": 35,
                "ratio1": 0,
                "iusernum5": 4,
                "ratio2": 0.5
            },
            {
                "itype": "策略载具",
                "playclass1": "组队竞技",
                "iusernum1": 73,
                "iusernum2": 0,
                "iusernum3": 1,
                "iusernum4": 15,
                "ratio1": 0,
                "iusernum5": 11,
                "ratio2": 0.09
            },
            {
                "itype": "交叉堡垒",
                "playclass1": "极能形态模式",
                "iusernum1": 100,
                "iusernum2": 0,
                "iusernum3": 1,
                "iusernum4": 52,
                "ratio1": 0,
                "iusernum5": 13,
                "ratio2": 0.08
            },
            {
                "itype": "策略载具",
                "playclass1": "假日群岛",
                "iusernum1": 73,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 8,
                "ratio1": 0,
                "iusernum5": 4,
                "ratio2": 0
            },
            {
                "itype": "策略载具",
                "playclass1": "极能形态模式",
                "iusernum1": 73,
                "iusernum2": 1,
                "iusernum3": 0,
                "iusernum4": 12,
                "ratio1": 0.08,
                "iusernum5": 5,
                "ratio2": 0
            },
            {
                "itype": "策略载具",
                "playclass1": "领地",
                "iusernum1": 73,
                "iusernum2": 1,
                "iusernum3": 0,
                "iusernum4": 4,
                "ratio1": 0.25,
                "iusernum5": 0,
                "ratio2": 0
            },
            {
                "itype": "消灭战",
                "playclass1": "其他子模式",
                "iusernum1": 117,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 10,
                "ratio1": 0,
                "iusernum5": 9,
                "ratio2": 0
            },
            {
                "itype": "庆典混战",
                "playclass1": "广阔天地",
                "iusernum1": 4,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 1,
                "ratio1": 0,
                "iusernum5": 4,
                "ratio2": 0
            },
            {
                "itype": "庆典混战",
                "playclass1": "极能形态模式",
                "iusernum1": 4,
                "iusernum2": 1,
                "iusernum3": 1,
                "iusernum4": 22,
                "ratio1": 0.05,
                "iusernum5": 2,
                "ratio2": 0.5
            },
            {
                "itype": "庆典混战",
                "playclass1": "主题群屿",
                "iusernum1": 4,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 7,
                "ratio1": 0,
                "iusernum5": 3,
                "ratio2": 0
            },
            {
                "itype": "消灭战",
                "playclass1": "休闲模式",
                "iusernum1": 117,
                "iusernum2": 1,
                "iusernum3": 0,
                "iusernum4": 11,
                "ratio1": 0.09,
                "iusernum5": 3,
                "ratio2": 0
            },
            {
                "itype": "庆典混战",
                "playclass1": "假日群岛",
                "iusernum1": 4,
                "iusernum2": 0,
                "iusernum3": 2,
                "iusernum4": 10,
                "ratio1": 0,
                "iusernum5": 7,
                "ratio2": 0.29
            },
            {
                "itype": "庆典混战",
                "playclass1": "乐园",
                "iusernum1": 4,
                "iusernum2": 1,
                "iusernum3": 0,
                "iusernum4": 9,
                "ratio1": 0.11,
                "iusernum5": 1,
                "ratio2": 0
            },
            {
                "itype": "庆典混战",
                "playclass1": "传统群屿",
                "iusernum1": 4,
                "iusernum2": 0,
                "iusernum3": 1,
                "iusernum4": 1,
                "ratio1": 0,
                "iusernum5": 1,
                "ratio2": 1
            },
            {
                "itype": "庆典混战",
                "playclass1": "其他子模式",
                "iusernum1": 4,
                "iusernum2": 0,
                "iusernum3": 1,
                "iusernum4": 15,
                "ratio1": 0,
                "iusernum5": 7,
                "ratio2": 0.14
            },
            {
                "itype": "庆典混战",
                "playclass1": "组队竞技",
                "iusernum1": 4,
                "iusernum2": 1,
                "iusernum3": 3,
                "iusernum4": 42,
                "ratio1": 0.02,
                "iusernum5": 12,
                "ratio2": 0.25
            },
            {
                "itype": "消灭战",
                "playclass1": "极能形态模式",
                "iusernum1": 117,
                "iusernum2": 1,
                "iusernum3": 0,
                "iusernum4": 10,
                "ratio1": 0.1,
                "iusernum5": 5,
                "ratio2": 0
            },
            {
                "itype": "消灭战",
                "playclass1": "假日群岛",
                "iusernum1": 117,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 10,
                "ratio1": 0,
                "iusernum5": 6,
                "ratio2": 0
            },
            {
                "itype": "消灭战",
                "playclass1": "乐园",
                "iusernum1": 117,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 7,
                "ratio1": 0,
                "iusernum5": 4,
                "ratio2": 0
            },
            {
                "itype": "消灭战",
                "playclass1": "组队竞技",
                "iusernum1": 117,
                "iusernum2": 0,
                "iusernum3": 1,
                "iusernum4": 30,
                "ratio1": 0,
                "iusernum5": 308,
                "ratio2": 0
            },
            {
                "itype": "消灭战",
                "playclass1": "广阔天地",
                "iusernum1": 117,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 9,
                "ratio1": 0,
                "iusernum5": 4,
                "ratio2": 0
            },
            {
                "itype": "庆典混战",
                "playclass1": "领地",
                "iusernum1": 4,
                "iusernum2": 0,
                "iusernum3": 0,
                "iusernum4": 2,
                "ratio1": 0,
                "iusernum5": 1,
                "ratio2": 0
            }
        ]
    },
    {
        "sql_id": "sql_40",
        "sql": "WITH base AS (\n  SELECT\n    DATE_FORMAT(STR_TO_DATE(dtstatdate, '%Y%m%d'), '%Y%m') AS stat_month,\n    vplayerid,\n    COUNT(DISTINCT dtstatdate) AS active_days\n  FROM dws_jordass_login_di\n  WHERE dtstatdate BETWEEN '20240301' AND '20240630'\n    AND platid = 255\n  GROUP BY stat_month, vplayerid\n),\nmonth_info AS (\n  SELECT\n    b.stat_month,\n    b.vplayerid,\n    b.active_days,\n    MIN(b.stat_month) OVER (PARTITION BY b.vplayerid) AS first_month\n  FROM base b\n),\nprev_month_map AS (\n  SELECT\n    stat_month,\n    DATE_FORMAT(DATE_SUB(STR_TO_DATE(CONCAT(stat_month, '01'), '%Y%m%d'), INTERVAL 1 MONTH), '%Y%m') AS prev_month\n  FROM (SELECT DISTINCT stat_month FROM base) t\n),\nclassified AS (\n  SELECT\n    m.stat_month,\n    m.vplayerid,\n    m.active_days,\n    CASE\n      WHEN m.stat_month = m.first_month THEN 'new'\n      WHEN prev.vplayerid IS NOT NULL THEN 'retained'\n      WHEN m.stat_month > m.first_month THEN 'return'\n      ELSE 'other'\n    END AS user_type\n  FROM month_info m\n  LEFT JOIN prev_month_map pm ON m.stat_month = pm.stat_month\n  LEFT JOIN base prev ON prev.stat_month = pm.prev_month AND prev.vplayerid = m.vplayerid\n)\nSELECT\n  stat_month,\n  SUM(CASE WHEN user_type = 'new' THEN 1 ELSE 0 END) AS new_user_cnt,\n  SUM(CASE WHEN user_type = 'return' THEN 1 ELSE 0 END) AS return_user_cnt,\n  SUM(CASE WHEN user_type = 'retained' AND active_days BETWEEN 1 AND 4 THEN 1 ELSE 0 END) AS light_retained_user_cnt,\n  SUM(CASE WHEN user_type = 'retained' AND active_days BETWEEN 5 AND 15 THEN 1 ELSE 0 END) AS medium_retained_user_cnt,\n  SUM(CASE WHEN user_type = 'retained' AND active_days >= 16 THEN 1 ELSE 0 END) AS heavy_retained_user_cnt\nFROM classified\nGROUP BY stat_month\nORDER BY stat_month",
        "status": "success",
        "result": [
            {
                "stat_month": "202403",
                "new_user_cnt": 209,
                "return_user_cnt": 0,
                "light_retained_user_cnt": 0,
                "medium_retained_user_cnt": 0,
                "heavy_retained_user_cnt": 0
            },
            {
                "stat_month": "202404",
                "new_user_cnt": 35,
                "return_user_cnt": 0,
                "light_retained_user_cnt": 82,
                "medium_retained_user_cnt": 0,
                "heavy_retained_user_cnt": 0
            },
            {
                "stat_month": "202405",
                "new_user_cnt": 38,
                "return_user_cnt": 50,
                "light_retained_user_cnt": 46,
                "medium_retained_user_cnt": 0,
                "heavy_retained_user_cnt": 0
            },
            {
                "stat_month": "202406",
                "new_user_cnt": 53,
                "return_user_cnt": 63,
                "light_retained_user_cnt": 78,
                "medium_retained_user_cnt": 6,
                "heavy_retained_user_cnt": 0
            }
        ]
    },
    {
        "sql_id": "sql_41",
        "sql": "select\n  dtstatdate as stat_date,\n  count(distinct vplayerid) as player_cnt\nfrom dws_jordass_login_di\nwhere dtstatdate between '20240101' and '20240103'\ngroup by dtstatdate\norder by dtstatdate",
        "status": "success",
        "result": [
            {
                "stat_date": "20240101",
                "player_cnt": 90
            },
            {
                "stat_date": "20240102",
                "player_cnt": 73
            },
            {
                "stat_date": "20240103",
                "player_cnt": 69
            }
        ]
    },
    {
        "sql_id": "sql_42",
        "sql": "select\n  dtstatdate,\n  split_part(extarg2, '_', 2) as second_value,\n  count(distinct vplayerid) as user_cnt,\n  count(*) as click_cnt\nfrom dws_jordass_buttonpress_pre_di\nwhere dtstatdate between '20211101' and '20211130'\n  and split_part(extarg2, '_', 2) in ('8', '16', '17')\ngroup by dtstatdate, split_part(extarg2, '_', 2)\norder by dtstatdate, second_value",
        "status": "success",
        "result": [
            {
                "dtstatdate": "20211101",
                "second_value": "16",
                "user_cnt": 8,
                "click_cnt": 8
            },
            {
                "dtstatdate": "20211101",
                "second_value": "17",
                "user_cnt": 8,
                "click_cnt": 8
            },
            {
                "dtstatdate": "20211101",
                "second_value": "8",
                "user_cnt": 10,
                "click_cnt": 13
            },
            {
                "dtstatdate": "20211102",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211102",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211102",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211103",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211103",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211103",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211104",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211104",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211104",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211105",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211105",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211105",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211106",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211106",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211106",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211107",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211107",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211107",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211108",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211108",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211108",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211109",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211109",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211109",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211110",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211110",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211110",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211111",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211111",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211111",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211112",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211112",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211112",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211113",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211113",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211113",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211114",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211114",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211114",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211115",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211115",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211115",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211116",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211116",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211116",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211117",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211117",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211117",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211118",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211118",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211118",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211119",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211119",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211119",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211120",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211120",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211120",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211121",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211121",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211121",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211122",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211122",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211122",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211123",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211123",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211123",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211124",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211124",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211124",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211125",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211125",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211125",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211126",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211126",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211126",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211127",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211127",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211127",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211128",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211128",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211128",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211129",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211129",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211129",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211130",
                "second_value": "16",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211130",
                "second_value": "17",
                "user_cnt": 2,
                "click_cnt": 2
            },
            {
                "dtstatdate": "20211130",
                "second_value": "8",
                "user_cnt": 2,
                "click_cnt": 2
            }
        ]
    },
    {
        "sql_id": "sql_43",
        "sql": "with jan_active as (\n  select\n    vplayerid,\n    count(distinct dtstatdate) as active_days\n  from dws_jordass_login_di\n  where dtstatdate between '20250101' and '20250131'\n  group by vplayerid\n)\nselect\n  case\n    when active_days between 1 and 5 then '轻度'\n    when active_days between 6 and 15 then '中度'\n    when active_days >= 16 then '重度'\n    else '未知'\n  end as actv_level,\n  count(*) as player_cnt\nfrom jan_active\nwhere active_days > 0\ngroup by actv_level\norder by actv_level",
        "status": "success",
        "result": [
            {
                "actv_level": "中度",
                "player_cnt": 7
            },
            {
                "actv_level": "轻度",
                "player_cnt": 20
            },
            {
                "actv_level": "重度",
                "player_cnt": 6
            }
        ]
    },
    {
        "sql_id": "sql_44",
        "sql": "with user_pay as (\n  select\n    vplayerid,\n    sum(imoney) / 100.0 as pay_amount\n  from dws_jordass_water_di\n  where dtstatdate between '20240101' and '20241231'\n  group by vplayerid\n),\nfiltered as (\n  select *\n  from user_pay\n  where pay_amount > 0\n)\nselect\n  case\n    when pay_amount <= 12 then '小R'\n    when pay_amount <= 60 then '中R'\n    when pay_amount <= 180 then '大R'\n    when pay_amount > 180 then '超R'\n    else '未知'\n  end as pay_segment,\n  count(*) as user_cnt,\n  round(sum(pay_amount), 2) as pay_amount\nfrom filtered\ngroup by pay_segment\norder by pay_segment",
        "status": "success",
        "result": [
            {
                "pay_segment": "中R",
                "user_cnt": 212,
                "pay_amount": 6626.9
            },
            {
                "pay_segment": "大R",
                "user_cnt": 159,
                "pay_amount": 17191.2
            },
            {
                "pay_segment": "小R",
                "user_cnt": 166,
                "pay_amount": 963.5
            },
            {
                "pay_segment": "超R",
                "user_cnt": 245,
                "pay_amount": 138889089814.7
            }
        ]
    },
    {
        "sql_id": "sql_45",
        "sql": "select count(distinct a.vplayerid) as player_num\nfrom (\n    select distinct vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20240101' and '20240107'\n    and imode = 1287652322611036928\n) a\nleft join (\n    select distinct vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20240108' and '20240114'\n    and imode = 1287652322611036928\n) b on a.vplayerid = b.vplayerid\njoin (\n    select distinct vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20240115' and '20240121'\n    and imode = 1287652322611036928\n) c on a.vplayerid = c.vplayerid\nwhere b.vplayerid is null;",
        "status": "success",
        "result": [
            {
                "player_num": 114
            }
        ]
    },
    {
        "sql_id": "sql_46",
        "sql": "select\n    week, -- 统计周\n    active_days, -- 活跃天数\n    count(distinct vplayerid) as user_num -- 玩家数\nfrom (\n    select\n        vplayerid, -- 玩家playerid\n        weekofyear(dtstatdate) as week, -- 统计周\n        count(distinct dtstatdate) as active_days -- 活跃天数\n    from dws_jordass_login_di\n    where dtstatdate >= '20240101' and dtstatdate <= '20240202' and platid=255\n    group by\n        vplayerid,\n        weekofyear(dtstatdate)\n)f\ngroup by\n    week,\n    active_days",
        "status": "success",
        "result": [
            {
                "week": 1,
                "active_days": 4,
                "user_num": 2
            },
            {
                "week": 5,
                "active_days": 1,
                "user_num": 6
            },
            {
                "week": 2,
                "active_days": 5,
                "user_num": 1
            },
            {
                "week": 3,
                "active_days": 5,
                "user_num": 1
            },
            {
                "week": 4,
                "active_days": 6,
                "user_num": 1
            },
            {
                "week": 4,
                "active_days": 7,
                "user_num": 3
            },
            {
                "week": 2,
                "active_days": 7,
                "user_num": 4
            },
            {
                "week": 1,
                "active_days": 6,
                "user_num": 1
            },
            {
                "week": 2,
                "active_days": 2,
                "user_num": 3
            },
            {
                "week": 4,
                "active_days": 3,
                "user_num": 1
            },
            {
                "week": 3,
                "active_days": 7,
                "user_num": 3
            },
            {
                "week": 5,
                "active_days": 5,
                "user_num": 5
            },
            {
                "week": 3,
                "active_days": 4,
                "user_num": 3
            },
            {
                "week": 1,
                "active_days": 2,
                "user_num": 3
            },
            {
                "week": 3,
                "active_days": 3,
                "user_num": 1
            },
            {
                "week": 1,
                "active_days": 3,
                "user_num": 1
            },
            {
                "week": 4,
                "active_days": 4,
                "user_num": 1
            },
            {
                "week": 3,
                "active_days": 6,
                "user_num": 1
            },
            {
                "week": 5,
                "active_days": 2,
                "user_num": 2
            },
            {
                "week": 4,
                "active_days": 1,
                "user_num": 3
            },
            {
                "week": 2,
                "active_days": 3,
                "user_num": 1
            },
            {
                "week": 1,
                "active_days": 1,
                "user_num": 207
            },
            {
                "week": 2,
                "active_days": 4,
                "user_num": 1
            },
            {
                "week": 4,
                "active_days": 2,
                "user_num": 5
            },
            {
                "week": 5,
                "active_days": 3,
                "user_num": 1
            },
            {
                "week": 3,
                "active_days": 1,
                "user_num": 4
            },
            {
                "week": 2,
                "active_days": 6,
                "user_num": 1
            },
            {
                "week": 5,
                "active_days": 4,
                "user_num": 1
            },
            {
                "week": 1,
                "active_days": 7,
                "user_num": 5
            },
            {
                "week": 4,
                "active_days": 5,
                "user_num": 1
            },
            {
                "week": 3,
                "active_days": 2,
                "user_num": 3
            },
            {
                "week": 1,
                "active_days": 5,
                "user_num": 1
            },
            {
                "week": 2,
                "active_days": 1,
                "user_num": 7
            }
        ]
    },
    {
        "sql_id": "sql_47",
        "sql": "with pay_users as (\n  select distinct vplayerid\n  from dws_jordass_water_di\n  where dtstatdate between '20230701' and '20230831'\n),\nlater_active as (\n  select distinct vplayerid\n  from dws_jordass_login_di\n  where dtstatdate between '20230901' and '20230921'\n),\nearly_login as (\n  select\n    dtstatdate,\n    vplayerid\n  from dws_jordass_login_di\n  where dtstatdate between '20230701' and '20230831'\n    and vgameappid = 'wx'\n)\nselect\n  dtstatdate,\n  count(distinct vplayerid) as user_cnt\nfrom early_login l\nwhere exists (select 1 from pay_users p where p.vplayerid = l.vplayerid)\n  and not exists (select 1 from later_active a where a.vplayerid = l.vplayerid)\ngroup by dtstatdate\norder by dtstatdate",
        "status": "success",
        "result": [
            {
                "dtstatdate": "20230701",
                "user_cnt": 1
            },
            {
                "dtstatdate": "20230702",
                "user_cnt": 3
            },
            {
                "dtstatdate": "20230703",
                "user_cnt": 3
            },
            {
                "dtstatdate": "20230704",
                "user_cnt": 2
            },
            {
                "dtstatdate": "20230705",
                "user_cnt": 5
            },
            {
                "dtstatdate": "20230706",
                "user_cnt": 3
            },
            {
                "dtstatdate": "20230707",
                "user_cnt": 3
            },
            {
                "dtstatdate": "20230708",
                "user_cnt": 6
            },
            {
                "dtstatdate": "20230709",
                "user_cnt": 3
            },
            {
                "dtstatdate": "20230710",
                "user_cnt": 4
            },
            {
                "dtstatdate": "20230711",
                "user_cnt": 3
            },
            {
                "dtstatdate": "20230712",
                "user_cnt": 6
            },
            {
                "dtstatdate": "20230713",
                "user_cnt": 3
            },
            {
                "dtstatdate": "20230714",
                "user_cnt": 3
            },
            {
                "dtstatdate": "20230715",
                "user_cnt": 5
            },
            {
                "dtstatdate": "20230716",
                "user_cnt": 3
            },
            {
                "dtstatdate": "20230717",
                "user_cnt": 3
            },
            {
                "dtstatdate": "20230718",
                "user_cnt": 4
            },
            {
                "dtstatdate": "20230719",
                "user_cnt": 3
            },
            {
                "dtstatdate": "20230720",
                "user_cnt": 6
            },
            {
                "dtstatdate": "20230722",
                "user_cnt": 2
            },
            {
                "dtstatdate": "20230725",
                "user_cnt": 2
            },
            {
                "dtstatdate": "20230728",
                "user_cnt": 2
            },
            {
                "dtstatdate": "20230729",
                "user_cnt": 1
            },
            {
                "dtstatdate": "20230730",
                "user_cnt": 1
            },
            {
                "dtstatdate": "20230801",
                "user_cnt": 2
            },
            {
                "dtstatdate": "20230803",
                "user_cnt": 1
            },
            {
                "dtstatdate": "20230805",
                "user_cnt": 3
            },
            {
                "dtstatdate": "20230810",
                "user_cnt": 3
            },
            {
                "dtstatdate": "20230812",
                "user_cnt": 2
            },
            {
                "dtstatdate": "20230815",
                "user_cnt": 2
            },
            {
                "dtstatdate": "20230818",
                "user_cnt": 2
            },
            {
                "dtstatdate": "20230820",
                "user_cnt": 3
            },
            {
                "dtstatdate": "20230822",
                "user_cnt": 1
            },
            {
                "dtstatdate": "20230823",
                "user_cnt": 1
            },
            {
                "dtstatdate": "20230825",
                "user_cnt": 3
            },
            {
                "dtstatdate": "20230827",
                "user_cnt": 1
            },
            {
                "dtstatdate": "20230828",
                "user_cnt": 1
            },
            {
                "dtstatdate": "20230830",
                "user_cnt": 2
            }
        ]
    },
    {
        "sql_id": "sql_48",
        "sql": "select\n    count(distinct case when is_backflow_7 then vplayerid end) as backflow_7_user,\n    count(distinct case when is_backflow_30 then vplayerid end) as backflow_30_user\nfrom (\n    select\n        vplayerid,\n        -- 检查是否满足流失7天回流条件\n        (dregdate <> dtstatdate) and\n        (instr(substr(cbitmap, 1, 1), '1') > 0) and\n        (instr(substr(cbitmap, 2, 7), '1') = 0) as is_backflow_7,\n        \n        -- 检查是否满足流失30天回流条件\n        (dregdate <> dtstatdate) and\n        (instr(substr(cbitmap, 1, 1), '1') > 0) and\n        (instr(substr(cbitmap, 2, 30), '1') = 0) as is_backflow_30\n    from\n        dws_jordass_login_df\n    where\n        dtstatdate = '20231201'\n        and platid = 255\n) as user_flags;",
        "status": "success",
        "result": [
            {
                "backflow_7_user": 86,
                "backflow_30_user": 70
            }
        ]
    },
    {
        "sql_id": "sql_49",
        "sql": "with play_user as (\n    select distinct\n        p.dtstatdate as ds, --日期\n        p.vplayerid    --玩家id\n    from\n        dws_jordass_matchlog_stat_di p\n    join\n        dim_jordass_submodeonline_nf c\n    on\n        p.imode = c.matchsubmodegroup\n    where\n        p.dtstatdate between '20241001' and '20241008'\n        and datediff('20241001', c.onlinedate) >= 7\n        and datediff('20241007', c.onlinedate) <= 90\n)\nselect\n    '20241001-20241007' as period, --周期\n    a.ds,\n    count(distinct a.vplayerid) as play_user_num, --参与人数\n    count(distinct b.vplayerid) as retention_user_num --次留人数\nfrom\n    play_user a\nleft join\n    play_user b\non\n    a.vplayerid = b.vplayerid\n    and b.ds = date_add(a.ds, 1)  -- 次日留存条件\nwhere\n    a.ds between '20241001' and '20241007'\ngroup by\n    a.ds\norder by\n    a.ds;",
        "status": "success",
        "result": [
            {
                "period": "20241001-20241007",
                "ds": "20241001",
                "play_user_num": 137,
                "retention_user_num": 17
            },
            {
                "period": "20241001-20241007",
                "ds": "20241002",
                "play_user_num": 120,
                "retention_user_num": 13
            },
            {
                "period": "20241001-20241007",
                "ds": "20241003",
                "play_user_num": 136,
                "retention_user_num": 15
            },
            {
                "period": "20241001-20241007",
                "ds": "20241004",
                "play_user_num": 110,
                "retention_user_num": 21
            },
            {
                "period": "20241001-20241007",
                "ds": "20241005",
                "play_user_num": 134,
                "retention_user_num": 22
            },
            {
                "period": "20241001-20241007",
                "ds": "20241006",
                "play_user_num": 111,
                "retention_user_num": 18
            },
            {
                "period": "20241001-20241007",
                "ds": "20241007",
                "play_user_num": 113,
                "retention_user_num": 13
            }
        ]
    },
    {
        "sql_id": "sql_50",
        "sql": "WITH base_players AS (\n  SELECT DISTINCT vplayerid\n  FROM dws_jordass_login_di\n  WHERE dtstatdate BETWEEN '20241001' AND '20241031'\n    AND platid = 255\n), button_flags AS (\n  SELECT\n    vplayerid,\n    MAX(CASE WHEN buttontype = '400211' THEN 1 ELSE 0 END) AS clicked_400211,\n    MAX(CASE WHEN buttontype = '400212' THEN 1 ELSE 0 END) AS clicked_400212\n  FROM dws_jordass_buttonpress_pre_di\n  WHERE dtstatdate BETWEEN '20241001' AND '20241031'\n  GROUP BY vplayerid\n), user_type_base AS (\n  SELECT\n    b.vplayerid,\n    CASE\n      WHEN COALESCE(f.clicked_400211, 0) = 1 AND COALESCE(f.clicked_400212, 0) = 1 THEN '400211&400212'\n      WHEN COALESCE(f.clicked_400211, 0) = 1 AND COALESCE(f.clicked_400212, 0) = 0 THEN '400211'\n      WHEN COALESCE(f.clicked_400211, 0) = 0 AND COALESCE(f.clicked_400212, 0) = 1 THEN '400212'\n      ELSE 'other'\n    END AS user_type\n  FROM base_players b\n  LEFT JOIN button_flags f\n    ON b.vplayerid = f.vplayerid\n), gender_latest AS (\n  SELECT\n    vplayerid,\n    CASE\n      WHEN gender = 1 THEN 'male'\n      WHEN gender = 2 THEN 'female'\n      ELSE 'other'\n    END AS gender_bucket\n  FROM (\n    SELECT\n      vplayerid,\n      gender,\n      ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY dteventtime DESC) AS rn\n    FROM dwd_jordass_playerlogin_hi\n    WHERE DATE_FORMAT(CAST(dteventtime AS DATETIME), '%Y-%m-%d') <= '2024-10-31'\n  ) t\n  WHERE rn = 1\n), arena_active AS (\n  SELECT\n    vplayerid,\n    COUNT(DISTINCT dtstatdate) AS arena_active_days\n  FROM dws_jordass_login_di\n  WHERE dtstatdate BETWEEN '20241001' AND '20241031'\n    AND platid = 255\n  GROUP BY vplayerid\n), park_active AS (\n  SELECT\n    vplayerid,\n    COUNT(DISTINCT dtstatdate) AS park_active_days\n  FROM dws_jordass_matchlog_stat_di\n  WHERE dtstatdate BETWEEN '20241001' AND '20241031'\n    AND platid = 255\n  GROUP BY vplayerid\n), enriched AS (\n  SELECT\n    u.vplayerid,\n    u.user_type,\n    COALESCE(g.gender_bucket, 'other') AS gender_bucket,\n    COALESCE(park_active_days, 0) AS park_days,\n    COALESCE(arena_active_days, 0) AS arena_days\n  FROM user_type_base u\n  LEFT JOIN gender_latest g\n    ON u.vplayerid = g.vplayerid\n  LEFT JOIN park_active p\n    ON u.vplayerid = p.vplayerid\n  LEFT JOIN arena_active a\n    ON u.vplayerid = a.vplayerid\n), final AS (\n  SELECT\n    user_type,\n    gender_bucket,\n    CASE\n      WHEN park_days BETWEEN 1 AND 4 THEN 'light'\n      WHEN park_days BETWEEN 5 AND 15 THEN 'medium'\n      WHEN park_days >= 16 THEN 'heavy'\n      ELSE 'other'\n    END AS park_active_level,\n    CASE\n      WHEN arena_days BETWEEN 1 AND 4 THEN 'light'\n      WHEN arena_days BETWEEN 5 AND 15 THEN 'medium'\n      WHEN arena_days >= 16 THEN 'heavy'\n      ELSE 'other'\n    END AS arena_active_level,\n    COUNT(DISTINCT vplayerid) AS user_cnt\n  FROM enriched\n  GROUP BY user_type, gender_bucket,\n           CASE\n             WHEN park_days BETWEEN 1 AND 4 THEN 'light'\n             WHEN park_days BETWEEN 5 AND 15 THEN 'medium'\n             WHEN park_days >= 16 THEN 'heavy'\n             ELSE 'other'\n           END,\n           CASE\n             WHEN arena_days BETWEEN 1 AND 4 THEN 'light'\n             WHEN arena_days BETWEEN 5 AND 15 THEN 'medium'\n             WHEN arena_days >= 16 THEN 'heavy'\n             ELSE 'other'\n           END\n)\nSELECT\n  user_type,\n  gender_bucket,\n  park_active_level,\n  arena_active_level,\n  user_cnt\nFROM final\nORDER BY user_type, gender_bucket, park_active_level, arena_active_level",
        "status": "success",
        "result": []
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql_id": "sql_56",
        "sql": "select\n    register_date,\n    count(distinct vplayerid) as new_user_cnt,\n    round(sum(case when datediff_pay < 1 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv1,\n    round(sum(case when datediff_pay < 3 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv3,\n    round(sum(case when datediff_pay < 7 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv7,\n    round(sum(case when datediff_pay < 14 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv14,\n    round(sum(case when datediff_pay < 30 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv30,\n    round(sum(case when datediff_pay < 60 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv60,\n    round(sum(case when datediff_pay < 90 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv90,\n    round(sum(case when datediff_pay < 180 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv180\nfrom (\n    select\n        s1.register_date,\n        s1.vplayerid,\n        s2.pay_date,\n        datediff(s2.pay_date, s1.register_date) as datediff_pay,\n        sum(s2.pay_amount) as sum_pay_amount\n    from (\n        select\n            distinct dregdate as register_date,\n            vplayerid\n        from dws_jordass_login_df\n        where dtstatdate = '20240131'\n          and platid = 255\n          and dregdate >= '20240101' and dregdate <= '20240131'\n    ) s1\n    left join (\n        select\n            dtstatdate as pay_date,\n            vplayerid,\n            sum(imoney/100) as pay_amount\n        from dws_jordass_water_di\n        where dtstatdate >= '20240101' and dtstatdate <= date_add('20240131', 179)\n          and platid = 255\n        group by dtstatdate, vplayerid\n    ) s2 on s1.vplayerid = s2.vplayerid\n    group by s1.register_date, s1.vplayerid, s2.pay_date\n) base\ngroup by register_date",
        "status": "success",
        "result": [
            {
                "register_date": "20240101",
                "new_user_cnt": 51,
                "ltv1": 24.04,
                "ltv3": 24.04,
                "ltv7": 69.12,
                "ltv14": 69.35,
                "ltv30": 79.9,
                "ltv60": 107.98,
                "ltv90": 121,
                "ltv180": 229.24
            },
            {
                "register_date": "20240115",
                "new_user_cnt": 33,
                "ltv1": 0,
                "ltv3": 0.18,
                "ltv7": 0.73,
                "ltv14": 6.12,
                "ltv30": 76,
                "ltv60": 85.7,
                "ltv90": 91.94,
                "ltv180": 174.55
            },
            {
                "register_date": "20240112",
                "new_user_cnt": 30,
                "ltv1": 0.2,
                "ltv3": 1,
                "ltv7": 1,
                "ltv14": 2.2,
                "ltv30": 116.57,
                "ltv60": 133.97,
                "ltv90": 134.37,
                "ltv180": 345.43
            },
            {
                "register_date": "20240129",
                "new_user_cnt": 29,
                "ltv1": 0,
                "ltv3": 3.1,
                "ltv7": 3.1,
                "ltv14": 4.76,
                "ltv30": 36.55,
                "ltv60": 111.17,
                "ltv90": 146.07,
                "ltv180": 307.41
            },
            {
                "register_date": "20240111",
                "new_user_cnt": 31,
                "ltv1": 3.81,
                "ltv3": 3.81,
                "ltv7": 3.81,
                "ltv14": 3.84,
                "ltv30": 12.48,
                "ltv60": 27,
                "ltv90": 36.42,
                "ltv180": 110.68
            },
            {
                "register_date": "20240121",
                "new_user_cnt": 22,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0,
                "ltv14": 0.14,
                "ltv30": 59.82,
                "ltv60": 66.82,
                "ltv90": 99.05,
                "ltv180": 299
            },
            {
                "register_date": "20240109",
                "new_user_cnt": 20,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0,
                "ltv14": 13.9,
                "ltv30": 17.1,
                "ltv60": 25.2,
                "ltv90": 34.5,
                "ltv180": 43.65
            },
            {
                "register_date": "20240119",
                "new_user_cnt": 42,
                "ltv1": 0,
                "ltv3": 7.14,
                "ltv7": 7.14,
                "ltv14": 7.14,
                "ltv30": 12.07,
                "ltv60": 27.83,
                "ltv90": 30.33,
                "ltv180": 78.4
            },
            {
                "register_date": "20240124",
                "new_user_cnt": 32,
                "ltv1": 0,
                "ltv3": 2.44,
                "ltv7": 2.44,
                "ltv14": 3.41,
                "ltv30": 4.16,
                "ltv60": 9.97,
                "ltv90": 22.22,
                "ltv180": 58.31
            },
            {
                "register_date": "20240130",
                "new_user_cnt": 31,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0,
                "ltv14": 0,
                "ltv30": 1.45,
                "ltv60": 10.42,
                "ltv90": 28.29,
                "ltv180": 71.94
            },
            {
                "register_date": "20240103",
                "new_user_cnt": 29,
                "ltv1": 0.21,
                "ltv3": 3.31,
                "ltv7": 3.31,
                "ltv14": 3.31,
                "ltv30": 5.03,
                "ltv60": 47.66,
                "ltv90": 52.76,
                "ltv180": 121.66
            },
            {
                "register_date": "20240128",
                "new_user_cnt": 28,
                "ltv1": 7.07,
                "ltv3": 7.07,
                "ltv7": 15.21,
                "ltv14": 15.21,
                "ltv30": 23.43,
                "ltv60": 37.71,
                "ltv90": 48.57,
                "ltv180": 76.61
            },
            {
                "register_date": "20240125",
                "new_user_cnt": 25,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0,
                "ltv14": 24.64,
                "ltv30": 25.72,
                "ltv60": 156.95,
                "ltv90": 225.43,
                "ltv180": 238.35
            },
            {
                "register_date": "20240120",
                "new_user_cnt": 47,
                "ltv1": 0,
                "ltv3": 0.17,
                "ltv7": 0.17,
                "ltv14": 2.89,
                "ltv30": 18.15,
                "ltv60": 98.91,
                "ltv90": 108.32,
                "ltv180": 134.02
            },
            {
                "register_date": "20240116",
                "new_user_cnt": 32,
                "ltv1": 4.59,
                "ltv3": 4.78,
                "ltv7": 4.78,
                "ltv14": 5.22,
                "ltv30": 6.53,
                "ltv60": 40.5,
                "ltv90": 77.22,
                "ltv180": 215.13
            },
            {
                "register_date": "20240102",
                "new_user_cnt": 32,
                "ltv1": 7.56,
                "ltv3": 7.59,
                "ltv7": 7.59,
                "ltv14": 7.59,
                "ltv30": 8.72,
                "ltv60": 23.94,
                "ltv90": 62.28,
                "ltv180": 149.53
            },
            {
                "register_date": "20240117",
                "new_user_cnt": 27,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0.96,
                "ltv14": 2.3,
                "ltv30": 48.33,
                "ltv60": 91,
                "ltv90": 163.81,
                "ltv180": 233.59
            },
            {
                "register_date": "20240108",
                "new_user_cnt": 28,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0,
                "ltv14": 6.29,
                "ltv30": 9.39,
                "ltv60": 55.11,
                "ltv90": 60.93,
                "ltv180": 85.82
            },
            {
                "register_date": "20240105",
                "new_user_cnt": 40,
                "ltv1": 0,
                "ltv3": 3.65,
                "ltv7": 7.05,
                "ltv14": 7.05,
                "ltv30": 22.95,
                "ltv60": 106.95,
                "ltv90": 294.1,
                "ltv180": 403.53
            },
            {
                "register_date": "20240127",
                "new_user_cnt": 36,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0,
                "ltv14": 0,
                "ltv30": 107.25,
                "ltv60": 195.78,
                "ltv90": 263.36,
                "ltv180": 474.78
            },
            {
                "register_date": "20240118",
                "new_user_cnt": 29,
                "ltv1": 0,
                "ltv3": 11.66,
                "ltv7": 14.69,
                "ltv14": 19.38,
                "ltv30": 41.86,
                "ltv60": 60.69,
                "ltv90": 67.07,
                "ltv180": 143.52
            },
            {
                "register_date": "20240104",
                "new_user_cnt": 19,
                "ltv1": 10.42,
                "ltv3": 10.42,
                "ltv7": 115.58,
                "ltv14": 117.84,
                "ltv30": 147.42,
                "ltv60": 215.95,
                "ltv90": 222.78,
                "ltv180": 272.99
            },
            {
                "register_date": "20240122",
                "new_user_cnt": 23,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0,
                "ltv14": 0,
                "ltv30": 10.3,
                "ltv60": 64.39,
                "ltv90": 68.61,
                "ltv180": 132.48
            },
            {
                "register_date": "20240107",
                "new_user_cnt": 39,
                "ltv1": 0,
                "ltv3": 0.33,
                "ltv7": 0.33,
                "ltv14": 6.51,
                "ltv30": 20.26,
                "ltv60": 59.46,
                "ltv90": 104.56,
                "ltv180": 197.54
            },
            {
                "register_date": "20240110",
                "new_user_cnt": 32,
                "ltv1": 0.56,
                "ltv3": 7.44,
                "ltv7": 27.91,
                "ltv14": 42.34,
                "ltv30": 63.28,
                "ltv60": 98.75,
                "ltv90": 129.5,
                "ltv180": 212.47
            },
            {
                "register_date": "20240114",
                "new_user_cnt": 39,
                "ltv1": 0,
                "ltv3": 0.15,
                "ltv7": 223.15,
                "ltv14": 223.15,
                "ltv30": 228.1,
                "ltv60": 279.95,
                "ltv90": 307.44,
                "ltv180": 374.21
            },
            {
                "register_date": "20240126",
                "new_user_cnt": 27,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0,
                "ltv14": 0,
                "ltv30": 3.37,
                "ltv60": 4.07,
                "ltv90": 191.52,
                "ltv180": 327.11
            },
            {
                "register_date": "20240131",
                "new_user_cnt": 34,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0,
                "ltv14": 7.53,
                "ltv30": 36.26,
                "ltv60": 63.97,
                "ltv90": 74.65,
                "ltv180": 102.15
            },
            {
                "register_date": "20240113",
                "new_user_cnt": 45,
                "ltv1": 0,
                "ltv3": 0.67,
                "ltv7": 0.67,
                "ltv14": 3.56,
                "ltv30": 29.69,
                "ltv60": 49.6,
                "ltv90": 56.18,
                "ltv180": 79.36
            },
            {
                "register_date": "20240106",
                "new_user_cnt": 36,
                "ltv1": 0.5,
                "ltv3": 0.5,
                "ltv7": 0.5,
                "ltv14": 0.58,
                "ltv30": 1.53,
                "ltv60": 58.92,
                "ltv90": 67.08,
                "ltv180": 139.89
            },
            {
                "register_date": "20240123",
                "new_user_cnt": 32,
                "ltv1": 0,
                "ltv3": 0.03,
                "ltv7": 1.38,
                "ltv14": 1.38,
                "ltv30": 1.38,
                "ltv60": 165.25,
                "ltv90": 172.97,
                "ltv180": 249.63
            }
        ]
    },
    {
        "sql_id": "sql_57",
        "sql": "-- 查询限定抽取阶梯活动相关数据\nselect\n    dtstatdate,\n    pv,\n    uv\nfrom (\n    -- 按天统计\n    select\n        substr(tdbank_imp_date, 1, 8) as dtstatdate,\n        count(*)                       as pv,\n        count(distinct uid)            as uv\n    from dwd_jordass_activitypress_hi\n    where tdbank_imp_date between '2024112900' and '2024121923'\n      and ireason   = 2411291018\n      and buttontype = 10045\n      and extarg1   in (117, 115)\n    group by substr(tdbank_imp_date, 1, 8)\n\n    union all\n\n    -- 汇总\n    select\n        '汇总' as dtstatdate,\n        count(*)            as pv,\n        count(distinct uid) as uv\n    from dwd_jordass_activitypress_hi\n    where tdbank_imp_date between '2024112900' and '2024121923'\n      and ireason   = 2411291018\n      and buttontype = 10045\n      and extarg1   in (117, 115)\n) f \n;\n",
        "status": "success",
        "result": [
            {
                "dtstatdate": "20241214",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "20241208",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "20241217",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "20241129",
                "pv": 122,
                "uv": 48
            },
            {
                "dtstatdate": "20241207",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "20241202",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "20241205",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "20241204",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "20241130",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "20241212",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "20241206",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "20241203",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "20241209",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "20241219",
                "pv": 38,
                "uv": 27
            },
            {
                "dtstatdate": "20241211",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "20241210",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "20241218",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "20241213",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "20241201",
                "pv": 34,
                "uv": 30
            },
            {
                "dtstatdate": "20241216",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "20241215",
                "pv": 6,
                "uv": 4
            },
            {
                "dtstatdate": "汇总",
                "pv": 302,
                "uv": 72
            }
        ]
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql_id": "sql_59",
        "sql": "select \n    s1.trigger_count as `trigger_count`, -- 第x次触发\n    count(distinct s1.vplayerid) as `trigger_user_cnt`, -- 触发用户数\n    sum(s2.draw_count) as `total_draw_count` -- 用户总抽奖次数\nfrom (\n    select\n        vplayerid,\n        dteventtime,\n        coalesce(lead(dteventtime) over (partition by vplayerid order by dteventtime), '9999-12-31 23:59:59')  as next_dteventtime,\n        row_number() over (partition by vplayerid order by dteventtime) as trigger_count\n    from (\n        select distinct\n            vplayerid,\n            dteventtime\n        from dwd_jordass_activityrecord_hi\n        where tdbank_imp_date >= '2025011100'\n        and tdbank_imp_date <= '2025012423'\n        and actid = 2411070621\n        and acttype = 10062\n        and recodtype in ('1', '2')\n        and strarg1 <> '0'\n    ) ff1\n) s1 \njoin (\n    select\n        vplayerid,\n        dteventtime,\n        sum(arg1) as draw_count\n    from dwd_jordass_activityrecord_hi  -- actgeneralflow表\n    where tdbank_imp_date >= \"2025011100\" and tdbank_imp_date <= \"2025012423\" -- 时间区间：20250111-20250124\n    and actid = 2411070621\n    and acttype = 10062\n    and recodtype in (\"1\", \"2\")\n    group by vplayerid, dteventtime\n\n    \n) s2 \non s1.vplayerid = s2.vplayerid and s2. dteventtime >= s1.dteventtime and s2.dteventtime < s1.next_dteventtime\ngroup by s1.trigger_count\n\n",
        "status": "success",
        "result": [
            {
                "trigger_count": 8,
                "trigger_user_cnt": 2,
                "total_draw_count": 15
            },
            {
                "trigger_count": 18,
                "trigger_user_cnt": 1,
                "total_draw_count": 13
            },
            {
                "trigger_count": 3,
                "trigger_user_cnt": 4,
                "total_draw_count": 7
            },
            {
                "trigger_count": 5,
                "trigger_user_cnt": 3,
                "total_draw_count": 5
            },
            {
                "trigger_count": 14,
                "trigger_user_cnt": 1,
                "total_draw_count": 11
            },
            {
                "trigger_count": 16,
                "trigger_user_cnt": 1,
                "total_draw_count": 12
            },
            {
                "trigger_count": 19,
                "trigger_user_cnt": 1,
                "total_draw_count": 2
            },
            {
                "trigger_count": 10,
                "trigger_user_cnt": 1,
                "total_draw_count": 9
            },
            {
                "trigger_count": 11,
                "trigger_user_cnt": 1,
                "total_draw_count": 2
            },
            {
                "trigger_count": 17,
                "trigger_user_cnt": 1,
                "total_draw_count": 2
            },
            {
                "trigger_count": 12,
                "trigger_user_cnt": 1,
                "total_draw_count": 10
            },
            {
                "trigger_count": 7,
                "trigger_user_cnt": 2,
                "total_draw_count": 3
            },
            {
                "trigger_count": 1,
                "trigger_user_cnt": 27,
                "total_draw_count": 30
            },
            {
                "trigger_count": 15,
                "trigger_user_cnt": 1,
                "total_draw_count": 2
            },
            {
                "trigger_count": 2,
                "trigger_user_cnt": 27,
                "total_draw_count": 120
            },
            {
                "trigger_count": 13,
                "trigger_user_cnt": 1,
                "total_draw_count": 2
            },
            {
                "trigger_count": 4,
                "trigger_user_cnt": 4,
                "total_draw_count": 16
            },
            {
                "trigger_count": 9,
                "trigger_user_cnt": 2,
                "total_draw_count": 3
            },
            {
                "trigger_count": 6,
                "trigger_user_cnt": 2,
                "total_draw_count": 13
            },
            {
                "trigger_count": 20,
                "trigger_user_cnt": 1,
                "total_draw_count": 14
            }
        ]
    },
    {
        "sql_id": "sql_60",
        "sql": "WITH alliance_daily AS (\n  SELECT\n    tdbank_imp_date AS stat_date,\n    CAST(uid AS STRING) AS uid\n  FROM dwd_jordass_player_allianceactive_hi\n  WHERE tdbank_imp_date BETWEEN DATE_FORMAT(DATE_SUB('2025-02-26', INTERVAL 180 DAY), '%Y%m%d')\n                            AND DATE_FORMAT(DATE_SUB('2025-02-26', INTERVAL 1 DAY), '%Y%m%d')\n  GROUP BY tdbank_imp_date, uid\n), uid_map AS (\n  SELECT uid, vplayerid\n  FROM (\n    SELECT\n      CAST(uid AS STRING) AS uid,\n      vplayerid,\n      ROW_NUMBER() OVER (PARTITION BY uid ORDER BY dtstatdate DESC) AS rn\n    FROM dws_jordass_uid_login_df\n    WHERE dtstatdate <= '20250226'\n      AND platid = 255\n  ) t\n  WHERE rn = 1\n), rolling_pay AS (\n  SELECT\n    a.stat_date,\n    m.vplayerid\n  FROM alliance_daily a\n  JOIN uid_map m\n    ON a.uid = m.uid\n  WHERE EXISTS (\n    SELECT 1\n    FROM dws_jordass_water_di w\n    WHERE w.vplayerid = m.vplayerid\n      AND w.platid = 255\n      AND w.dtstatdate BETWEEN DATE_FORMAT(DATE_SUB(STR_TO_DATE(a.stat_date, '%Y%m%d'), INTERVAL 29 DAY), '%Y%m%d')\n                          AND a.stat_date\n  )\n)\nSELECT\n  stat_date,\n  COUNT(DISTINCT vplayerid) AS alliance_pay_user_cnt\nFROM rolling_pay\nGROUP BY stat_date\nORDER BY stat_date",
        "status": "success",
        "result": []
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql_id": "sql_62",
        "sql": "WITH login_dates AS (\n  SELECT DISTINCT DATE(CAST(dteventtime AS DATE)) AS stat_date\n  FROM dwd_jordass_playerlogin_hi\n  WHERE DATE(CAST(dteventtime AS DATE)) BETWEEN DATE_SUB('2025-02-26', INTERVAL 179 DAY) AND '2025-02-26'\n),\nalliance_dates AS (\n  SELECT DISTINCT DATE(CAST(dteventtime AS DATE)) AS stat_date\n  FROM dwd_jordass_player_allianceactive_hi\n  WHERE DATE(CAST(dteventtime AS DATE)) BETWEEN DATE_SUB('2025-02-26', INTERVAL 179 DAY) AND '2025-02-26'\n),\nbootcamp_dates AS (\n  SELECT DISTINCT DATE(CAST(dteventtime AS DATE)) AS stat_date\n  FROM dwd_jordass_alliancebootcamprecord_hi\n  WHERE DATE(CAST(dteventtime AS DATE)) BETWEEN DATE_SUB('2025-02-26', INTERVAL 179 DAY) AND '2025-02-26'\n),\nshop_dates AS (\n  SELECT DISTINCT DATE(CAST(dteventtime AS DATE)) AS stat_date\n  FROM dwd_jordass_allianceshopbuy_hi\n  WHERE DATE(CAST(dteventtime AS DATE)) BETWEEN DATE_SUB('2025-02-26', INTERVAL 179 DAY) AND '2025-02-26'\n),\nall_dates AS (\n  SELECT stat_date FROM login_dates\n  UNION\n  SELECT stat_date FROM alliance_dates\n  UNION\n  SELECT stat_date FROM bootcamp_dates\n  UNION\n  SELECT stat_date FROM shop_dates\n),\nrole_dau AS (\n  SELECT\n    DATE(CAST(dteventtime AS DATE)) AS stat_date,\n    COUNT(DISTINCT uid) AS dau_cnt\n  FROM dwd_jordass_playerlogin_hi\n  WHERE DATE(CAST(dteventtime AS DATE)) BETWEEN DATE_SUB('2025-02-26', INTERVAL 179 DAY) AND '2025-02-26'\n  GROUP BY stat_date\n),\nalliance_participate AS (\n  SELECT\n    DATE(CAST(dteventtime AS DATE)) AS stat_date,\n    COUNT(DISTINCT uid) AS participate_cnt\n  FROM dwd_jordass_player_allianceactive_hi\n  WHERE DATE(CAST(dteventtime AS DATE)) BETWEEN DATE_SUB('2025-02-26', INTERVAL 179 DAY) AND '2025-02-26'\n  GROUP BY stat_date\n),\nbootcamp_finish AS (\n  SELECT\n    DATE(CAST(dteventtime AS DATE)) AS stat_date,\n    COUNT(DISTINCT memberuid) AS bootcamp_cnt\n  FROM dwd_jordass_alliancebootcamprecord_hi\n  WHERE DATE(CAST(dteventtime AS DATE)) BETWEEN DATE_SUB('2025-02-26', INTERVAL 179 DAY) AND '2025-02-26'\n  GROUP BY stat_date\n),\nshop_exchange AS (\n  SELECT\n    DATE(CAST(dteventtime AS DATE)) AS stat_date,\n    COUNT(*) AS exchange_cnt\n  FROM dwd_jordass_allianceshopbuy_hi\n  WHERE DATE(CAST(dteventtime AS DATE)) BETWEEN DATE_SUB('2025-02-26', INTERVAL 179 DAY) AND '2025-02-26'\n  GROUP BY stat_date\n)\nSELECT\n  DATE_FORMAT(d.stat_date, '%Y%m%d') AS stat_date,\n  COALESCE(rd.dau_cnt, 0) AS role_dau,\n  COALESCE(ap.participate_cnt, 0) AS alliance_participate_cnt,\n  COALESCE(bf.bootcamp_cnt, 0) AS bootcamp_finish_role_cnt,\n  COALESCE(se.exchange_cnt, 0) AS alliance_shop_exchange_cnt\nFROM all_dates d\nLEFT JOIN role_dau rd ON d.stat_date = rd.stat_date\nLEFT JOIN alliance_participate ap ON d.stat_date = ap.stat_date\nLEFT JOIN bootcamp_finish bf ON d.stat_date = bf.stat_date\nLEFT JOIN shop_exchange se ON d.stat_date = se.stat_date\nORDER BY d.stat_date",
        "status": "success",
        "result": [
            {
                "stat_date": "20240831",
                "role_dau": 0,
                "alliance_participate_cnt": 2,
                "bootcamp_finish_role_cnt": 2,
                "alliance_shop_exchange_cnt": 2
            },
            {
                "stat_date": "20240901",
                "role_dau": 0,
                "alliance_participate_cnt": 2,
                "bootcamp_finish_role_cnt": 2,
                "alliance_shop_exchange_cnt": 2
            },
            {
                "stat_date": "20240902",
                "role_dau": 0,
                "alliance_participate_cnt": 2,
                "bootcamp_finish_role_cnt": 2,
                "alliance_shop_exchange_cnt": 2
            },
            {
                "stat_date": "20240903",
                "role_dau": 0,
                "alliance_participate_cnt": 2,
                "bootcamp_finish_role_cnt": 2,
                "alliance_shop_exchange_cnt": 2
            },
            {
                "stat_date": "20240930",
                "role_dau": 1,
                "alliance_participate_cnt": 0,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20241001",
                "role_dau": 1,
                "alliance_participate_cnt": 0,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20241002",
                "role_dau": 1,
                "alliance_participate_cnt": 0,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20241003",
                "role_dau": 1,
                "alliance_participate_cnt": 0,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20241004",
                "role_dau": 1,
                "alliance_participate_cnt": 0,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20241005",
                "role_dau": 1,
                "alliance_participate_cnt": 0,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20241006",
                "role_dau": 1,
                "alliance_participate_cnt": 0,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20241007",
                "role_dau": 1,
                "alliance_participate_cnt": 0,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20241008",
                "role_dau": 1,
                "alliance_participate_cnt": 0,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20241009",
                "role_dau": 1,
                "alliance_participate_cnt": 0,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20241010",
                "role_dau": 1,
                "alliance_participate_cnt": 0,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20241011",
                "role_dau": 1,
                "alliance_participate_cnt": 0,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20241012",
                "role_dau": 1,
                "alliance_participate_cnt": 0,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20241013",
                "role_dau": 1,
                "alliance_participate_cnt": 0,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20241014",
                "role_dau": 1,
                "alliance_participate_cnt": 0,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20241015",
                "role_dau": 1,
                "alliance_participate_cnt": 0,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20241101",
                "role_dau": 1,
                "alliance_participate_cnt": 0,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20250101",
                "role_dau": 0,
                "alliance_participate_cnt": 4,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20250102",
                "role_dau": 0,
                "alliance_participate_cnt": 4,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            },
            {
                "stat_date": "20250226",
                "role_dau": 0,
                "alliance_participate_cnt": 1,
                "bootcamp_finish_role_cnt": 0,
                "alliance_shop_exchange_cnt": 0
            }
        ]
    },
    {
        "sql_id": "sql_64",
        "sql": "select\n  dtstatdate,\n  count(distinct vplayerid) as uv,\n  count(*) as pv\nfrom dws_jordass_buttonpress_pre_di\nwhere buttontype = '410012'\n  and (\n        dtstatdate between '20241022' and '20241119'\n     or dtstatdate between '20241122' and '20241219'\n     or dtstatdate between '20241022' and '20241027'\n     or dtstatdate between '20241028' and '20241103'\n     or dtstatdate between '20241104' and '20241110'\n     or dtstatdate between '20241111' and '20241117'\n     or dtstatdate between '20241118' and '20241119'\n     or dtstatdate between '20241122' and '20241124'\n     or dtstatdate between '20241125' and '20241201'\n     or dtstatdate between '20241202' and '20241208'\n     or dtstatdate between '20241209' and '20241215'\n     or dtstatdate between '20241216' and '20241219'\n  )\ngroup by dtstatdate\norder by dtstatdate",
        "status": "success",
        "result": [
            {
                "dtstatdate": "20241023",
                "uv": 1,
                "pv": 2
            },
            {
                "dtstatdate": "20241025",
                "uv": 1,
                "pv": 1
            },
            {
                "dtstatdate": "20241112",
                "uv": 2,
                "pv": 2
            },
            {
                "dtstatdate": "20241119",
                "uv": 1,
                "pv": 1
            },
            {
                "dtstatdate": "20241123",
                "uv": 1,
                "pv": 1
            },
            {
                "dtstatdate": "20241210",
                "uv": 1,
                "pv": 1
            }
        ]
    },
    {
        "sql_id": "sql_65",
        "sql": "with base as (\n  select\n    substr(tdbank_imp_date, 1, 8) as stat_date,\n    cast(awardidx as string) as award_type,\n    vplayerid\n  from dwd_jordass_activity_rewardrecord_hi\n  where substr(tdbank_imp_date, 1, 8) between '20241129' and '20241219'\n    and actid = 2411291018\n    and acttype = 10045\n    and awardidx in (1, 2, 3)\n),\nstat_detail as (\n  select\n    stat_date,\n    award_type,\n    count(distinct vplayerid) as user_cnt,\n    count(*) as receive_cnt\n  from base\n  group by stat_date, award_type\n),\nstat_summary as (\n  select\n    '汇总' as stat_date,\n    award_type,\n    count(distinct vplayerid) as user_cnt,\n    count(*) as receive_cnt\n  from base\n  group by award_type\n)\nselect\n  stat_date,\n  award_type,\n  user_cnt,\n  receive_cnt\nfrom (\n  select * from stat_detail\n  union all\n  select * from stat_summary\n) t\norder by case when stat_date = '汇总' then 1 else 0 end, stat_date, award_type",
        "status": "success",
        "result": [
            {
                "stat_date": "20241129",
                "award_type": "1",
                "user_cnt": 1,
                "receive_cnt": 2
            },
            {
                "stat_date": "20241130",
                "award_type": "2",
                "user_cnt": 1,
                "receive_cnt": 1
            },
            {
                "stat_date": "20241201",
                "award_type": "3",
                "user_cnt": 1,
                "receive_cnt": 1
            },
            {
                "stat_date": "20241205",
                "award_type": "1",
                "user_cnt": 1,
                "receive_cnt": 1
            },
            {
                "stat_date": "20241210",
                "award_type": "2",
                "user_cnt": 1,
                "receive_cnt": 1
            },
            {
                "stat_date": "20241215",
                "award_type": "3",
                "user_cnt": 1,
                "receive_cnt": 1
            },
            {
                "stat_date": "20241219",
                "award_type": "1",
                "user_cnt": 1,
                "receive_cnt": 1
            },
            {
                "stat_date": "汇总",
                "award_type": "1",
                "user_cnt": 3,
                "receive_cnt": 4
            },
            {
                "stat_date": "汇总",
                "award_type": "2",
                "user_cnt": 2,
                "receive_cnt": 2
            },
            {
                "stat_date": "汇总",
                "award_type": "3",
                "user_cnt": 2,
                "receive_cnt": 2
            }
        ]
    },
    {
        "sql_id": "sql_67",
        "sql": "select\n  cast(igoodsid as string) as goods_id,\n  sum(coalesce(count, 0)) as produce_cnt\nfrom dwd_jordass_gearlog_hi\nwhere substr(tdbank_imp_date, 1, 8) between '20250124' and '20250206'\n  and igoodsid in (430487, 430485, 602004025, 602002011)\n  and addorreduce = 0\ngroup by igoodsid\norder by goods_id",
        "status": "success",
        "result": [
            {
                "goods_id": "430485",
                "produce_cnt": 2
            },
            {
                "goods_id": "430487",
                "produce_cnt": 1
            },
            {
                "goods_id": "602002011",
                "produce_cnt": 1
            },
            {
                "goods_id": "602004025",
                "produce_cnt": 2
            }
        ]
    },
    {
        "sql_id": "sql_68",
        "sql": "select\n  substr(tdbank_imp_date, 1, 8) as stat_date,\n  count(distinct vplayerid) as user_cnt\nfrom dwd_jordass_lotteryrecord_hi\nwhere substr(tdbank_imp_date, 1, 8) between '20250128' and '20250210'\n  and activitytype in (848, 841)\ngroup by substr(tdbank_imp_date, 1, 8)\norder by stat_date",
        "status": "success",
        "result": [
            {
                "stat_date": "20250128",
                "user_cnt": 2
            },
            {
                "stat_date": "20250129",
                "user_cnt": 2
            },
            {
                "stat_date": "20250130",
                "user_cnt": 1
            },
            {
                "stat_date": "20250208",
                "user_cnt": 1
            },
            {
                "stat_date": "20250210",
                "user_cnt": 2
            }
        ]
    },
    {
        "sql_id": "sql_69",
        "sql": "select\n  substr(tdbank_imp_date, 1, 8) as stat_date,\n  cast(chattype as string) as chat_type,\n  count(distinct playerid) as user_cnt,\n  count(*) as msg_cnt\nfrom dwd_jordass_msgchatrecord_hi\nwhere substr(tdbank_imp_date, 1, 8) between '20241225' and '20250105'\n  and chattype in (20, 25, 26, 16, 27, 8)\ngroup by substr(tdbank_imp_date, 1, 8), chattype\norder by stat_date, chat_type",
        "status": "success",
        "result": [
            {
                "stat_date": "20241225",
                "chat_type": "20",
                "user_cnt": 1,
                "msg_cnt": 1
            },
            {
                "stat_date": "20241225",
                "chat_type": "25",
                "user_cnt": 1,
                "msg_cnt": 1
            },
            {
                "stat_date": "20241226",
                "chat_type": "16",
                "user_cnt": 1,
                "msg_cnt": 1
            },
            {
                "stat_date": "20241226",
                "chat_type": "26",
                "user_cnt": 1,
                "msg_cnt": 1
            },
            {
                "stat_date": "20250101",
                "chat_type": "16",
                "user_cnt": 1,
                "msg_cnt": 1
            },
            {
                "stat_date": "20250101",
                "chat_type": "27",
                "user_cnt": 1,
                "msg_cnt": 1
            },
            {
                "stat_date": "20250101",
                "chat_type": "8",
                "user_cnt": 1,
                "msg_cnt": 1
            },
            {
                "stat_date": "20250102",
                "chat_type": "16",
                "user_cnt": 1,
                "msg_cnt": 1
            },
            {
                "stat_date": "20250105",
                "chat_type": "25",
                "user_cnt": 1,
                "msg_cnt": 1
            }
        ]
    },
    {
        "sql_id": "sql_70",
        "sql": "with base as (\n  select\n    cast(awardidx as string) as award_type,\n    vplayerid\n  from dwd_jordass_activity_rewardrecord_hi\n  where substr(tdbank_imp_date, 1, 8) between '20241129' and '20241219'\n    and actid = 2411291018\n)\nselect\n  award_type,\n  user_cnt\nfrom (\n  select\n    award_type,\n    count(distinct vplayerid) as user_cnt\n  from base\n  group by award_type\n  union all\n  select\n    '汇总' as award_type,\n    count(distinct vplayerid) as user_cnt\n  from base\n) t\norder by case when award_type = '汇总' then 1 else 0 end, award_type",
        "status": "success",
        "result": [
            {
                "award_type": "1",
                "user_cnt": 5
            },
            {
                "award_type": "2",
                "user_cnt": 4
            },
            {
                "award_type": "3",
                "user_cnt": 4
            },
            {
                "award_type": "4",
                "user_cnt": 1
            },
            {
                "award_type": "5",
                "user_cnt": 1
            },
            {
                "award_type": "汇总",
                "user_cnt": 14
            }
        ]
    },
    {
        "sql_id": "sql_71",
        "sql": "with tagged as (\n  select\n    case\n      when substr(tdbank_imp_date, 1, 8) between '20241129' and '20241205' then '20241129-20241205'\n      when substr(tdbank_imp_date, 1, 8) between '20241206' and '20241212' then '20241206-20241212'\n      when substr(tdbank_imp_date, 1, 8) between '20241213' and '20241219' then '20241213-20241219'\n      else null\n    end as range_flag,\n    extarg1,\n    vplayerid\n  from dwd_jordass_activitypress_hi\n  where substr(tdbank_imp_date, 1, 8) between '20241129' and '20241219'\n    and ireason = 2411291018\n    and buttontype = 10045\n    and extarg1 in (101, 109, 110)\n)\nselect\n  range_flag as date_range,\n  cast(extarg1 as string) as extarg1_type,\n  count(distinct vplayerid) as user_cnt,\n  count(*) as press_cnt\nfrom tagged\nwhere range_flag is not null\ngroup by range_flag, extarg1_type\norder by date_range, extarg1_type",
        "status": "success",
        "result": [
            {
                "date_range": "20241129-20241205",
                "extarg1_type": "101",
                "user_cnt": 1,
                "press_cnt": 2
            },
            {
                "date_range": "20241129-20241205",
                "extarg1_type": "109",
                "user_cnt": 1,
                "press_cnt": 1
            },
            {
                "date_range": "20241206-20241212",
                "extarg1_type": "109",
                "user_cnt": 1,
                "press_cnt": 1
            },
            {
                "date_range": "20241206-20241212",
                "extarg1_type": "110",
                "user_cnt": 2,
                "press_cnt": 2
            },
            {
                "date_range": "20241213-20241219",
                "extarg1_type": "101",
                "user_cnt": 1,
                "press_cnt": 1
            },
            {
                "date_range": "20241213-20241219",
                "extarg1_type": "110",
                "user_cnt": 1,
                "press_cnt": 1
            }
        ]
    },
    {
        "sql_id": "sql_73",
        "sql": "with base as (\n  select\n    vplayerid,\n    cast(coalesce(nullif(teamnum, ''), '1') as int) as team_num,\n    matchmode,\n    matchsubmodegroup\n  from dwd_jordass_player_matchrecord_hi\n  where substr(tdbank_imp_date, 1, 8) between '20241123' and '20241222'\n    and matchresult = 'ok'\n),\nagg as (\n  select\n    '乐园' as category,\n    count(distinct vplayerid) as total_users,\n    count(*) as total_matches,\n    count(distinct case when team_num > 1 then vplayerid end) as team_users,\n    sum(case when team_num > 1 then 1 else 0 end) as team_matches\n  from base\n  where matchmode = 1003\n  union all\n  select\n    '对决冠军',\n    count(distinct vplayerid),\n    count(*),\n    count(distinct case when team_num > 1 then vplayerid end),\n    sum(case when team_num > 1 then 1 else 0 end)\n  from base\n  where matchmode = 1003 and matchsubmodegroup = 1345785623905087744\n  union all\n  select\n    '乐园其他',\n    count(distinct vplayerid),\n    count(*),\n    count(distinct case when team_num > 1 then vplayerid end),\n    sum(case when team_num > 1 then 1 else 0 end)\n  from base\n  where matchmode = 1003 and matchsubmodegroup <> 1345785623905087744\n)\nselect\n  max(case when category = '乐园' then total_users end) as leyuan_total_users,\n  max(case when category = '乐园' then total_matches end) as leyuan_total_matches,\n  max(case when category = '乐园' then team_users end) as leyuan_team_users,\n  max(case when category = '乐园' then team_matches end) as leyuan_team_matches,\n  max(case when category = '对决冠军' then total_users end) as duel_total_users,\n  max(case when category = '对决冠军' then total_matches end) as duel_total_matches,\n  max(case when category = '对决冠军' then team_users end) as duel_team_users,\n  max(case when category = '对决冠军' then team_matches end) as duel_team_matches,\n  max(case when category = '乐园其他' then total_users end) as leyuan_other_total_users,\n  max(case when category = '乐园其他' then total_matches end) as leyuan_other_total_matches,\n  max(case when category = '乐园其他' then team_users end) as leyuan_other_team_users,\n  max(case when category = '乐园其他' then team_matches end) as leyuan_other_team_matches\nfrom agg",
        "status": "success",
        "result": [
            {
                "leyuan_total_users": 7,
                "leyuan_total_matches": 12,
                "leyuan_team_users": 5,
                "leyuan_team_matches": 6,
                "duel_total_users": 4,
                "duel_total_matches": 6,
                "duel_team_users": 3,
                "duel_team_matches": 3,
                "leyuan_other_total_users": 4,
                "leyuan_other_total_matches": 6,
                "leyuan_other_team_users": 3,
                "leyuan_other_team_matches": 3
            }
        ]
    },
    {
        "sql_id": "sql_74",
        "sql": "WITH ss30 AS (\n  SELECT\n    '411130' AS button_type,\n    COUNT(DISTINCT vplayerid) AS user_cnt\n  FROM dwd_jordass_pressbutton_hi\n  WHERE buttontypes IS NOT NULL\n    AND REGEXP(buttontypes, '(^|;)411130(;|$)') = 1\n    AND CAST(dteventtime AS DATETIME) BETWEEN '2024-11-23 05:00:00' AND '2024-11-26 16:00:00'\n  UNION ALL\n  SELECT\n    '411200' AS button_type,\n    COUNT(DISTINCT vplayerid) AS user_cnt\n  FROM dwd_jordass_pressbutton_hi\n  WHERE buttontypes IS NOT NULL\n    AND REGEXP(buttontypes, '(^|;)411200(;|$)') = 1\n    AND CAST(dteventtime AS DATETIME) BETWEEN '2024-11-23 05:00:00' AND '2024-11-26 16:00:00'\n), ss29 AS (\n  SELECT\n    '411130' AS button_type,\n    COUNT(DISTINCT vplayerid) AS user_cnt\n  FROM dwd_jordass_pressbutton_hi\n  WHERE buttontypes IS NOT NULL\n    AND REGEXP(buttontypes, '(^|;)411130(;|$)') = 1\n    AND CAST(dteventtime AS DATETIME) BETWEEN '2024-09-24 05:00:00' AND '2024-09-27 16:00:00'\n  UNION ALL\n  SELECT\n    '411200' AS button_type,\n    COUNT(DISTINCT vplayerid) AS user_cnt\n  FROM dwd_jordass_pressbutton_hi\n  WHERE buttontypes IS NOT NULL\n    AND REGEXP(buttontypes, '(^|;)411200(;|$)') = 1\n    AND CAST(dteventtime AS DATETIME) BETWEEN '2024-09-24 05:00:00' AND '2024-09-27 16:00:00'\n)\nSELECT\n  b.button_type,\n  COALESCE(s30.user_cnt, 0) AS ss30_user_cnt,\n  COALESCE(s29.user_cnt, 0) AS ss29_user_cnt\nFROM (\n  SELECT '411130' AS button_type\n  UNION ALL SELECT '411200'\n) b\nLEFT JOIN ss30 s30 ON b.button_type = s30.button_type\nLEFT JOIN ss29 s29 ON b.button_type = s29.button_type\nORDER BY b.button_type",
        "status": "success",
        "result": [
            {
                "button_type": "411130",
                "ss30_user_cnt": 3,
                "ss29_user_cnt": 3
            },
            {
                "button_type": "411200",
                "ss30_user_cnt": 1,
                "ss29_user_cnt": 4
            }
        ]
    },
    {
        "sql_id": "sql_75",
        "sql": "select\n  cast(baseid as string) as base_id,\n  count(*) as unlock_cnt\nfrom dwd_jordass_voicethemelog_hi\nwhere tdbank_imp_date between '2022080400' and '2024112400'\n  and baseid in (3336008, 3304024, 3336012, 3306028, 3304030, 3336016, 3336018, 3304038, 3336023, 3306033, 3349004, 3308014, 3336032, 3304043, 3306039, 3336041, 3301024, 3336045, 3306042)\ngroup by baseid\norder by base_id",
        "status": "success",
        "result": [
            {
                "base_id": "3304024",
                "unlock_cnt": 5
            },
            {
                "base_id": "3304030",
                "unlock_cnt": 1
            },
            {
                "base_id": "3306028",
                "unlock_cnt": 1
            },
            {
                "base_id": "3336008",
                "unlock_cnt": 4
            },
            {
                "base_id": "3336012",
                "unlock_cnt": 1
            }
        ]
    },
    {
        "sql_id": "sql_77",
        "sql": "select\n  substr(tdbank_imp_date, 1, 8) as stat_date,\n  count(distinct vplayerid) as user_cnt,\n  sum(coalesce(imoney, 0)) as element_amount\nfrom dwd_jordass_currencylog_hi\nwhere substr(tdbank_imp_date, 1, 8) between '20230123' and '20230129'\n  and reason in (189, 190)\n  and imoneytype = 1027\ngroup by substr(tdbank_imp_date, 1, 8)\norder by stat_date",
        "status": "success",
        "result": [
            {
                "stat_date": "20230123",
                "user_cnt": 2,
                "element_amount": 3500
            },
            {
                "stat_date": "20230124",
                "user_cnt": 1,
                "element_amount": 1500
            },
            {
                "stat_date": "20230125",
                "user_cnt": 1,
                "element_amount": 3000
            },
            {
                "stat_date": "20230126",
                "user_cnt": 1,
                "element_amount": 2500
            },
            {
                "stat_date": "20230127",
                "user_cnt": 1,
                "element_amount": 1000
            },
            {
                "stat_date": "20230129",
                "user_cnt": 1,
                "element_amount": 3500
            }
        ]
    },
    {
        "sql_id": "sql_78",
        "sql": "WITH base_users AS (\n  SELECT DISTINCT vplayerid\n  FROM dwd_jordass_lotteryrecord_hi\n  WHERE DATE(CAST(dteventtime AS DATE)) = '2025-01-19'\n    AND activitytype = 815\n), sand_lottery AS (\n  SELECT DISTINCT vplayerid\n  FROM dwd_jordass_lotteryrecord_hi\n  WHERE activitytype = 690\n    AND DATE(CAST(dteventtime AS DATE)) BETWEEN '2024-04-26' AND '2024-06-06'\n), floral_lottery AS (\n  SELECT DISTINCT vplayerid\n  FROM dwd_jordass_lotteryrecord_hi\n  WHERE activitytype = 748\n    AND DATE(CAST(dteventtime AS DATE)) BETWEEN '2024-06-07' AND '2024-07-25'\n), dragon_lottery AS (\n  SELECT DISTINCT vplayerid\n  FROM dwd_jordass_lotteryrecord_hi\n  WHERE activitytype = 750\n    AND DATE(CAST(dteventtime AS DATE)) BETWEEN '2024-07-26' AND '2024-08-22'\n), sand_suit AS (\n  SELECT DISTINCT vplayerid\n  FROM dwd_jordass_gearlog_hi\n  WHERE igoodsid = 430179\n    AND addorreduce = 0\n), floral_suit AS (\n  SELECT DISTINCT vplayerid\n  FROM dwd_jordass_gearlog_hi\n  WHERE igoodsid = 430265\n    AND addorreduce = 0\n), dragon_suit AS (\n  SELECT DISTINCT vplayerid\n  FROM dwd_jordass_gearlog_hi\n  WHERE igoodsid = 430225\n    AND addorreduce = 0\n), enriched AS (\n  SELECT\n    b.vplayerid,\n    CASE WHEN s.vplayerid IS NOT NULL THEN 1 ELSE 0 END AS has_sand_lottery,\n    CASE WHEN f.vplayerid IS NOT NULL THEN 1 ELSE 0 END AS has_floral_lottery,\n    CASE WHEN d.vplayerid IS NOT NULL THEN 1 ELSE 0 END AS has_dragon_lottery,\n    CASE WHEN ss.vplayerid IS NOT NULL THEN 1 ELSE 0 END AS has_sand_suit,\n    CASE WHEN fs.vplayerid IS NOT NULL THEN 1 ELSE 0 END AS has_floral_suit,\n    CASE WHEN ds.vplayerid IS NOT NULL THEN 1 ELSE 0 END AS has_dragon_suit\n  FROM base_users b\n  LEFT JOIN sand_lottery s ON b.vplayerid = s.vplayerid\n  LEFT JOIN floral_lottery f ON b.vplayerid = f.vplayerid\n  LEFT JOIN dragon_lottery d ON b.vplayerid = d.vplayerid\n  LEFT JOIN sand_suit ss ON b.vplayerid = ss.vplayerid\n  LEFT JOIN floral_suit fs ON b.vplayerid = fs.vplayerid\n  LEFT JOIN dragon_suit ds ON b.vplayerid = ds.vplayerid\n)\nSELECT\n  SUM(CASE WHEN has_sand_lottery = 1 THEN 1 ELSE 0 END) AS base_sand_lottery_cnt,\n  SUM(CASE WHEN has_floral_lottery = 1 THEN 1 ELSE 0 END) AS base_floral_lottery_cnt,\n  SUM(CASE WHEN has_dragon_lottery = 1 THEN 1 ELSE 0 END) AS base_dragon_lottery_cnt,\n  SUM(CASE WHEN has_sand_lottery = 1 AND has_sand_suit = 0 THEN 1 ELSE 0 END) AS base_sand_lottery_no_suit_cnt,\n  SUM(CASE WHEN has_floral_lottery = 1 AND has_floral_suit = 0 THEN 1 ELSE 0 END) AS base_floral_lottery_no_suit_cnt,\n  SUM(CASE WHEN has_dragon_lottery = 1 AND has_dragon_suit = 0 THEN 1 ELSE 0 END) AS base_dragon_lottery_no_suit_cnt,\n  SUM(CASE WHEN has_sand_lottery = 1 AND has_floral_lottery = 1 AND has_sand_suit = 1 AND has_floral_suit = 1 THEN 1 ELSE 0 END) AS base_with_sand_and_floral_suit_cnt,\n  SUM(CASE WHEN has_sand_lottery = 1 AND has_dragon_lottery = 1 AND has_sand_suit = 1 AND has_dragon_suit = 1 THEN 1 ELSE 0 END) AS base_with_sand_and_dragon_suit_cnt,\n  SUM(CASE WHEN has_floral_lottery = 1 AND has_dragon_lottery = 1 AND has_floral_suit = 1 AND has_dragon_suit = 1 THEN 1 ELSE 0 END) AS base_with_floral_and_dragon_suit_cnt,\n  SUM(CASE WHEN has_sand_lottery = 0 AND has_floral_lottery = 0 AND has_dragon_lottery = 0 THEN 1 ELSE 0 END) AS base_without_three_lottery_cnt\nFROM enriched",
        "status": "success",
        "result": [
            {
                "base_sand_lottery_cnt": 2,
                "base_floral_lottery_cnt": 2,
                "base_dragon_lottery_cnt": 2,
                "base_sand_lottery_no_suit_cnt": 1,
                "base_floral_lottery_no_suit_cnt": 1,
                "base_dragon_lottery_no_suit_cnt": 1,
                "base_with_sand_and_floral_suit_cnt": 1,
                "base_with_sand_and_dragon_suit_cnt": 1,
                "base_with_floral_and_dragon_suit_cnt": 1,
                "base_without_three_lottery_cnt": 0
            }
        ]
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql_id": "sql_82",
        "sql": "WITH base AS (\n  SELECT\n    vplayerid,\n    uid,\n    submode,\n    allianceforceterlevel,\n    CAST(dteventtime AS DATETIME) AS event_time,\n    changedratingvalue,\n    survivaltime\n  FROM dwd_jordass_roundflow_hi\n  WHERE mode = 103\n    AND CAST(dteventtime AS DATETIME) BETWEEN '2022-04-08 00:00:00' AND '2022-04-10 23:59:59'\n    AND submode IN (1001,1002,1003,1064,1065,1066,1076,1077,1078,1091,1092,1093,1137,1138,1139,1143,1144,1145,1152,1153,1154,1158,1159,1160,2029,2030,2031,2044,2045,2046,2122,2123,2124,2129,2130,2131,2166,2167,2168,2169,2170,2171,2172,2173,2174,2203,2216,2217,2218,2219,2220,2221,2297,2298,2299,2300,2301,2302,2304,2305,2306,2322,2323,2324,2325,2326,2327,2359,2360,2361,2368,2367,2366,2419,2420,2421,2422,2423,2424,2425,2426,2427,2453,2454,2455,2460,2461,2462,2472,2473,2474,2463,2464,2465,2466,2467,2468,2160,2161,2162,2163,2164,2165,2334,2335,2336,2337,2338,2339,2396,2397,2398,2399,2400,2401)\n), categorized AS (\n  SELECT\n    vplayerid,\n    CASE\n      WHEN submode IN (1001,1002,1003,1064,1065,1066,1076,1077,1078,1091,1092,1093,1137,1138,1139,1143,1144,1145,1152,1153,1154,1158,1159,1160,2029,2030,2031,2044,2045,2046,2122,2123,2124,2129,2130,2131,2166,2167,2168,2169,2170,2171,2172,2173,2174,2203,2216,2217,2218,2219,2220,2221,2297,2298,2299,2300,2301,2302,2304,2305,2306,2322,2323,2324,2325,2326,2327,2359,2360,2361,2368,2367,2366,2419,2420,2421,2422,2423,2424,2425,2426,2427,2453,2454,2455,2460,2461,2462,2472,2473,2474,2463,2464,2465,2466,2467,2468) THEN '群屿'\n      WHEN submode IN (2160,2161,2162,2163,2164,2165,2334,2335,2336,2337,2338,2339) THEN '山峦'\n      WHEN submode IN (2396,2397,2398,2399,2400,2401) THEN '假日群岛'\n      ELSE '其他'\n    END AS play_type,\n    allianceforceterlevel,\n    CASE\n      WHEN submode IN (1001,1002,1003,1064,1065,1066,1076,1077,1078,1091,1092,1093,1137,1138,1139,1143,1144,1145,1152,1153,1154,1158,1159,1160,2029,2030,2031,2044,2045,2046,2122,2123,2124,2129,2130,2131,2166,2167,2168,2169,2170,2171,2172,2173,2174,2203,2216,2217,2218,2219,2220,2221,2297,2298,2299,2300,2301,2302,2304,2305,2306,2322,2323,2324,2325,2326,2327,2359,2360,2361,2368,2367,2366,2419,2420,2421,2422,2423,2424,2425,2426,2427,2453,2454,2455,2460,2461,2462,2472,2473,2474,2463,2464,2465,2466,2467,2468) THEN changedratingvalue * 1.2\n      ELSE changedratingvalue\n    END AS adjusted_rating,\n    survivaltime\n  FROM base\n), aggregated AS (\n  SELECT\n    play_type,\n    allianceforceterlevel,\n    vplayerid,\n    SUM(CASE WHEN survivaltime > 0 THEN adjusted_rating / (survivaltime / 60.0) ELSE 0 END) AS total_points\n  FROM categorized\n  GROUP BY play_type, allianceforceterlevel, vplayerid\n), bucketed AS (\n  SELECT\n    play_type,\n    allianceforceterlevel,\n    CASE\n      WHEN total_points IS NULL THEN '[0,1)'\n      ELSE CONCAT('[', CAST(FLOOR(GREATEST(total_points, 0)) AS STRING), ',', CAST(FLOOR(GREATEST(total_points, 0)) + 1 AS STRING), ')')\n    END AS points_range,\n    vplayerid\n  FROM aggregated\n)\nSELECT\n  play_type,\n  allianceforceterlevel AS season_level,\n  points_range,\n  COUNT(DISTINCT vplayerid) AS user_cnt\nFROM bucketed\nGROUP BY play_type, allianceforceterlevel, points_range\nORDER BY play_type, allianceforceterlevel, points_range",
        "status": "success",
        "result": []
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql_id": "sql_87",
        "sql": "SELECT\n  dtstatdate AS stat_date,\n  matchsubmodegroup AS play_mode,\n  CASE\n    WHEN DATEDIFF(STR_TO_DATE(dtstatdate, '%Y%m%d'), STR_TO_DATE(dregdate, '%Y%m%d')) <= 6 THEN '新进'\n    WHEN INSTR(SUBSTR(cbitmap, 8, 7), '1') > 0 THEN '留存'\n    ELSE '回流'\n  END AS user_type,\n  COUNT(DISTINCT vplayerid) AS user_cnt\nFROM dim_jordass_leyuan_participate_cdf_nf\nWHERE dtstatdate IN ('20230702', '20230709')\n  AND INSTR(SUBSTR(cbitmap, 1, 7), '1') > 0\n  AND CASE\n        WHEN DATEDIFF(STR_TO_DATE(dtstatdate, '%Y%m%d'), STR_TO_DATE(dregdate, '%Y%m%d')) <= 6 THEN '新进'\n        WHEN INSTR(SUBSTR(cbitmap, 8, 7), '1') > 0 THEN '留存'\n        ELSE '回流'\n      END IN ('新进', '留存', '回流')\nGROUP BY dtstatdate, matchsubmodegroup,\n         CASE\n           WHEN DATEDIFF(STR_TO_DATE(dtstatdate, '%Y%m%d'), STR_TO_DATE(dregdate, '%Y%m%d')) <= 6 THEN '新进'\n           WHEN INSTR(SUBSTR(cbitmap, 8, 7), '1') > 0 THEN '留存'\n           ELSE '回流'\n         END\nORDER BY stat_date, play_mode, user_type",
        "status": "success",
        "result": [
            {
                "stat_date": "20230702",
                "play_mode": 1001,
                "user_type": "回流",
                "user_cnt": 4
            },
            {
                "stat_date": "20230702",
                "play_mode": 1002,
                "user_type": "回流",
                "user_cnt": 2
            },
            {
                "stat_date": "20230709",
                "play_mode": 1001,
                "user_type": "回流",
                "user_cnt": 2
            },
            {
                "stat_date": "20230709",
                "play_mode": 1002,
                "user_type": "回流",
                "user_cnt": 2
            }
        ]
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql_id": "sql_97",
        "sql": "with hidden as (\n  select distinct vplayerid\n  from dws_jordass_matchlog_stat_di\n  where dtstatdate between '20230719' and '20230725'\n    and imode = 1307095884553538304\n    and platid <> 255\n),\nbridge as (\n  select distinct vplayerid\n  from dws_jordass_matchlog_stat_di\n  where dtstatdate between '20230719' and '20230725'\n    and imode = 1310822585431254784\n    and platid <> 255\n),\nhidden_mode as (\n  select distinct vplayerid\n  from dws_jordass_mode_roundrecord_di\n  where dtstatdate between '20230719' and '20230725'\n    and mode = 2370\n)\nselect\n  (select count(*) from hidden) as hidden_user_cnt,\n  (select count(*) from hidden h join bridge b on h.vplayerid = b.vplayerid) as hidden_and_bridge_cnt,\n  (select count(*) from hidden h join hidden_mode m on h.vplayerid = m.vplayerid) as hidden_and_mode_cnt",
        "status": "success",
        "result": [
            {
                "hidden_user_cnt": 8,
                "hidden_and_bridge_cnt": 4,
                "hidden_and_mode_cnt": 5
            }
        ]
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql_id": "sql_101",
        "sql": "WITH target_dates AS (\n  SELECT '20240902' AS stat_date UNION ALL\n  SELECT '20240903' UNION ALL\n  SELECT '20250908' UNION ALL\n  SELECT '20250909'\n), active_users AS (\n  SELECT\n    dtstatdate AS stat_date,\n    vplayerid\n  FROM dws_jordass_login_di\n  WHERE dtstatdate IN (SELECT stat_date FROM target_dates)\n    AND platid = 255\n  GROUP BY dtstatdate, vplayerid\n), segment_latest AS (\n  SELECT\n    vplayerid,\n    seasonmaxsegment,\n    ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY dteventtime DESC) AS rn\n  FROM dwd_jordass_playerlogin_hi\n  WHERE seasonmaxsegment IS NOT NULL AND seasonmaxsegment <> ''\n), segment_map AS (\n  SELECT\n    vplayerid,\n    CASE\n      WHEN SUBSTR(seasonmaxsegment, 1, 1) = '1' THEN '青铜'\n      WHEN SUBSTR(seasonmaxsegment, 1, 1) = '2' THEN '白银'\n      WHEN SUBSTR(seasonmaxsegment, 1, 1) = '3' THEN '黄金'\n      WHEN SUBSTR(seasonmaxsegment, 1, 1) = '4' THEN '铂金'\n      WHEN SUBSTR(seasonmaxsegment, 1, 1) = '5' THEN '星钻'\n      WHEN SUBSTR(seasonmaxsegment, 1, 1) = '6' THEN '王冠'\n      WHEN SUBSTR(seasonmaxsegment, 1, 1) >= '7' THEN '王牌'\n      ELSE '无段位'\n    END AS season_segment\n  FROM segment_latest\n  WHERE rn = 1\n), active_segment AS (\n  SELECT\n    a.stat_date,\n    a.vplayerid,\n    COALESCE(s.season_segment, '无段位') AS season_segment\n  FROM active_users a\n  LEFT JOIN segment_map s\n    ON a.vplayerid = s.vplayerid\n), qunyu_users AS (\n  SELECT DISTINCT\n    dtstatdate AS stat_date,\n    vplayerid\n  FROM dws_jordass_mode_roundrecord_di\n  WHERE dtstatdate IN (SELECT stat_date FROM target_dates)\n    AND platid = 255\n    AND modename = '传统模式'\n    AND submodename LIKE 'CG%'\n), summary AS (\n  SELECT\n    a.stat_date,\n    a.season_segment,\n    COUNT(DISTINCT a.vplayerid) AS active_user_cnt,\n    COUNT(DISTINCT CASE WHEN q.vplayerid IS NOT NULL THEN a.vplayerid END) AS qunyu_user_cnt\n  FROM active_segment a\n  LEFT JOIN qunyu_users q\n    ON a.stat_date = q.stat_date\n   AND a.vplayerid = q.vplayerid\n  GROUP BY a.stat_date, a.season_segment\n)\nSELECT\n  stat_date,\n  season_segment,\n  active_user_cnt,\n  qunyu_user_cnt,\n  CASE WHEN active_user_cnt = 0 THEN 0 ELSE qunyu_user_cnt / active_user_cnt END AS participate_rate\nFROM summary\nORDER BY stat_date, season_segment",
        "status": "success",
        "result": [
            {
                "stat_date": "20240902",
                "season_segment": "星钻",
                "active_user_cnt": 1,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20240902",
                "season_segment": "王冠",
                "active_user_cnt": 1,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20240902",
                "season_segment": "王牌",
                "active_user_cnt": 3,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20240902",
                "season_segment": "白银",
                "active_user_cnt": 2,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20240902",
                "season_segment": "铂金",
                "active_user_cnt": 1,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20240902",
                "season_segment": "青铜",
                "active_user_cnt": 2,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20240902",
                "season_segment": "黄金",
                "active_user_cnt": 2,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20240903",
                "season_segment": "星钻",
                "active_user_cnt": 2,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20240903",
                "season_segment": "王冠",
                "active_user_cnt": 2,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20240903",
                "season_segment": "王牌",
                "active_user_cnt": 3,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20240903",
                "season_segment": "白银",
                "active_user_cnt": 1,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20240903",
                "season_segment": "铂金",
                "active_user_cnt": 2,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20240903",
                "season_segment": "青铜",
                "active_user_cnt": 1,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20240903",
                "season_segment": "黄金",
                "active_user_cnt": 1,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20250908",
                "season_segment": "星钻",
                "active_user_cnt": 1,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20250908",
                "season_segment": "王冠",
                "active_user_cnt": 1,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20250908",
                "season_segment": "王牌",
                "active_user_cnt": 6,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20250908",
                "season_segment": "白银",
                "active_user_cnt": 1,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20250908",
                "season_segment": "铂金",
                "active_user_cnt": 1,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20250908",
                "season_segment": "青铜",
                "active_user_cnt": 1,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20250908",
                "season_segment": "黄金",
                "active_user_cnt": 1,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20250909",
                "season_segment": "星钻",
                "active_user_cnt": 2,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20250909",
                "season_segment": "王牌",
                "active_user_cnt": 2,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20250909",
                "season_segment": "白银",
                "active_user_cnt": 2,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20250909",
                "season_segment": "铂金",
                "active_user_cnt": 2,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20250909",
                "season_segment": "青铜",
                "active_user_cnt": 2,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            },
            {
                "stat_date": "20250909",
                "season_segment": "黄金",
                "active_user_cnt": 2,
                "qunyu_user_cnt": 0,
                "participate_rate": 0
            }
        ]
    },
    {
        "sql_id": "sql_103",
        "sql": "WITH purchase AS (\n  SELECT\n    DATE(CAST(dteventtime AS DATE)) AS stat_date,\n    productid,\n    vplayerid,\n    goodsnum,\n    money\n  FROM dwd_jordass_directpaycommflow_hi\n  WHERE DATE(CAST(dteventtime AS DATE)) BETWEEN '2025-09-01' AND '2025-09-10'\n    AND op = 'take'\n    AND opres = 'ok'\n    AND productid IN ('package_6','package_18','outfit_pack','weapon_pack')\n)\nSELECT\n  DATE_FORMAT(stat_date, '%Y%m%d') AS stat_date,\n  productid,\n  COUNT(DISTINCT vplayerid) AS purchase_user_cnt,\n  ROUND(SUM(money) / 100.0, 2) AS purchase_amount,\n  SUM(goodsnum) AS purchase_qty\nFROM purchase\nGROUP BY stat_date, productid\nORDER BY stat_date, productid",
        "status": "success",
        "result": [
            {
                "stat_date": "20250901",
                "productid": "package_18",
                "purchase_user_cnt": 1,
                "purchase_amount": 1.5,
                "purchase_qty": 1
            },
            {
                "stat_date": "20250901",
                "productid": "package_6",
                "purchase_user_cnt": 2,
                "purchase_amount": 3,
                "purchase_qty": 3
            },
            {
                "stat_date": "20250902",
                "productid": "outfit_pack",
                "purchase_user_cnt": 1,
                "purchase_amount": 3,
                "purchase_qty": 1
            },
            {
                "stat_date": "20250902",
                "productid": "weapon_pack",
                "purchase_user_cnt": 1,
                "purchase_amount": 2.5,
                "purchase_qty": 2
            },
            {
                "stat_date": "20250903",
                "productid": "package_6",
                "purchase_user_cnt": 1,
                "purchase_amount": 1.2,
                "purchase_qty": 1
            },
            {
                "stat_date": "20250904",
                "productid": "package_18",
                "purchase_user_cnt": 1,
                "purchase_amount": 1.8,
                "purchase_qty": 3
            },
            {
                "stat_date": "20250905",
                "productid": "outfit_pack",
                "purchase_user_cnt": 1,
                "purchase_amount": 2.2,
                "purchase_qty": 1
            },
            {
                "stat_date": "20250906",
                "productid": "weapon_pack",
                "purchase_user_cnt": 1,
                "purchase_amount": 2.8,
                "purchase_qty": 2
            },
            {
                "stat_date": "20250910",
                "productid": "package_6",
                "purchase_user_cnt": 1,
                "purchase_amount": 0.9,
                "purchase_qty": 1
            }
        ]
    },
    {
        "sql_id": "sql_105",
        "sql": "with recharge as (\n  select\n    dtstatdate as stat_date,\n    sum(coalesce(imoney, 0)) as recharge_amount\n  from dws_jordass_water_di\n  where dtstatdate between '20240101' and '20250601'\n  group by dtstatdate\n),\ngold_consume as (\n  select\n    substr(tdbank_imp_date, 1, 8) as stat_date,\n    sum(coalesce(imoney, 0)) as gold_consume_amount\n  from dwd_jordass_currencylog_hi\n  where substr(tdbank_imp_date, 1, 8) between '20240101' and '20250601'\n    and addorreduce = 1\n    and imoneytype = 1\n  group by substr(tdbank_imp_date, 1, 8)\n),\nall_dates as (\n  select stat_date from recharge\n  union\n  select stat_date from gold_consume\n)\nselect\n  d.stat_date,\n  coalesce(r.recharge_amount, 0) as recharge_amount,\n  coalesce(g.gold_consume_amount, 0) as gold_consume_amount\nfrom all_dates d\nleft join recharge r on d.stat_date = r.stat_date\nleft join gold_consume g on d.stat_date = g.stat_date\norder by d.stat_date",
        "status": "success",
        "result": [
            {
                "stat_date": "20240101",
                "recharge_amount": 133330,
                "gold_consume_amount": 450
            },
            {
                "stat_date": "20240102",
                "recharge_amount": 24830,
                "gold_consume_amount": 950
            },
            {
                "stat_date": "20240103",
                "recharge_amount": 1630,
                "gold_consume_amount": 850
            },
            {
                "stat_date": "20240104",
                "recharge_amount": 29730,
                "gold_consume_amount": 450
            },
            {
                "stat_date": "20240105",
                "recharge_amount": 29130,
                "gold_consume_amount": 550
            },
            {
                "stat_date": "20240106",
                "recharge_amount": 135280,
                "gold_consume_amount": 650
            },
            {
                "stat_date": "20240107",
                "recharge_amount": 85680,
                "gold_consume_amount": 750
            },
            {
                "stat_date": "20240108",
                "recharge_amount": 15780,
                "gold_consume_amount": 850
            },
            {
                "stat_date": "20240109",
                "recharge_amount": 189080,
                "gold_consume_amount": 1450
            },
            {
                "stat_date": "20240110",
                "recharge_amount": 19630,
                "gold_consume_amount": 1850
            },
            {
                "stat_date": "20240111",
                "recharge_amount": 18230,
                "gold_consume_amount": 3050
            },
            {
                "stat_date": "20240112",
                "recharge_amount": 28180,
                "gold_consume_amount": 1250
            },
            {
                "stat_date": "20240113",
                "recharge_amount": 72980,
                "gold_consume_amount": 1350
            },
            {
                "stat_date": "20240114",
                "recharge_amount": 4580,
                "gold_consume_amount": 1450
            },
            {
                "stat_date": "20240115",
                "recharge_amount": 7380,
                "gold_consume_amount": 1550
            },
            {
                "stat_date": "20240116",
                "recharge_amount": 19480,
                "gold_consume_amount": 1650
            },
            {
                "stat_date": "20240117",
                "recharge_amount": 112880,
                "gold_consume_amount": 1750
            },
            {
                "stat_date": "20240118",
                "recharge_amount": 511880,
                "gold_consume_amount": 1850
            },
            {
                "stat_date": "20240119",
                "recharge_amount": 418280,
                "gold_consume_amount": 1950
            },
            {
                "stat_date": "20240120",
                "recharge_amount": 68980,
                "gold_consume_amount": 2050
            },
            {
                "stat_date": "20240121",
                "recharge_amount": 49100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240122",
                "recharge_amount": 34200,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240123",
                "recharge_amount": 30700,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240124",
                "recharge_amount": 44400,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240125",
                "recharge_amount": 34400,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240126",
                "recharge_amount": 38200,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240127",
                "recharge_amount": 29100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240128",
                "recharge_amount": 23100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240129",
                "recharge_amount": 10800,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240130",
                "recharge_amount": 22300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240131",
                "recharge_amount": 28400,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240201",
                "recharge_amount": 14500,
                "gold_consume_amount": 900
            },
            {
                "stat_date": "20240202",
                "recharge_amount": 151800,
                "gold_consume_amount": 1000
            },
            {
                "stat_date": "20240203",
                "recharge_amount": 17800,
                "gold_consume_amount": 1000
            },
            {
                "stat_date": "20240204",
                "recharge_amount": 14500,
                "gold_consume_amount": 4000
            },
            {
                "stat_date": "20240205",
                "recharge_amount": 15200,
                "gold_consume_amount": 4000
            },
            {
                "stat_date": "20240206",
                "recharge_amount": 23700,
                "gold_consume_amount": 4000
            },
            {
                "stat_date": "20240207",
                "recharge_amount": 65600,
                "gold_consume_amount": 7500
            },
            {
                "stat_date": "20240208",
                "recharge_amount": 45200,
                "gold_consume_amount": 7500
            },
            {
                "stat_date": "20240209",
                "recharge_amount": 520600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240210",
                "recharge_amount": 216500,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240211",
                "recharge_amount": 671300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240212",
                "recharge_amount": 113700,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240213",
                "recharge_amount": 188300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240214",
                "recharge_amount": 63000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240215",
                "recharge_amount": 185100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240216",
                "recharge_amount": 235100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240217",
                "recharge_amount": 91900,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240218",
                "recharge_amount": 40000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240219",
                "recharge_amount": 151900,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240220",
                "recharge_amount": 30700,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240221",
                "recharge_amount": 154400,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240222",
                "recharge_amount": 328300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240223",
                "recharge_amount": 217100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240224",
                "recharge_amount": 66000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240225",
                "recharge_amount": 54100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240226",
                "recharge_amount": 96300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240227",
                "recharge_amount": 67400,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240228",
                "recharge_amount": 76700,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240229",
                "recharge_amount": 36600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240301",
                "recharge_amount": 225750,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240302",
                "recharge_amount": 224300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240303",
                "recharge_amount": 139200,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240304",
                "recharge_amount": 51300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240305",
                "recharge_amount": 217800,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240306",
                "recharge_amount": 61900,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240307",
                "recharge_amount": 151600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240308",
                "recharge_amount": 154600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240309",
                "recharge_amount": 76780,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240310",
                "recharge_amount": 251050,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240311",
                "recharge_amount": 64380,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240312",
                "recharge_amount": 54100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240313",
                "recharge_amount": 79600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240314",
                "recharge_amount": 43200,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240315",
                "recharge_amount": 44600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240316",
                "recharge_amount": 448600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240317",
                "recharge_amount": 105500,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240318",
                "recharge_amount": 146900,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240319",
                "recharge_amount": 20200,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240320",
                "recharge_amount": 31450,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240321",
                "recharge_amount": 81100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240322",
                "recharge_amount": 179000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240323",
                "recharge_amount": 209700,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240324",
                "recharge_amount": 91500,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240325",
                "recharge_amount": 52600,
                "gold_consume_amount": 200
            },
            {
                "stat_date": "20240326",
                "recharge_amount": 307200,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240327",
                "recharge_amount": 174100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240328",
                "recharge_amount": 13500,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240329",
                "recharge_amount": 497600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240330",
                "recharge_amount": 226500,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240331",
                "recharge_amount": 171600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240401",
                "recharge_amount": 28350,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240402",
                "recharge_amount": 56900,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240403",
                "recharge_amount": 289400,
                "gold_consume_amount": 70
            },
            {
                "stat_date": "20240404",
                "recharge_amount": 53600,
                "gold_consume_amount": 80
            },
            {
                "stat_date": "20240405",
                "recharge_amount": 101150,
                "gold_consume_amount": 90
            },
            {
                "stat_date": "20240406",
                "recharge_amount": 61200,
                "gold_consume_amount": 100
            },
            {
                "stat_date": "20240407",
                "recharge_amount": 28200,
                "gold_consume_amount": 110
            },
            {
                "stat_date": "20240408",
                "recharge_amount": 27900,
                "gold_consume_amount": 120
            },
            {
                "stat_date": "20240409",
                "recharge_amount": 29600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240410",
                "recharge_amount": 102250,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240411",
                "recharge_amount": 64000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240412",
                "recharge_amount": 35300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240413",
                "recharge_amount": 11900,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240414",
                "recharge_amount": 37600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240415",
                "recharge_amount": 267550,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240416",
                "recharge_amount": 214700,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240417",
                "recharge_amount": 47300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240418",
                "recharge_amount": 61200,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240419",
                "recharge_amount": 40900,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240420",
                "recharge_amount": 62750,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240422",
                "recharge_amount": 37300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240424",
                "recharge_amount": 24700,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240425",
                "recharge_amount": 40050,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240426",
                "recharge_amount": 319000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240427",
                "recharge_amount": 94900,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240428",
                "recharge_amount": 42400,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240429",
                "recharge_amount": 37400,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240430",
                "recharge_amount": 281600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240501",
                "recharge_amount": 170000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240502",
                "recharge_amount": 129900,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240503",
                "recharge_amount": 232300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240504",
                "recharge_amount": 42900,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240505",
                "recharge_amount": 38900,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240506",
                "recharge_amount": 146700,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240507",
                "recharge_amount": 29000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240508",
                "recharge_amount": 87100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240509",
                "recharge_amount": 149000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240510",
                "recharge_amount": 52000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240511",
                "recharge_amount": 71500,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240512",
                "recharge_amount": 42100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240513",
                "recharge_amount": 58600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240514",
                "recharge_amount": 96000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240515",
                "recharge_amount": 5000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240516",
                "recharge_amount": 316800,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240517",
                "recharge_amount": 157800,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240518",
                "recharge_amount": 128900,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240519",
                "recharge_amount": 88800,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240520",
                "recharge_amount": 73800,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240521",
                "recharge_amount": 73000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240522",
                "recharge_amount": 131300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240523",
                "recharge_amount": 31400,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240524",
                "recharge_amount": 67700,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240525",
                "recharge_amount": 49500,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240526",
                "recharge_amount": 27800,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240527",
                "recharge_amount": 14800,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240528",
                "recharge_amount": 83000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240529",
                "recharge_amount": 116400,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240530",
                "recharge_amount": 20850,
                "gold_consume_amount": 600
            },
            {
                "stat_date": "20240531",
                "recharge_amount": 31250,
                "gold_consume_amount": 700
            },
            {
                "stat_date": "20240601",
                "recharge_amount": 110250,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240602",
                "recharge_amount": 22500,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240603",
                "recharge_amount": 124700,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240604",
                "recharge_amount": 88000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240605",
                "recharge_amount": 73600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240606",
                "recharge_amount": 127600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240607",
                "recharge_amount": 373700,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240608",
                "recharge_amount": 86800,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240609",
                "recharge_amount": 49800,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240610",
                "recharge_amount": 50000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240611",
                "recharge_amount": 53100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240612",
                "recharge_amount": 13800,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240613",
                "recharge_amount": 223800,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240614",
                "recharge_amount": 49900,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240615",
                "recharge_amount": 249000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240616",
                "recharge_amount": 114300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240617",
                "recharge_amount": 62000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240618",
                "recharge_amount": 47900,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240619",
                "recharge_amount": 67200,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240620",
                "recharge_amount": 238500,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240621",
                "recharge_amount": 262100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240622",
                "recharge_amount": 78200,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240623",
                "recharge_amount": 206000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240625",
                "recharge_amount": 200000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240626",
                "recharge_amount": 190700,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240627",
                "recharge_amount": 49300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240628",
                "recharge_amount": 48600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240629",
                "recharge_amount": 135000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240630",
                "recharge_amount": 117300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240701",
                "recharge_amount": 457400,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240702",
                "recharge_amount": 52400,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240703",
                "recharge_amount": 12400,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240704",
                "recharge_amount": 23200,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240705",
                "recharge_amount": 562800,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240708",
                "recharge_amount": 46200,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240709",
                "recharge_amount": 31600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240710",
                "recharge_amount": 812300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240711",
                "recharge_amount": 228100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240712",
                "recharge_amount": 223600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240713",
                "recharge_amount": 78900,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240714",
                "recharge_amount": 13200,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240715",
                "recharge_amount": 1237600,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240716",
                "recharge_amount": 49900,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240717",
                "recharge_amount": 7900,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240718",
                "recharge_amount": 5300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240719",
                "recharge_amount": 362370,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240720",
                "recharge_amount": 2228800,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240721",
                "recharge_amount": 48000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240722",
                "recharge_amount": 1251700,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240723",
                "recharge_amount": 143300,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240725",
                "recharge_amount": 3584100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240726",
                "recharge_amount": 178800,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240728",
                "recharge_amount": 100200,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240731",
                "recharge_amount": 100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240801",
                "recharge_amount": 5000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240805",
                "recharge_amount": 8000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240810",
                "recharge_amount": 12000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240815",
                "recharge_amount": 20000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240820",
                "recharge_amount": 35000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240825",
                "recharge_amount": 50000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240901",
                "recharge_amount": 80000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240905",
                "recharge_amount": 120000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240910",
                "recharge_amount": 200000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240915",
                "recharge_amount": 350000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240920",
                "recharge_amount": 500000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20240925",
                "recharge_amount": 800000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241001",
                "recharge_amount": 1200000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241005",
                "recharge_amount": 2000000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241010",
                "recharge_amount": 3500000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241015",
                "recharge_amount": 5000000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241020",
                "recharge_amount": 8000000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241025",
                "recharge_amount": 12000000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241101",
                "recharge_amount": 20000000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241105",
                "recharge_amount": 35000000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241110",
                "recharge_amount": 50000000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241115",
                "recharge_amount": 80000000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241120",
                "recharge_amount": 120000000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241125",
                "recharge_amount": 200000000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241201",
                "recharge_amount": 350000120000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241205",
                "recharge_amount": 500000000060,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241210",
                "recharge_amount": 800000000170,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241215",
                "recharge_amount": 1200000000100,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241220",
                "recharge_amount": 2000000000030,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241225",
                "recharge_amount": 3500000000040,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241230",
                "recharge_amount": 50,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20241231",
                "recharge_amount": 5000000000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20250115",
                "recharge_amount": 600000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20250220",
                "recharge_amount": 1000000,
                "gold_consume_amount": 0
            },
            {
                "stat_date": "20250225",
                "recharge_amount": 2000000,
                "gold_consume_amount": 0
            }
        ]
    },
    {
        "sql_id": "sql_107",
        "sql": "with period_a as (\n  select distinct uid\n  from dwd_jordass_activitypress_hi\n  where tdbank_imp_date between '2022011800' and '2022012423'\n    and buttontype = 99123\n    and ireason = 3\n),\nperiod_b as (\n  select distinct uid\n  from dwd_jordass_activitypress_hi\n  where tdbank_imp_date between '2021101900' and '2021122023'\n    and buttontype = 99123\n    and ireason = 3\n)\nselect\n  (select count(*) from period_a) as cnt_period_a,\n  (select count(*) from period_b) as cnt_period_b,\n  (select count(*) from period_a a join period_b b on a.uid = b.uid) as cnt_overlap",
        "status": "success",
        "result": [
            {
                "cnt_period_a": 8,
                "cnt_period_b": 7,
                "cnt_overlap": 3
            }
        ]
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql_id": "sql_109",
        "sql": "WITH combined AS (\n  SELECT vplayerid, mode, teamrank\n  FROM dwd_jordass_roundflow_hi\n  WHERE DATE(CAST(dteventtime AS DATE)) BETWEEN '2025-04-24' AND '2025-05-08'\n  UNION ALL\n  SELECT vplayerid, mode, teamrank\n  FROM dwd_jordass_roundlog_funnymode_hi\n  WHERE DATE(CAST(dteventtime AS DATE)) BETWEEN '2025-04-24' AND '2025-05-08'\n), total_wins AS (\n  SELECT\n    vplayerid,\n    SUM(CASE WHEN mode IN (101,102,103,401,402,403) AND teamrank = 1 THEN 1 ELSE 0 END) +\n    SUM(CASE WHEN mode IN (201,202,203,601,602,603) AND teamrank = 1 THEN 1 ELSE 0 END) AS win_cnt\n  FROM combined\n  GROUP BY vplayerid\n  HAVING SUM(CASE WHEN mode IN (101,102,103,401,402,403) AND teamrank = 1 THEN 1 ELSE 0 END) +\n         SUM(CASE WHEN mode IN (201,202,203,601,602,603) AND teamrank = 1 THEN 1 ELSE 0 END) > 0\n), bucketed AS (\n  SELECT\n    CASE\n      WHEN win_cnt = 1 THEN '1'\n      WHEN win_cnt BETWEEN 2 AND 10 THEN '2-10'\n      WHEN win_cnt BETWEEN 11 AND 20 THEN '11-20'\n      WHEN win_cnt BETWEEN 21 AND 50 THEN '21-50'\n      WHEN win_cnt BETWEEN 51 AND 80 THEN '51-80'\n      WHEN win_cnt BETWEEN 81 AND 100 THEN '81-100'\n      WHEN win_cnt BETWEEN 101 AND 200 THEN '101-200'\n      WHEN win_cnt BETWEEN 201 AND 500 THEN '201-500'\n      ELSE '501+'\n    END AS win_bucket\n  FROM total_wins\n)\nSELECT\n  win_bucket,\n  COUNT(*) AS user_cnt\nFROM bucketed\nGROUP BY win_bucket\nORDER BY CASE win_bucket\n  WHEN '1' THEN 1\n  WHEN '2-10' THEN 2\n  WHEN '11-20' THEN 3\n  WHEN '21-50' THEN 4\n  WHEN '51-80' THEN 5\n  WHEN '81-100' THEN 6\n  WHEN '101-200' THEN 7\n  WHEN '201-500' THEN 8\n  ELSE 9\nEND",
        "status": "success",
        "result": []
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql_id": "sql_112",
        "sql": "with base as (\n  select\n    substr(tdbank_imp_date, 1, 8) as stat_date,\n    vplayerid,\n    sum(coalesce(survivaltime, 0)) as total_survival\n  from dwd_jordass_roundflow_hi\n  where ((substr(tdbank_imp_date, 1, 8) between '20220423' and '20220430')\n     or (substr(tdbank_imp_date, 1, 8) between '20220501' and '20220508'))\n    and mode in (101, 102, 103, 401, 402, 403)\n  group by substr(tdbank_imp_date, 1, 8), vplayerid\n)\nselect\n  stat_date,\n  count(distinct vplayerid) as user_cnt\nfrom base\nwhere total_survival >= 5400\ngroup by stat_date\norder by stat_date",
        "status": "success",
        "result": [
            {
                "stat_date": "20220423",
                "user_cnt": 1
            },
            {
                "stat_date": "20220424",
                "user_cnt": 3
            },
            {
                "stat_date": "20220425",
                "user_cnt": 2
            },
            {
                "stat_date": "20220426",
                "user_cnt": 2
            },
            {
                "stat_date": "20220501",
                "user_cnt": 1
            },
            {
                "stat_date": "20220502",
                "user_cnt": 1
            },
            {
                "stat_date": "20220503",
                "user_cnt": 1
            }
        ]
    },
    {
        "sql_id": "sql_113",
        "sql": "select\n  substr(tdbank_imp_date, 1, 8) as stat_date,\n  cast(shopid as string) as shop_id,\n  count(distinct vplayerid) as user_cnt,\n  count(*) as buy_cnt\nfrom dwd_jordass_vsteamshoplog_hi\nwhere substr(tdbank_imp_date, 1, 8) between '20220425' and '20220508'\ngroup by substr(tdbank_imp_date, 1, 8), shopid\norder by stat_date, shop_id",
        "status": "success",
        "result": [
            {
                "stat_date": "20220425",
                "shop_id": "37",
                "user_cnt": 2,
                "buy_cnt": 3
            },
            {
                "stat_date": "20220426",
                "shop_id": "38",
                "user_cnt": 2,
                "buy_cnt": 2
            },
            {
                "stat_date": "20220427",
                "shop_id": "39",
                "user_cnt": 1,
                "buy_cnt": 2
            },
            {
                "stat_date": "20220501",
                "shop_id": "40",
                "user_cnt": 1,
                "buy_cnt": 1
            },
            {
                "stat_date": "20220502",
                "shop_id": "41",
                "user_cnt": 1,
                "buy_cnt": 1
            },
            {
                "stat_date": "20220508",
                "shop_id": "42",
                "user_cnt": 1,
                "buy_cnt": 1
            }
        ]
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    },
    {
        "sql": null,
        "status": "error",
        "error_message": "JSON 元素缺少 'sql' 键"
    }
]